!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){(function(t){"use strict";n(4),n(6),t.mount("*")}).call(e,n(2))},function(t,e,n){var r;!function(o,i){"use strict";function a(t,e,n){var r={};return r[t.key]=e,t.pos&&(r[t.pos]=n),r}function u(t,e){for(var n,r=e.length,o=t.length;r>o;)n=e[--r],e.splice(r,1),n.unmount()}function s(t,e){Object.keys(t.tags).forEach(function(n){var r=t.tags[n];D(r)?b(r,function(t){R(t,n,e)}):R(r,n,e)})}function c(t,e,n){var r,o=t._root;for(t._virts=[];o;)r=o.nextSibling,n?e.insertBefore(o,n._root):e.appendChild(o),t._virts.push(o),o=r}function f(t,e,n,r){for(var o,i=t._root,a=0;a<r;a++)o=i.nextSibling,e.insertBefore(i,n._root),i=o}function l(t,e,n){C(t,"each");var r,o=typeof T(t,"no-reorder")!==it||C(t,"no-reorder"),i=$(t),l=tt[i]||{tmpl:x(t)},p=ct.test(i),d=t.parentNode,g=document.createTextNode(""),m=E(t),v="option"===i.toLowerCase(),b=[],y=[],w="VIRTUAL"==t.tagName;n=gt.loopKeys(n),d.insertBefore(g,t),e.one("before-mount",function(){t.parentNode.removeChild(t),d.stub&&(d=e.root)}).on("update",function(){var x=gt(n.val,e),_=document.createDocumentFragment();D(x)||(r=x||!1,x=r?Object.keys(x).map(function(t){return a(n,t,x[t])}):[]);for(var N=0,C=x.length;N<C;N++){var L=x[N],T=o&&typeof L==at&&!r,O=y.indexOf(L),E=~O&&T?O:N,M=b[E];L=!r&&n.key?a(n,L,N):L,!T&&!M||T&&!~O||!M?(M=new h(l,{parent:e,isLoop:!0,hasImpl:!!tt[i],root:p?d:t.cloneNode(),item:L},t.innerHTML),M.mount(),w&&(M._root=M.root.firstChild),N!=b.length&&b[N]?(w?c(M,d,b[N]):d.insertBefore(M.root,b[N].root),y.splice(N,0,L)):w?c(M,_):_.appendChild(M.root),b.splice(N,0,M),E=N):M.update(L,!0),E!==N&&T&&b[N]&&(w?f(M,d,b[N],t.childNodes.length):d.insertBefore(M.root,b[N].root),n.pos&&(M[n.pos]=N),b.splice(N,0,b.splice(E,1)[0]),y.splice(N,0,y.splice(E,1)[0]),!m&&M.tags&&s(M,N)),M._item=L,A(M,"_parent",e)}if(u(x,b),d.insertBefore(_,g),v&&dt&&!d.multiple)for(var R=0;R<d.length;R++)if(d[R].__riot1374){d.selectedIndex=R,delete d[R].__riot1374;break}m&&(e.tags[i]=b),y=x.slice()})}function p(t,e,n,r){P(t,function(t){if(1==t.nodeType){if(t.isLoop=t.isLoop||t.parentNode&&t.parentNode.isLoop||T(t,"each")?1:0,n){var o=E(t);o&&!t.isLoop&&n.push(S(o,{root:t,parent:e},t.innerHTML,e))}t.isLoop&&!r||Z(t,e,[])}})}function d(t,e,n){function r(t,e,r){gt.hasExpr(e)&&n.push(j({dom:t,expr:e},r))}P(t,function(t){var n,o=t.nodeType;if(3==o&&"STYLE"!=t.parentNode.tagName&&r(t,t.nodeValue),1==o)return(n=T(t,"each"))?(l(t,e,n),!1):(b(t.attributes,function(e){var n=e.name,o=n.split("__")[1];if(r(t,e.value,{attr:o||n,bool:o}),o)return C(t,n),!1}),!E(t)&&void 0)})}function h(t,e,n){function r(){var t=m&&g?f:h||f;b(T.attributes,function(e){var n=e.value;l[L(e.name)]=gt.hasExpr(n)?gt(n,t):n}),b(Object.keys(M),function(e){l[L(e)]=gt(M[e],t)})}function o(t){for(var e in x)typeof f[e]!==ut&&H(f,e)&&(f[e]=t[e])}function a(){f.parent&&g&&b(Object.keys(f.parent),function(t){var e=!ft.test(t)&&I(R,t);(typeof f[t]===ut||e)&&(e||R.push(t),f[t]=f.parent[t])})}function u(t){f.update(t,!0)}function s(t){if(b(_,function(e){e[t?"mount":"unmount"]()}),h){var e=t?"on":"off";g?h[e]("unmount",f.unmount):h[e]("update",u)[e]("unmount",f.unmount)}}var c,f=Y.observable(this),l=G(e.opts)||{},h=e.parent,g=e.isLoop,m=e.hasImpl,x=F(e.item),w=[],_=[],T=e.root,E=T.tagName.toLowerCase(),M={},R=[];t.name&&T._tag&&T._tag.unmount(!0),this.isMounted=!1,T.isLoop=g,T._tag=this,A(this,"_riot_id",++J),j(this,{parent:h,root:T,opts:l},x),A(this,"tags",{}),b(T.attributes,function(t){var e=t.value;gt.hasExpr(e)&&(M[t.name]=e)}),c=mt(t.tmpl,n),A(this,"update",function(t,e){return t=F(t),a(),t&&N(x)&&(o(t),x=t),j(f,t),r(),f.trigger("update",t),v(w,f),e&&f.parent?f.parent.one("updated",function(){f.trigger("updated")}):bt(function(){f.trigger("updated")}),this}),A(this,"mixin",function(){return b(arguments,function(t){var e,n,r=[];t=typeof t===it?Y.mixin(t):t,e=y(t)?new t:t;do r=r.concat(Object.getOwnPropertyNames(n||e));while(n=Object.getPrototypeOf(n||e));b(r,function(t){"init"==t||f[t]||(f[t]=y(e[t])?e[t].bind(f):e[t])}),e.init&&e.init.bind(f)()}),this}),A(this,"mount",function(){r();var e=Y.mixin(et);if(e)for(var n in e)e.hasOwnProperty(n)&&f.mixin(e[n]);if(t.fn&&t.fn.call(f,l),d(c,f,w),s(!0),t.attrs&&B(t.attrs,function(t,e){O(T,t,e)}),(t.attrs||m)&&d(f.root,f,w),f.parent&&!g||f.update(x),f.trigger("before-mount"),g&&!m)T=c.firstChild;else{for(;c.firstChild;)T.appendChild(c.firstChild);T.stub&&(T=h.root)}A(f,"root",T),g&&p(f.root,f.parent,null,!0),!f.parent||f.parent.isMounted?(f.isMounted=!0,f.trigger("mount")):f.parent.one("mount",function(){K(f.root)||(f.parent.isMounted=f.isMounted=!0,f.trigger("mount"))})}),A(this,"unmount",function(t){var e,n=T,r=n.parentNode,o=W.indexOf(f);if(f.trigger("before-unmount"),~o&&W.splice(o,1),r){if(h)e=k(h),D(e.tags[E])?b(e.tags[E],function(t,n){t._riot_id==f._riot_id&&e.tags[E].splice(n,1)}):e.tags[E]=i;else for(;n.firstChild;)n.removeChild(n.firstChild);t?(C(r,ot),C(r,rt)):r.removeChild(n)}this._virts&&b(this._virts,function(t){t.parentNode&&t.parentNode.removeChild(t)}),f.trigger("unmount"),s(),f.off("*"),f.isMounted=!1,delete T._tag}),p(c,this,_)}function g(t,e,n,r){n[t]=function(t){var i,a=r._parent,u=r._item;if(!u)for(;a&&!u;)u=a._item,a=a._parent;t=t||o.event,H(t,"currentTarget")&&(t.currentTarget=n),H(t,"target")&&(t.target=t.srcElement),H(t,"which")&&(t.which=t.charCode||t.keyCode),t.item=u,e.call(r,t)===!0||/radio|check/.test(n.type)||(t.preventDefault&&t.preventDefault(),t.returnValue=!1),t.preventUpdate||(i=u?k(a):r,i.update())}}function m(t,e,n){t&&(t.insertBefore(n,e),t.removeChild(e))}function v(t,e){b(t,function(t,n){var r=t.dom,o=t.attr,i=gt(t.expr,e),a=t.dom.parentNode;if(t.bool?i=!!i:null==i&&(i=""),t.value!==i){if(t.value=i,!o)return i+="",void(a&&("TEXTAREA"===a.tagName?(a.value=i,pt||(r.nodeValue=i)):r.nodeValue=i));if("value"===o)return void(r.value=i);if(C(r,o),y(i))g(o,i,r,e);else if("if"==o){var u=t.stub,s=function(){m(u.parentNode,u,r)},c=function(){m(r.parentNode,r,u)};i?u&&(s(),r.inStub=!1,K(r)||P(r,function(t){t._tag&&!t._tag.isMounted&&(t._tag.isMounted=!!t._tag.trigger("mount"))})):(u=t.stub=u||document.createTextNode(""),r.parentNode?c():(e.parent||e).one("updated",c),r.inStub=!0)}else"show"===o?r.style.display=i?"":"none":"hide"===o?r.style.display=i?"none":"":t.bool?(r[o]=i,i&&O(r,o,o),dt&&"selected"===o&&"OPTION"===r.tagName&&(r.__riot1374=i)):(0===i||i&&typeof i!==at)&&(Q(o,nt)&&o!=rt&&(o=o.slice(nt.length)),O(r,o,i))}})}function b(t,e){for(var n,r=t?t.length:0,o=0;o<r;o++)n=t[o],null!=n&&e(n,o)===!1&&o--;return t}function y(t){return typeof t===st||!1}function x(t){if(t.outerHTML)return t.outerHTML;var e=q("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML}function w(t,e){if(typeof t.innerHTML!=ut)t.innerHTML=e;else{var n=(new DOMParser).parseFromString(e,"application/xml");t.appendChild(t.ownerDocument.importNode(n.documentElement,!0))}}function _(t){return~lt.indexOf(t)}function N(t){return t&&typeof t===at}function C(t,e){t.removeAttribute(e)}function L(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})}function T(t,e){return t.getAttribute(e)}function O(t,e,n){t.setAttribute(e,n)}function E(t){return t.tagName&&tt[T(t,ot)||T(t,rt)||t.tagName.toLowerCase()]}function M(t,e,n){var r=n.tags[e];r?(D(r)||r!==t&&(n.tags[e]=[r]),I(n.tags[e],t)||n.tags[e].push(t)):n.tags[e]=t}function R(t,e,n){var r,o=t.parent;o&&(r=o.tags[e],D(r)?r.splice(n,0,r.splice(r.indexOf(t),1)[0]):M(t,e,o))}function S(t,e,n,r){var o=new h(t,e,n),i=$(e.root),a=k(r);return o.parent=a,o._parent=r,M(o,i,a),a!==r&&M(o,i,r),e.root.innerHTML="",o}function k(t){for(var e=t;!E(e.root)&&e.parent;)e=e.parent;return e}function A(t,e,n,r){return Object.defineProperty(t,e,j({value:n,enumerable:!1,writable:!1,configurable:!0},r)),t}function $(t){var e=E(t),n=T(t,"name"),r=n&&!gt.hasExpr(n)?n:e?e.name:t.tagName.toLowerCase();return r}function j(t){for(var e,n=arguments,r=1;r<n.length;++r)if(e=n[r])for(var o in e)H(t,o)&&(t[o]=e[o]);return t}function I(t,e){return~t.indexOf(e)}function D(t){return Array.isArray(t)||t instanceof Array}function H(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return typeof t[e]===ut||n&&n.writable}function F(t){if(!(t instanceof h||t&&typeof t.trigger==st))return t;var e={};for(var n in t)ft.test(n)||(e[n]=t[n]);return e}function P(t,e){if(t){if(e(t)===!1)return;for(t=t.firstChild;t;)P(t,e),t=t.nextSibling}}function B(t,e){for(var n,r=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g;n=r.exec(t);)e(n[1].toLowerCase(),n[2]||n[3]||n[4])}function K(t){for(;t;){if(t.inStub)return!0;t=t.parentNode}return!1}function q(t,e){return e?document.createElementNS("http://www.w3.org/2000/svg","svg"):document.createElement(t)}function U(t,e){return(e||document).querySelectorAll(t)}function z(t,e){return(e||document).querySelector(t)}function G(t){function e(){}return e.prototype=t,new e}function V(t){return T(t,"id")||T(t,"name")}function Z(t,e,n){var r,o=V(t),i=function(i){I(n,o)||(r=D(i),i?(!r||r&&!I(i,t))&&(r?i.push(t):e[o]=[i,t]):e[o]=t)};o&&(gt.hasExpr(o)?e.one("mount",function(){o=V(t),i(e[o])}):i(e[o]))}function Q(t,e){return t.slice(0,e.length)===e}function X(t,e,n){var r=tt[e],o=t._innerHTML=t._innerHTML||t.innerHTML;return t.innerHTML="",r&&t&&(r=new h(r,{root:t,opts:n},o)),r&&r.mount&&(r.mount(),I(W,r)||W.push(r)),r}var Y={version:"v2.5.0",settings:{}},J=0,W=[],tt={},et="__global_mixin",nt="riot-",rt=nt+"tag",ot="data-is",it="string",at="object",ut="undefined",st="function",ct=/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?|opt(?:ion|group))$/,ft=/^(?:_(?:item|id|parent)|update|root|(?:un)?mount|mixin|is(?:Mounted|Loop)|tags|parent|opts|trigger|o(?:n|ff|ne))$/,lt=["altGlyph","animate","animateColor","circle","clipPath","defs","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","filter","font","foreignObject","g","glyph","glyphRef","image","line","linearGradient","marker","mask","missing-glyph","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","switch","symbol","text","textPath","tref","tspan","use"],pt=0|(o&&o.document||{}).documentMode,dt=o&&!!o.InstallTrigger;Y.observable=function(t){function e(t,e){for(var n,r,o=t.split(" "),i=o.length,a=0;a<i;a++)n=o[a],r=n.indexOf("."),n&&e(~r?n.substring(0,r):n,a,~r?n.slice(r+1):null)}t=t||{};var n={},r=Array.prototype.slice;return Object.defineProperties(t,{on:{value:function(r,o){return"function"!=typeof o?t:(e(r,function(t,e,r){(n[t]=n[t]||[]).push(o),o.typed=e>0,o.ns=r}),t)},enumerable:!1,writable:!1,configurable:!1},off:{value:function(r,o){return"*"!=r||o?e(r,function(t,e,r){if(o||r)for(var i,a=n[t],u=0;i=a&&a[u];++u)(i==o||r&&i.ns==r)&&a.splice(u--,1);else delete n[t]}):n={},t},enumerable:!1,writable:!1,configurable:!1},one:{value:function(e,n){function r(){t.off(e,r),n.apply(t,arguments)}return t.on(e,r)},enumerable:!1,writable:!1,configurable:!1},trigger:{value:function(o){for(var i,a=arguments.length-1,u=new Array(a),s=0;s<a;s++)u[s]=arguments[s+1];return e(o,function(e,o,a){i=r.call(n[e]||[],0);for(var s,c=0;s=i[c];++c)s.busy||(s.busy=1,a&&s.ns!=a||s.apply(t,s.typed?[e].concat(u):u),i[c]!==s&&c--,s.busy=0);n["*"]&&"*"!=e&&t.trigger.apply(t,["*",e].concat(u))}),t},enumerable:!1,writable:!1,configurable:!1}}),t},function(t){function e(t){return t.split(/[\/?#]/)}function n(t,e){var n=new RegExp("^"+e[C](/\*/g,"([^/?#]+?)")[C](/\.\./,".*")+"$"),r=t.match(n);if(r)return r.slice(1)}function r(t,e){var n;return function(){clearTimeout(n),n=setTimeout(t,e)}}function i(t){h=r(l,1),M[_](L,h),M[_](T,h),R[_]($,p),t&&l(!0)}function a(){this.$=[],t.observable(this),I.on("stop",this.s.bind(this)),I.on("emit",this.e.bind(this))}function u(t){return t[C](/^\/|\/$/,"")}function s(t){return"string"==typeof t}function c(t){return(t||k.href)[C](y,"")}function f(t){return"#"==g[0]?(t||k.href||"").split(g)[1]||"":(k?c(t):t||"")[C](g,"")}function l(t){var e=0==F;if(!(E<=F)&&(F++,H.push(function(){var e=f();(t||e!=m)&&(I[O]("emit",e),m=e)}),e)){for(;H.length;)H[0](),H.shift();F=0}}function p(t){if(!(1!=t.which||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){for(var e=t.target;e&&"A"!=e.nodeName;)e=e.parentNode;!e||"A"!=e.nodeName||e[N]("download")||!e[N]("href")||e.target&&"_self"!=e.target||e.href.indexOf(k.href.match(y)[0])==-1||(e.href==k.href||e.href.split("#")[0]!=k.href.split("#")[0]&&("#"==g||0===c(e.href).indexOf(g))&&d(f(e.href),e.title||R.title))&&t.preventDefault()}}function d(t,e,n){return S?(t=g+u(t),e=e||R.title,n?S.replaceState(null,e,t):S.pushState(null,e,t),R.title=e,D=!1,l(),D):I[O]("emit",f(t))}var h,g,m,v,b,y=/^.+?\/\/+[^\/]+/,x="EventListener",w="remove"+x,_="add"+x,N="hasAttribute",C="replace",L="popstate",T="hashchange",O="trigger",E=3,M="undefined"!=typeof o&&o,R="undefined"!=typeof document&&document,S=M&&history,k=M&&(S.location||M.location),A=a.prototype,$=R&&R.ontouchstart?"touchstart":"click",j=!1,I=t.observable(),D=!1,H=[],F=0;A.m=function(t,e,n){!s(t)||e&&!s(e)?e?this.r(t,e):this.r("@",t):d(t,e,n||!1)},A.s=function(){this.off("*"),this.$=[]},A.e=function(t){this.$.concat("@").some(function(e){var n=("@"==e?v:b)(u(t),u(e));if("undefined"!=typeof n)return this[O].apply(null,[e].concat(n)),D=!0},this)},A.r=function(t,e){"@"!=t&&(t="/"+u(t),this.$.push(t)),this.on(t,e)};var P=new a,B=P.m.bind(P);B.create=function(){var t=new a,e=t.m.bind(t);return e.stop=t.s.bind(t),e},B.base=function(t){g=t||"#",m=f()},B.exec=function(){l(!0)},B.parser=function(t,r){t||r||(v=e,b=n),t&&(v=t),r&&(b=r)},B.query=function(){var t={},e=k.href||m;return e[C](/[?&](.+?)=([^&]*)/g,function(e,n,r){t[n]=r}),t},B.stop=function(){j&&(M&&(M[w](L,h),M[w](T,h),R[w]($,p)),I[O]("stop"),j=!1)},B.start=function(t){j||(M&&("complete"==document.readyState?i(t):M[_]("load",function(){setTimeout(function(){i(t)},1)})),j=!0)},B.base(),B.parser(),t.route=B}(Y);var ht=function(t){function e(t){return t}function n(t,e){return e||(e=v),new RegExp(t.source.replace(/{/g,e[2]).replace(/}/g,e[3]),t.global?c:"")}function r(t){if(t===h)return g;var e=t.split(" ");if(2!==e.length||/[\x00-\x1F<>a-zA-Z0-9'",;\\]/.test(t))throw new Error('Unsupported brackets "'+t+'"');return e=e.concat(t.replace(/(?=[[\]()*+?.^$|])/g,"\\").split(" ")),e[4]=n(e[1].length>1?/{[\S\s]*?}/:g[4],e),e[5]=n(t.length>3?/\\({|})/g:g[5],e),e[6]=n(g[6],e),e[7]=RegExp("\\\\("+e[3]+")|([[({])|("+e[3]+")|"+p,c),e[8]=t,e}function o(t){return t instanceof RegExp?u(t):v[t]}function i(t){(t||(t=h))!==v[8]&&(v=r(t),u=t===h?e:n,v[9]=u(g[9])),m=t}function a(t){var e;t=t||{},e=t.brackets,Object.defineProperty(t,"brackets",{set:i,get:function(){return m},enumerable:!0}),s=t,i(e)}var u,s,c="g",f=/\/\*[^*]*\*+(?:[^*\/][^*]*\*+)*\//g,l=/"[^"\\]*(?:\\[\S\s][^"\\]*)*"|'[^'\\]*(?:\\[\S\s][^'\\]*)*'/g,p=l.source+"|"+/(?:\breturn\s+|(?:[$\w\)\]]|\+\+|--)\s*(\/)(?![*\/]))/.source+"|"+/\/(?=[^*\/])[^[\/\\]*(?:(?:\[(?:\\.|[^\]\\]*)*\]|\\.)[^[\/\\]*)*?(\/)[gim]*/.source,d={"(":RegExp("([()])|"+p,c),"[":RegExp("([[\\]])|"+p,c),"{":RegExp("([{}])|"+p,c)},h="{ }",g=["{","}","{","}",/{[^}]*}/,/\\([{}])/g,/\\({)|{/g,RegExp("\\\\(})|([[({])|(})|"+p,c),h,/^\s*{\^?\s*([$\w]+)(?:\s*,\s*(\S+))?\s+in\s+(\S.*)\s*}/,/(^|[^\\]){=[\S\s]*?}/],m=t,v=[];return o.split=function(t,e,n){function r(t){e||a?c.push(t&&t.replace(n[5],"$1")):c.push(t)}function o(t,e,n){var r,o=d[e];for(o.lastIndex=n,n=1;(r=o.exec(t))&&(!r[1]||(r[1]===e?++n:--n)););return n?t.length:o.lastIndex}n||(n=v);var i,a,u,s,c=[],f=n[6];for(a=u=f.lastIndex=0;i=f.exec(t);){if(s=i.index,a){if(i[2]){f.lastIndex=o(t,i[2],f.lastIndex);continue}if(!i[3])continue}i[1]||(r(t.slice(u,s)),u=f.lastIndex,f=n[6+(a^=1)],f.lastIndex=u)}return t&&u<t.length&&r(t.slice(u)),c},o.hasExpr=function(t){return v[4].test(t)},o.loopKeys=function(t){var e=t.match(v[9]);return e?{key:e[1],pos:e[2],val:v[0]+e[3].trim()+v[1]}:{val:t.trim()}},o.array=function(t){return t?r(t):v},Object.defineProperty(o,"settings",{set:a,get:function(){return s}}),o.settings="undefined"!=typeof Y&&Y.settings||{},o.set=i,o.R_STRINGS=l,o.R_MLCOMMS=f,o.S_QBLOCKS=p,o}(),gt=function(){function t(t,r){return t?(u[t]||(u[t]=n(t))).call(r,e):t}function e(e,n){t.errorHandler&&(e.riotData={tagName:n&&n.root&&n.root.tagName,_riot_id:n&&n._riot_id},t.errorHandler(e))}function n(t){var e=r(t);return"try{return "!==e.slice(0,11)&&(e="return "+e),new Function("E",e+";")}function r(t){var e,n=[],r=ht.split(t.replace(l,'"'),1);if(r.length>2||r[0]){var o,a,u=[];for(o=a=0;o<r.length;++o)e=r[o],e&&(e=1&o?i(e,1,n):'"'+e.replace(/\\/g,"\\\\").replace(/\r\n?|\n/g,"\\n").replace(/"/g,'\\"')+'"')&&(u[a++]=e);e=a<2?u[0]:"["+u.join(",")+'].join("")'}else e=i(r[1],0,n);return n[0]&&(e=e.replace(p,function(t,e){return n[e].replace(/\r/g,"\\r").replace(/\n/g,"\\n")})),e}function i(t,e,n){function r(e,n){var r,o=1,i=d[e];for(i.lastIndex=n.lastIndex;r=i.exec(t);)if(r[0]===e)++o;else if(!--o)break;n.lastIndex=o?t.length:i.lastIndex}if(t=t.replace(f,function(t,e){return t.length>2&&!e?s+(n.push(t)-1)+"~":t}).replace(/\s+/g," ").trim().replace(/\ ?([[\({},?\.:])\ ?/g,"$1")){for(var o,i=[],u=0;t&&(o=t.match(c))&&!o.index;){var l,p,h=/,|([[{(])|$/g;for(t=RegExp.rightContext,l=o[2]?n[o[2]].slice(1,-1).trim().replace(/\s+/g," "):o[1];p=(o=h.exec(t))[1];)r(p,h);p=t.slice(0,o.index),t=RegExp.rightContext,i[u++]=a(p,1,l)}t=u?u>1?"["+i.join(",")+'].join(" ").trim()':i[0]:a(t,e)}return t}function a(t,e,n){var r;return t=t.replace(g,function(t,e,n,o,i){return n&&(o=r?0:o+t.length,"this"!==n&&"global"!==n&&"window"!==n?(t=e+'("'+n+h+n,o&&(r="."===(i=i[o])||"("===i||"["===i)):o&&(r=!m.test(i.slice(o)))),t}),r&&(t="try{return "+t+"}catch(e){E(e,this)}"),n?t=(r?"function(){"+t+"}.call(this)":"("+t+")")+'?"'+n+'":""':e&&(t="function(v){"+(r?t.replace("return ","v="):"v=("+t+")")+';return v||v===0?v:""}.call(this)'),t}var u={};t.haveRaw=ht.hasRaw,t.hasExpr=ht.hasExpr,t.loopKeys=ht.loopKeys,t.errorHandler=null;var s="‚Åó",c=/^(?:(-?[_A-Za-z\xA0-\xFF][-\w\xA0-\xFF]*)|\u2057(\d+)~):/,f=RegExp(ht.S_QBLOCKS,"g"),l=/\u2057/g,p=/\u2057(\d+)~/g,d={"(":/[()]/g,"[":/[[\]]/g,"{":/[{}]/g},h='"in this?this:'+("object"!=typeof o?"global":"window")+").",g=/[,{][$\w]+:|(^ *|[^$\w\.])(?!(?:typeof|true|false|null|undefined|in|instanceof|is(?:Finite|NaN)|void|NaN|new|Date|RegExp|Math)(?![$\w]))([$_A-Za-z][$\w]*)/g,m=/^(?=(\.[$\w]+))\1(?:[^.[(]|$)/;return t.parse=function(t){return t},t.version=ht.version="v2.4.0",t}(),mt=function t(){function t(t,r){var o=t&&t.match(/^\s*<([-\w]+)/),i=o&&o[1].toLowerCase(),a=q("div",_(i));return t=n(t,r),s.test(i)?a=e(a,t,i):w(a,t),a.stub=!0,a}function e(t,e,n){var r="o"===n[0],o=r?"select>":"table>";if(t.innerHTML="<"+o+e.trim()+"</"+o,o=t.firstChild,r)o.selectedIndex=-1;else{var i=u[n];i&&1===o.childElementCount&&(o=z(i,o))}return o}function n(t,e){if(!r.test(t))return t;var n={};return e=e&&e.replace(i,function(t,e,r){return n[e]=n[e]||r,""}).trim(),t.replace(a,function(t,e,r){return n[e]||r||""}).replace(o,function(t,n){return e||n||""})}var r=/<yield\b/i,o=/<yield\s*(?:\/>|>([\S\s]*?)<\/yield\s*>|>)/gi,i=/<yield\s+to=['"]([^'">]*)['"]\s*>([\S\s]*?)<\/yield\s*>/gi,a=/<yield\s+from=['"]?([-\w]+)['"]?\s*(?:\/>|>([\S\s]*?)<\/yield\s*>)/gi,u={tr:"tbody",th:"tr",td:"tr",col:"colgroup"},s=pt&&pt<10?ct:/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?)$/;return t}(),vt=function(t){if(!o)return{add:function(){},inject:function(){}};var e=function(){var t=q("style");O(t,"type","text/css");var e=z("style[type=riot]");return e?(e.id&&(t.id=e.id),e.parentNode.replaceChild(t,e)):document.getElementsByTagName("head")[0].appendChild(t),t}(),n=e.styleSheet,r="";return Object.defineProperty(t,"styleNode",{value:e,writable:!0}),{add:function(t){r+=t},inject:function(){r&&(n?n.cssText+=r:e.innerHTML+=r,r="")}}}(Y),bt=function(t){var e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame;if(!e||/iP(ad|hone|od).*OS 6/.test(t.navigator.userAgent)){var n=0;e=function(t){var e=Date.now(),r=Math.max(16-(e-n),0);setTimeout(function(){t(n=e+r)},r)}}return e}(o||{});Y.util={brackets:ht,tmpl:gt},Y.mixin=function(){var t={},e=t[et]={},n=0;return function(r,o,i){if(N(r))return void Y.mixin("__unnamed_"+n++,r,!0);var a=i?e:t;if(!o){if(typeof a[r]===ut)throw new Error("Unregistered mixin: "+r);return a[r]}y(o)?(j(o.prototype,a[r]||{}),a[r]=o):a[r]=j(a[r]||{},o)}}(),Y.tag=function(t,e,n,r,o){return y(r)&&(o=r,/^[\w\-]+\s?=/.test(n)?(r=n,n=""):r=""),n&&(y(n)?o=n:vt.add(n)),t=t.toLowerCase(),tt[t]={name:t,tmpl:e,attrs:r,fn:o},t},Y.tag2=function(t,e,n,r,o){return n&&vt.add(n),tt[t]={name:t,tmpl:e,attrs:r,fn:o},t},Y.mount=function(t,e,n){function r(t){var e="";return b(t,function(t){/[^-\w]/.test(t)||(t=t.trim().toLowerCase(),e+=",["+ot+'="'+t+'"],['+rt+'="'+t+'"]')}),e}function o(){var t=Object.keys(tt);return t+r(t)}function i(t){if(t.tagName){var r=T(t,ot)||T(t,rt);e&&r!==e&&(r=e,O(t,ot,e),O(t,rt,e));var o=X(t,r||t.tagName.toLowerCase(),n);o&&s.push(o)}else t.length&&b(t,i)}var a,u,s=[];if(vt.inject(),N(e)&&(n=e,e=0),typeof t===it?("*"===t?t=u=o():t+=r(t.split(/, */)),a=t?U(t):[]):a=t,"*"===e){if(e=u||o(),a.tagName)a=U(e,a);else{var c=[];b(a,function(t){c.push(U(e,t))}),a=c}e=0}return i(a),s},Y.update=function(){return b(W,function(t){t.update()})},Y.vdom=W,Y.Tag=h,typeof e===at?t.exports=Y:"function"===st&&typeof n(3)!==ut?(r=function(){return Y}.call(e,n,e,t),!(r!==i&&(t.exports=r))):o.riot=Y}("undefined"!=typeof window?window:void 0)},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,n){(function(t){"use strict";var e=n(5);t.tag2("name",'<h1>Name {name} {opts.last}, {opts.first} : {count}</h1> <foo> <button onclick="{click}">Count</button>',"","",function(t){var n=this;this.name=e.name,this.count=0,this.click=function(){n.count++}}),t.tag2("foo","<h2>required {name}</h2>","","",function(t){var e=n(5);this.name=e.name})}).call(e,n(2))},function(t,e){"use strict";t.exports={name:"this is an imported module"}},function(t,e,n){(function(t){"use strict";t.tag2("loan",'<h3>Loan {name}</h3> <input type="text" placeholder="Name" value="{loan.title}" onchange="{refresh}"> <input value="{loan.amount}" onchange="{refresh}" type="{\'number\'}">',"","",function(t){var e=this;this.loan=this.opts.loan,this.refresh=function(){e.update()}}),t.tag2("loans",'<h2>{title}</h2> <button onclick="{add}">Add</button> <loan each="{loan in loans}" loan="{loan}"></loan>',"","",function(t){var e=this;this.add=function(){e.loans.unshift({})},this.loans=[],this.title="Loans"}),t.tag2("application","<h1>{title}</h1> <loans></loans> <h1>{foo()}</h1>","","",function(t){this.title="Consolidate",this.foo=function(){return"bar"}}),t.tag2("debt-list",'<h1>Debts</h1> <div each="{debt in debts}"> <card heading="{debt.name}"> <h3>Amount: ${debt.remaining}</h3> <input onkeyup="{updateName.bind(debt)}" value="{debt.name}" placeholder="Name" type="text"> </input> <input onkeyup="{updateOutsanding.bind(debt)}" value="{debt.remaining}" placeholder="outstanding debt (in dollars)" step="0.01" min="0.01" type="{\'number\'}"> <div prefix>$&nbsp;</div> </input> <div>Use repayments? {debt.useRepayments}</div> <input type="checkbox" onchange="{toggleRepayments.bind(null, debt)}">Use Repayments</input> <listbox> <div each="{repayment in debt.repayments}"> <item>{repayment}</item> </div> </listbox> <button onclick="{addRepayment}">Add Repayment</button> <button onclick="{remove}">Remove Debt</button> </card> </template> <div> <button onclick="{add}">Add New Debt</button> </div>',":host { display: block; padding: 16px; }","",function(t){var e=this;this.updateOutsanding=function(t){e.remaining=parseFloat(t.target.value),e.update()},this.updateName=function(t){e.name=t.target.value,e.update()};var n=0,r=0;this.total=r,this.debts=[{name:"Fake Debt",remaining:n,useRepayments:!0,repayments:[]}],this.toggleRepayments=function(t){t.useRepayments=!t.useRepayments,e.update()},this.add=function(){var t;e.debts.push((t={name:"Debt",remaining:0,repayments:["foo","bar","baz"],useRepayments:!0},t.remaining=n,t)),e.update()},this.remove=function(t){e.debts.splice(t.model.index,1),e.update()},this.on("update",function(){e.total=e.debts.reduce(function(t,e){return t+(parseInt(e.remaining,10)||n)},r)})})}).call(e,n(2))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbWFpbi5idW5kbGUubWluLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCBlMGQxN2VlOTUxZjYyODQzNGI5OCIsIndlYnBhY2s6Ly8vLi9zb3VyY2UvY2xpZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vcmlvdC9yaW90LmpzIiwid2VicGFjazovLy8od2VicGFjaykvYnVpbGRpbi9hbWQtb3B0aW9ucy5qcyIsIndlYnBhY2s6Ly8vLi9zb3VyY2UvY2xpZW50L25hbWUudGFnIiwid2VicGFjazovLy8uL3NvdXJjZS9jbGllbnQvbW9kdWxlLmpzIiwid2VicGFjazovLy8uL3NvdXJjZS9jbGllbnQvYXBwbGljYXRpb24udGFnIl0sIm5hbWVzIjpbIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiZXhwb3J0cyIsIm1vZHVsZSIsImlkIiwibG9hZGVkIiwiY2FsbCIsIm0iLCJjIiwicCIsInJpb3QiLCJtb3VudCIsIl9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fIiwid2luZG93IiwidW5kZWZpbmVkIiwibWtpdGVtIiwiZXhwciIsImtleSIsInZhbCIsIml0ZW0iLCJwb3MiLCJ1bm1vdW50UmVkdW5kYW50IiwiaXRlbXMiLCJ0YWdzIiwidCIsImkiLCJsZW5ndGgiLCJqIiwic3BsaWNlIiwidW5tb3VudCIsIm1vdmVOZXN0ZWRUYWdzIiwiY2hpbGQiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsInRhZ05hbWUiLCJ0YWciLCJpc0FycmF5IiwiZWFjaCIsIm1vdmVDaGlsZFRhZyIsImFkZFZpcnR1YWwiLCJzcmMiLCJ0YXJnZXQiLCJzaWIiLCJlbCIsIl9yb290IiwiX3ZpcnRzIiwibmV4dFNpYmxpbmciLCJpbnNlcnRCZWZvcmUiLCJhcHBlbmRDaGlsZCIsInB1c2giLCJtb3ZlVmlydHVhbCIsImxlbiIsIl9lYWNoIiwiZG9tIiwicGFyZW50IiwicmVtQXR0ciIsImhhc0tleXMiLCJtdXN0UmVvcmRlciIsImdldEF0dHIiLCJUX1NUUklORyIsImdldFRhZ05hbWUiLCJpbXBsIiwiX190YWdJbXBsIiwidG1wbCIsImdldE91dGVySFRNTCIsInVzZVJvb3QiLCJTUEVDSUFMX1RBR1NfUkVHRVgiLCJ0ZXN0Iiwicm9vdCIsInBhcmVudE5vZGUiLCJyZWYiLCJkb2N1bWVudCIsImNyZWF0ZVRleHROb2RlIiwiZ2V0VGFnIiwiaXNPcHRpb24iLCJ0b0xvd2VyQ2FzZSIsIm9sZEl0ZW1zIiwiaXNWaXJ0dWFsIiwibG9vcEtleXMiLCJvbmUiLCJyZW1vdmVDaGlsZCIsInN0dWIiLCJvbiIsImZyYWciLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwibWFwIiwiaXRlbXNMZW5ndGgiLCJfbXVzdFJlb3JkZXIiLCJUX09CSkVDVCIsIm9sZFBvcyIsImluZGV4T2YiLCJUYWciLCJpc0xvb3AiLCJoYXNJbXBsIiwiY2xvbmVOb2RlIiwiaW5uZXJIVE1MIiwiZmlyc3RDaGlsZCIsInVwZGF0ZSIsImNoaWxkTm9kZXMiLCJfaXRlbSIsImRlZmluZVByb3BlcnR5IiwiRklSRUZPWCIsIm11bHRpcGxlIiwibiIsIl9fcmlvdDEzNzQiLCJzZWxlY3RlZEluZGV4Iiwic2xpY2UiLCJwYXJzZU5hbWVkRWxlbWVudHMiLCJjaGlsZFRhZ3MiLCJmb3JjZVBhcnNpbmdOYW1lZCIsIndhbGsiLCJub2RlVHlwZSIsImluaXRDaGlsZFRhZyIsInNldE5hbWVkIiwicGFyc2VFeHByZXNzaW9ucyIsImV4cHJlc3Npb25zIiwiYWRkRXhwciIsImV4dHJhIiwiaGFzRXhwciIsImV4dGVuZCIsImF0dHIiLCJ0eXBlIiwibm9kZVZhbHVlIiwiYXR0cmlidXRlcyIsIm5hbWUiLCJib29sIiwic3BsaXQiLCJ2YWx1ZSIsImNvbmYiLCJ1cGRhdGVPcHRzIiwiY3R4Iiwic2VsZiIsIm9wdHMiLCJ0b0NhbWVsIiwibm9ybWFsaXplRGF0YSIsImRhdGEiLCJUX1VOREVGIiwiaXNXcml0YWJsZSIsImluaGVyaXRGcm9tUGFyZW50IiwiayIsIm11c3RTeW5jIiwiUkVTRVJWRURfV09SRFNfQkxBQ0tMSVNUIiwiY29udGFpbnMiLCJwcm9wc0luU3luY1dpdGhQYXJlbnQiLCJvbkNoaWxkVXBkYXRlIiwidG9nZ2xlIiwiaXNNb3VudCIsImV2dCIsIm9ic2VydmFibGUiLCJ0aGlzIiwiaW5oZXJpdCIsImNsZWFuVXBEYXRhIiwiX3RhZyIsImlzTW91bnRlZCIsIl9fdWlkIiwibWtkb20iLCJpc0luaGVyaXRlZCIsImlzT2JqZWN0IiwidHJpZ2dlciIsInJBRiIsImFyZ3VtZW50cyIsIm1peCIsImluc3RhbmNlIiwib2JqIiwicHJvcHMiLCJtaXhpbiIsImlzRnVuY3Rpb24iLCJjb25jYXQiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiZ2V0UHJvdG90eXBlT2YiLCJiaW5kIiwiaW5pdCIsImdsb2JhbE1peGluIiwiR0xPQkFMX01JWElOIiwiaGFzT3duUHJvcGVydHkiLCJmbiIsImF0dHJzIiwid2Fsa0F0dHJpYnV0ZXMiLCJ2Iiwic2V0QXR0ciIsImlzSW5TdHViIiwia2VlcFJvb3RUYWciLCJwdGFnIiwidGFnSW5kZXgiLCJfX3ZpcnR1YWxEb20iLCJnZXRJbW1lZGlhdGVDdXN0b21QYXJlbnRUYWciLCJfcmlvdF9pZCIsIlJJT1RfVEFHX0lTIiwiUklPVF9UQUciLCJvZmYiLCJzZXRFdmVudEhhbmRsZXIiLCJoYW5kbGVyIiwiZSIsIl9wYXJlbnQiLCJldmVudCIsImN1cnJlbnRUYXJnZXQiLCJzcmNFbGVtZW50Iiwid2hpY2giLCJjaGFyQ29kZSIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsInJldHVyblZhbHVlIiwicHJldmVudFVwZGF0ZSIsImluc2VydFRvIiwibm9kZSIsImJlZm9yZSIsImF0dHJOYW1lIiwiSUVfVkVSU0lPTiIsImFkZCIsInJlbW92ZSIsImluU3R1YiIsInN0eWxlIiwiZGlzcGxheSIsInN0YXJ0c1dpdGgiLCJSSU9UX1BSRUZJWCIsImVscyIsIlRfRlVOQ1RJT04iLCJvdXRlckhUTUwiLCJjb250YWluZXIiLCJta0VsIiwic2V0SW5uZXJIVE1MIiwiaHRtbCIsImRvYyIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsIm93bmVyRG9jdW1lbnQiLCJpbXBvcnROb2RlIiwiZG9jdW1lbnRFbGVtZW50IiwiaXNTVkdUYWciLCJTVkdfVEFHU19MSVNUIiwicmVtb3ZlQXR0cmlidXRlIiwic3RyaW5nIiwicmVwbGFjZSIsIl8iLCJ0b1VwcGVyQ2FzZSIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsImFkZENoaWxkVGFnIiwiY2FjaGVkVGFnIiwibmV3UG9zIiwib3B0aW9ucyIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImNvbmZpZ3VyYWJsZSIsIm5hbWVkVGFnIiwiYXJncyIsImFyciIsImEiLCJBcnJheSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIm8iLCJyZSIsImV4ZWMiLCJpc1N2ZyIsImNyZWF0ZUVsZW1lbnROUyIsImNyZWF0ZUVsZW1lbnQiLCIkJCIsInNlbGVjdG9yIiwicXVlcnlTZWxlY3RvckFsbCIsIiQiLCJxdWVyeVNlbGVjdG9yIiwiQ2hpbGQiLCJwcm90b3R5cGUiLCJnZXROYW1lZEtleSIsImlzQXJyIiwic3RyIiwibW91bnRUbyIsIl9pbm5lckhUTUwiLCJ2ZXJzaW9uIiwic2V0dGluZ3MiLCJkb2N1bWVudE1vZGUiLCJJbnN0YWxsVHJpZ2dlciIsIm9uRWFjaEV2ZW50IiwiaW5keCIsImVzIiwibCIsInN1YnN0cmluZyIsImNhbGxiYWNrcyIsImRlZmluZVByb3BlcnRpZXMiLCJldmVudHMiLCJucyIsInR5cGVkIiwiY2IiLCJhcHBseSIsImZucyIsImFyZ2xlbiIsImJ1c3kiLCJERUZBVUxUX1BBUlNFUiIsInBhdGgiLCJERUZBVUxUX1NFQ09ORF9QQVJTRVIiLCJmaWx0ZXIiLCJSZWdFeHAiLCJSRVBMQUNFIiwibWF0Y2giLCJkZWJvdW5jZSIsImRlbGF5IiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsInN0YXJ0IiwiYXV0b0V4ZWMiLCJkZWJvdW5jZWRFbWl0IiwiZW1pdCIsIndpbiIsIkFERF9FVkVOVF9MSVNURU5FUiIsIlBPUFNUQVRFIiwiSEFTSENIQU5HRSIsImNsaWNrRXZlbnQiLCJjbGljayIsIlJvdXRlciIsImNlbnRyYWwiLCJzIiwibm9ybWFsaXplIiwiaXNTdHJpbmciLCJnZXRQYXRoRnJvbVJvb3QiLCJocmVmIiwibG9jIiwiUkVfT1JJR0lOIiwiZ2V0UGF0aEZyb21CYXNlIiwiYmFzZSIsImZvcmNlIiwiaXNSb290IiwiZW1pdFN0YWNrTGV2ZWwiLCJNQVhfRU1JVF9TVEFDS19MRVZFTCIsImVtaXRTdGFjayIsImN1cnJlbnQiLCJUUklHR0VSIiwic2hpZnQiLCJtZXRhS2V5IiwiY3RybEtleSIsInNoaWZ0S2V5IiwiZGVmYXVsdFByZXZlbnRlZCIsIm5vZGVOYW1lIiwiSEFTX0FUVFJJQlVURSIsImdvIiwidGl0bGUiLCJzaG91bGRSZXBsYWNlIiwiaGlzdCIsInJlcGxhY2VTdGF0ZSIsInB1c2hTdGF0ZSIsInJvdXRlRm91bmQiLCJwYXJzZXIiLCJzZWNvbmRQYXJzZXIiLCJFVkVOVF9MSVNURU5FUiIsIlJFTU9WRV9FVkVOVF9MSVNURU5FUiIsImhpc3RvcnkiLCJsb2NhdGlvbiIsInByb3QiLCJvbnRvdWNoc3RhcnQiLCJzdGFydGVkIiwiZmlyc3QiLCJzZWNvbmQiLCJ0aGlyZCIsInIiLCJzb21lIiwiYWN0aW9uIiwibWFpblJvdXRlciIsInJvdXRlIiwiY3JlYXRlIiwibmV3U3ViUm91dGVyIiwicm91dGVyIiwic3RvcCIsImFyZyIsImZuMiIsInF1ZXJ5IiwicSIsInJlYWR5U3RhdGUiLCJicmFja2V0cyIsIlVOREVGIiwiX2xvb3BiYWNrIiwiX3Jld3JpdGUiLCJicCIsIl9jYWNoZSIsInNvdXJjZSIsImdsb2JhbCIsIlJFR0xPQiIsIl9jcmVhdGUiLCJwYWlyIiwiREVGQVVMVCIsIl9wYWlycyIsIkVycm9yIiwiU19RQkxPQ0tTIiwiX2JyYWNrZXRzIiwicmVPcklkeCIsIl9yZWdleCIsIl9yZXNldCIsImNhY2hlZEJyYWNrZXRzIiwiX3NldFNldHRpbmdzIiwiYiIsInNldCIsImdldCIsIl9zZXR0aW5ncyIsIlJfTUxDT01NUyIsIlJfU1RSSU5HUyIsIkZJTkRCUkFDRVMiLCIoIiwiWyIsInsiLCJfYnAiLCJ1bmVzY2FwZVN0ciIsImlzZXhwciIsInBhcnRzIiwic2tpcEJyYWNlcyIsImNoIiwiaXgiLCJyZWNjaCIsImxhc3RJbmRleCIsImluZGV4IiwidHJpbSIsImFycmF5IiwiX3RtcGwiLCJfbG9nRXJyIiwiZXJyIiwiZXJyb3JIYW5kbGVyIiwicmlvdERhdGEiLCJfZ2V0VG1wbCIsIkZ1bmN0aW9uIiwicXN0ciIsIlJFX0RRVU9URSIsImxpc3QiLCJfcGFyc2VFeHByIiwiam9pbiIsIlJFX1FCTUFSSyIsImFzVGV4dCIsIm1tIiwibHYiLCJpciIsIlJFX0JSRU5EIiwiUkVfUUJMT0NLIiwiZGl2IiwiQ0hfSURFWFBSIiwiY250IiwiUkVfQ1NOQU1FIiwianNiIiwicmlnaHRDb250ZXh0IiwiX3dyYXBFeHByIiwidGIiLCJKU19WQVJOQU1FIiwibXZhciIsIkpTX0NPTlRFWFQiLCJKU19OT1BST1BTIiwiaGF2ZVJhdyIsImhhc1JhdyIsInBhcnNlIiwiX21rZG9tIiwidGVtcGwiLCJyZXBsYWNlWWllbGQiLCJ0YmxUYWdzIiwic3BlY2lhbFRhZ3MiLCJzZWxlY3QiLCJ0bmFtZSIsInJvb3RFbHMiLCJjaGlsZEVsZW1lbnRDb3VudCIsInJlSGFzWWllbGQiLCJyZVlpZWxkU3JjIiwidGV4dCIsInJlWWllbGREZXN0IiwiZGVmIiwicmVZaWVsZEFsbCIsInRyIiwidGgiLCJ0ZCIsImNvbCIsInN0eWxlTWFuYWdlciIsIl9yaW90IiwiaW5qZWN0Iiwic3R5bGVOb2RlIiwibmV3Tm9kZSIsInVzZXJOb2RlIiwicmVwbGFjZUNoaWxkIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJjc3NUZXh0UHJvcCIsInN0eWxlU2hlZXQiLCJzdHlsZXNUb0luamVjdCIsImNzcyIsImNzc1RleHQiLCJ3IiwicmFmIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwibW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwid2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwibGFzdFRpbWUiLCJub3d0aW1lIiwiRGF0ZSIsIm5vdyIsInRpbWVvdXQiLCJNYXRoIiwibWF4IiwidXRpbCIsIm1peGlucyIsImdsb2JhbHMiLCJfaWQiLCJnIiwic3RvcmUiLCJ0YWcyIiwiYWRkUmlvdFRhZ3MiLCJzZWxlY3RBbGxUYWdzIiwicHVzaFRhZ3MiLCJyaW90VGFnIiwiYWxsVGFncyIsIm5vZGVMaXN0IiwiX2VsIiwidmRvbSIsIl9fd2VicGFja19hbWRfb3B0aW9uc19fIiwiX21vZHVsZSIsIl90aGlzIiwiY291bnQiLCJsb2FuIiwicmVmcmVzaCIsIl90aGlzMiIsImxvYW5zIiwidW5zaGlmdCIsImZvbyIsIl90aGlzMyIsInVwZGF0ZU91dHNhbmRpbmciLCJyZW1haW5pbmciLCJwYXJzZUZsb2F0IiwidXBkYXRlTmFtZSIsImluaXRpYWxEZWJ0IiwiaW5pdGlhbFRvdGFsRGVidCIsInRvdGFsIiwiZGVidHMiLCJ1c2VSZXBheW1lbnRzIiwicmVwYXltZW50cyIsInRvZ2dsZVJlcGF5bWVudHMiLCJkZWJ0IiwiX3RoaXMzJGRlYnRzJHB1c2giLCJtb2RlbCIsInJlZHVjZSIsInBhcnNlSW50Il0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUUsT0FHQSxJQUFBQyxHQUFBRixFQUFBRCxJQUNBRSxXQUNBRSxHQUFBSixFQUNBSyxRQUFBLEVBVUEsT0FOQVAsR0FBQUUsR0FBQU0sS0FBQUgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUgsR0FHQUksRUFBQUUsUUFBQSxFQUdBRixFQUFBRCxRQXZCQSxHQUFBRCxLQXFDQSxPQVRBRixHQUFBUSxFQUFBVCxFQUdBQyxFQUFBUyxFQUFBUCxFQUdB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WCxNQUFLb1gsTUFBUUQsRUFDYm5YLEtBQUtxWCxRQUNIOVksS0FBTSxZQUNOd1ksVUFBV0csRUFDWEksZUFBZSxFQUNmQyxnQkFPRnZYLEtBQUt3WCxpQkFBbUIsU0FBQUMsR0FDdEJBLEVBQUtILGVBQWlCRyxFQUFLSCxjQUMzQlQsRUFBS2phLFVBT1BvRCxLQUFLMkQsSUFBTSxXQUFNLEdBQUErVCxFQU1mYixHQUFLUSxNQUFNemQsTUFBWDhkLEdBQ0VuWixLQUFNLE9BQ053WSxVQUFXLEVBQ1hRLFlBQWEsTUFBTyxNQUFPLE9BQzNCRCxlQUFlLEdBSmpCSSxFQUFBLFVBS2FSLEVBTGJRLElBT0FiLEVBQUtqYSxVQUdQb0QsS0FBSzRELE9BQVMsU0FBQWpCLEdBQ1prVSxFQUFLUSxNQUFNL2UsT0FBT3FLLEVBQUVnVixNQUFNMUgsTUFBTyxHQUNqQzRHLEVBQUtqYSxVQUdQb0QsS0FBS25FLEdBQUcsU0FBVSxXQUdoQmdiLEVBQUtPLE1BQVFQLEVBQUtRLE1BQU1PLE9BQU8sU0FBU1IsRUFBT3JNLEdBQzdDLE1BQU9xTSxJQUFTUyxTQUFTOU0sRUFBUWdNLFVBQVcsS0FBT0csSUFDbERDLFNQc3RGcUJuZ0IsS0FBS0osRUFBU0gsRUFBb0IiLCJmaWxlIjoibWFpbi5idW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihyaW90KSB7J3VzZSBzdHJpY3QnO1xuXHRcblx0X193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcblx0XG5cdF9fd2VicGFja19yZXF1aXJlX18oNik7XG5cdFxuXHRyaW90Lm1vdW50KCcqJyk7XG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKSlcblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvKiBSaW90IHYyLjUuMCwgQGxpY2Vuc2UgTUlUICovXG5cdFxuXHQ7KGZ1bmN0aW9uKHdpbmRvdywgdW5kZWZpbmVkKSB7XG5cdCAgJ3VzZSBzdHJpY3QnO1xuXHR2YXIgcmlvdCA9IHsgdmVyc2lvbjogJ3YyLjUuMCcsIHNldHRpbmdzOiB7fSB9LFxuXHQgIC8vIGJlIGF3YXJlLCBpbnRlcm5hbCB1c2FnZVxuXHQgIC8vIEFUVEVOVElPTjogcHJlZml4IHRoZSBnbG9iYWwgZHluYW1pYyB2YXJpYWJsZXMgd2l0aCBgX19gXG5cdFxuXHQgIC8vIGNvdW50ZXIgdG8gZ2l2ZSBhIHVuaXF1ZSBpZCB0byBhbGwgdGhlIFRhZyBpbnN0YW5jZXNcblx0ICBfX3VpZCA9IDAsXG5cdCAgLy8gdGFncyBpbnN0YW5jZXMgY2FjaGVcblx0ICBfX3ZpcnR1YWxEb20gPSBbXSxcblx0ICAvLyB0YWdzIGltcGxlbWVudGF0aW9uIGNhY2hlXG5cdCAgX190YWdJbXBsID0ge30sXG5cdFxuXHQgIC8qKlxuXHQgICAqIENvbnN0XG5cdCAgICovXG5cdCAgR0xPQkFMX01JWElOID0gJ19fZ2xvYmFsX21peGluJyxcblx0XG5cdCAgLy8gcmlvdCBzcGVjaWZpYyBwcmVmaXhlc1xuXHQgIFJJT1RfUFJFRklYID0gJ3Jpb3QtJyxcblx0ICBSSU9UX1RBRyA9IFJJT1RfUFJFRklYICsgJ3RhZycsXG5cdCAgUklPVF9UQUdfSVMgPSAnZGF0YS1pcycsXG5cdFxuXHQgIC8vIGZvciB0eXBlb2YgPT0gJycgY29tcGFyaXNvbnNcblx0ICBUX1NUUklORyA9ICdzdHJpbmcnLFxuXHQgIFRfT0JKRUNUID0gJ29iamVjdCcsXG5cdCAgVF9VTkRFRiAgPSAndW5kZWZpbmVkJyxcblx0ICBUX0ZVTkNUSU9OID0gJ2Z1bmN0aW9uJyxcblx0ICAvLyBzcGVjaWFsIG5hdGl2ZSB0YWdzIHRoYXQgY2Fubm90IGJlIHRyZWF0ZWQgbGlrZSB0aGUgb3RoZXJzXG5cdCAgU1BFQ0lBTF9UQUdTX1JFR0VYID0gL14oPzp0KD86Ym9keXxoZWFkfGZvb3R8W3JoZF0pfGNhcHRpb258Y29sKD86Z3JvdXApP3xvcHQoPzppb258Z3JvdXApKSQvLFxuXHQgIFJFU0VSVkVEX1dPUkRTX0JMQUNLTElTVCA9IC9eKD86Xyg/Oml0ZW18aWR8cGFyZW50KXx1cGRhdGV8cm9vdHwoPzp1bik/bW91bnR8bWl4aW58aXMoPzpNb3VudGVkfExvb3ApfHRhZ3N8cGFyZW50fG9wdHN8dHJpZ2dlcnxvKD86bnxmZnxuZSkpJC8sXG5cdCAgLy8gU1ZHIHRhZ3MgbGlzdCBodHRwczovL3d3dy53My5vcmcvVFIvU1ZHL2F0dGluZGV4Lmh0bWwjUHJlc2VudGF0aW9uQXR0cmlidXRlc1xuXHQgIFNWR19UQUdTX0xJU1QgPSBbJ2FsdEdseXBoJywgJ2FuaW1hdGUnLCAnYW5pbWF0ZUNvbG9yJywgJ2NpcmNsZScsICdjbGlwUGF0aCcsICdkZWZzJywgJ2VsbGlwc2UnLCAnZmVCbGVuZCcsICdmZUNvbG9yTWF0cml4JywgJ2ZlQ29tcG9uZW50VHJhbnNmZXInLCAnZmVDb21wb3NpdGUnLCAnZmVDb252b2x2ZU1hdHJpeCcsICdmZURpZmZ1c2VMaWdodGluZycsICdmZURpc3BsYWNlbWVudE1hcCcsICdmZUZsb29kJywgJ2ZlR2F1c3NpYW5CbHVyJywgJ2ZlSW1hZ2UnLCAnZmVNZXJnZScsICdmZU1vcnBob2xvZ3knLCAnZmVPZmZzZXQnLCAnZmVTcGVjdWxhckxpZ2h0aW5nJywgJ2ZlVGlsZScsICdmZVR1cmJ1bGVuY2UnLCAnZmlsdGVyJywgJ2ZvbnQnLCAnZm9yZWlnbk9iamVjdCcsICdnJywgJ2dseXBoJywgJ2dseXBoUmVmJywgJ2ltYWdlJywgJ2xpbmUnLCAnbGluZWFyR3JhZGllbnQnLCAnbWFya2VyJywgJ21hc2snLCAnbWlzc2luZy1nbHlwaCcsICdwYXRoJywgJ3BhdHRlcm4nLCAncG9seWdvbicsICdwb2x5bGluZScsICdyYWRpYWxHcmFkaWVudCcsICdyZWN0JywgJ3N0b3AnLCAnc3ZnJywgJ3N3aXRjaCcsICdzeW1ib2wnLCAndGV4dCcsICd0ZXh0UGF0aCcsICd0cmVmJywgJ3RzcGFuJywgJ3VzZSddLFxuXHRcblx0ICAvLyB2ZXJzaW9uIyBmb3IgSUUgOC0xMSwgMCBmb3Igb3RoZXJzXG5cdCAgSUVfVkVSU0lPTiA9ICh3aW5kb3cgJiYgd2luZG93LmRvY3VtZW50IHx8IHt9KS5kb2N1bWVudE1vZGUgfCAwLFxuXHRcblx0ICAvLyBkZXRlY3QgZmlyZWZveCB0byBmaXggIzEzNzRcblx0ICBGSVJFRk9YID0gd2luZG93ICYmICEhd2luZG93Lkluc3RhbGxUcmlnZ2VyXG5cdC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG5cdHJpb3Qub2JzZXJ2YWJsZSA9IGZ1bmN0aW9uKGVsKSB7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEV4dGVuZCB0aGUgb3JpZ2luYWwgb2JqZWN0IG9yIGNyZWF0ZSBhIG5ldyBlbXB0eSBvbmVcblx0ICAgKiBAdHlwZSB7IE9iamVjdCB9XG5cdCAgICovXG5cdFxuXHQgIGVsID0gZWwgfHwge31cblx0XG5cdCAgLyoqXG5cdCAgICogUHJpdmF0ZSB2YXJpYWJsZXNcblx0ICAgKi9cblx0ICB2YXIgY2FsbGJhY2tzID0ge30sXG5cdCAgICBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZVxuXHRcblx0ICAvKipcblx0ICAgKiBQcml2YXRlIE1ldGhvZHNcblx0ICAgKi9cblx0XG5cdCAgLyoqXG5cdCAgICogSGVscGVyIGZ1bmN0aW9uIG5lZWRlZCB0byBnZXQgYW5kIGxvb3AgYWxsIHRoZSBldmVudHMgaW4gYSBzdHJpbmdcblx0ICAgKiBAcGFyYW0gICB7IFN0cmluZyB9ICAgZSAtIGV2ZW50IHN0cmluZ1xuXHQgICAqIEBwYXJhbSAgIHtGdW5jdGlvbn0gICBmbiAtIGNhbGxiYWNrXG5cdCAgICovXG5cdCAgZnVuY3Rpb24gb25FYWNoRXZlbnQoZSwgZm4pIHtcblx0ICAgIHZhciBlcyA9IGUuc3BsaXQoJyAnKSwgbCA9IGVzLmxlbmd0aCwgaSA9IDAsIG5hbWUsIGluZHhcblx0ICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7XG5cdCAgICAgIG5hbWUgPSBlc1tpXVxuXHQgICAgICBpbmR4ID0gbmFtZS5pbmRleE9mKCcuJylcblx0ICAgICAgaWYgKG5hbWUpIGZuKCB+aW5keCA/IG5hbWUuc3Vic3RyaW5nKDAsIGluZHgpIDogbmFtZSwgaSwgfmluZHggPyBuYW1lLnNsaWNlKGluZHggKyAxKSA6IG51bGwpXG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiBQdWJsaWMgQXBpXG5cdCAgICovXG5cdFxuXHQgIC8vIGV4dGVuZCB0aGUgZWwgb2JqZWN0IGFkZGluZyB0aGUgb2JzZXJ2YWJsZSBtZXRob2RzXG5cdCAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZWwsIHtcblx0ICAgIC8qKlxuXHQgICAgICogTGlzdGVuIHRvIHRoZSBnaXZlbiBzcGFjZSBzZXBhcmF0ZWQgbGlzdCBvZiBgZXZlbnRzYCBhbmRcblx0ICAgICAqIGV4ZWN1dGUgdGhlIGBjYWxsYmFja2AgZWFjaCB0aW1lIGFuIGV2ZW50IGlzIHRyaWdnZXJlZC5cblx0ICAgICAqIEBwYXJhbSAgeyBTdHJpbmcgfSBldmVudHMgLSBldmVudHMgaWRzXG5cdCAgICAgKiBAcGFyYW0gIHsgRnVuY3Rpb24gfSBmbiAtIGNhbGxiYWNrIGZ1bmN0aW9uXG5cdCAgICAgKiBAcmV0dXJucyB7IE9iamVjdCB9IGVsXG5cdCAgICAgKi9cblx0ICAgIG9uOiB7XG5cdCAgICAgIHZhbHVlOiBmdW5jdGlvbihldmVudHMsIGZuKSB7XG5cdCAgICAgICAgaWYgKHR5cGVvZiBmbiAhPSAnZnVuY3Rpb24nKSAgcmV0dXJuIGVsXG5cdFxuXHQgICAgICAgIG9uRWFjaEV2ZW50KGV2ZW50cywgZnVuY3Rpb24obmFtZSwgcG9zLCBucykge1xuXHQgICAgICAgICAgKGNhbGxiYWNrc1tuYW1lXSA9IGNhbGxiYWNrc1tuYW1lXSB8fCBbXSkucHVzaChmbilcblx0ICAgICAgICAgIGZuLnR5cGVkID0gcG9zID4gMFxuXHQgICAgICAgICAgZm4ubnMgPSBuc1xuXHQgICAgICAgIH0pXG5cdFxuXHQgICAgICAgIHJldHVybiBlbFxuXHQgICAgICB9LFxuXHQgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcblx0ICAgICAgd3JpdGFibGU6IGZhbHNlLFxuXHQgICAgICBjb25maWd1cmFibGU6IGZhbHNlXG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gc3BhY2Ugc2VwYXJhdGVkIGxpc3Qgb2YgYGV2ZW50c2AgbGlzdGVuZXJzXG5cdCAgICAgKiBAcGFyYW0gICB7IFN0cmluZyB9IGV2ZW50cyAtIGV2ZW50cyBpZHNcblx0ICAgICAqIEBwYXJhbSAgIHsgRnVuY3Rpb24gfSBmbiAtIGNhbGxiYWNrIGZ1bmN0aW9uXG5cdCAgICAgKiBAcmV0dXJucyB7IE9iamVjdCB9IGVsXG5cdCAgICAgKi9cblx0ICAgIG9mZjoge1xuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24oZXZlbnRzLCBmbikge1xuXHQgICAgICAgIGlmIChldmVudHMgPT0gJyonICYmICFmbikgY2FsbGJhY2tzID0ge31cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgIG9uRWFjaEV2ZW50KGV2ZW50cywgZnVuY3Rpb24obmFtZSwgcG9zLCBucykge1xuXHQgICAgICAgICAgICBpZiAoZm4gfHwgbnMpIHtcblx0ICAgICAgICAgICAgICB2YXIgYXJyID0gY2FsbGJhY2tzW25hbWVdXG5cdCAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNiOyBjYiA9IGFyciAmJiBhcnJbaV07ICsraSkge1xuXHQgICAgICAgICAgICAgICAgaWYgKGNiID09IGZuIHx8IG5zICYmIGNiLm5zID09IG5zKSBhcnIuc3BsaWNlKGktLSwgMSlcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0gZWxzZSBkZWxldGUgY2FsbGJhY2tzW25hbWVdXG5cdCAgICAgICAgICB9KVxuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gZWxcblx0ICAgICAgfSxcblx0ICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG5cdCAgICAgIHdyaXRhYmxlOiBmYWxzZSxcblx0ICAgICAgY29uZmlndXJhYmxlOiBmYWxzZVxuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIExpc3RlbiB0byB0aGUgZ2l2ZW4gc3BhY2Ugc2VwYXJhdGVkIGxpc3Qgb2YgYGV2ZW50c2AgYW5kXG5cdCAgICAgKiBleGVjdXRlIHRoZSBgY2FsbGJhY2tgIGF0IG1vc3Qgb25jZVxuXHQgICAgICogQHBhcmFtICAgeyBTdHJpbmcgfSBldmVudHMgLSBldmVudHMgaWRzXG5cdCAgICAgKiBAcGFyYW0gICB7IEZ1bmN0aW9uIH0gZm4gLSBjYWxsYmFjayBmdW5jdGlvblxuXHQgICAgICogQHJldHVybnMgeyBPYmplY3QgfSBlbFxuXHQgICAgICovXG5cdCAgICBvbmU6IHtcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uKGV2ZW50cywgZm4pIHtcblx0ICAgICAgICBmdW5jdGlvbiBvbigpIHtcblx0ICAgICAgICAgIGVsLm9mZihldmVudHMsIG9uKVxuXHQgICAgICAgICAgZm4uYXBwbHkoZWwsIGFyZ3VtZW50cylcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIGVsLm9uKGV2ZW50cywgb24pXG5cdCAgICAgIH0sXG5cdCAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuXHQgICAgICB3cml0YWJsZTogZmFsc2UsXG5cdCAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2Vcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBFeGVjdXRlIGFsbCBjYWxsYmFjayBmdW5jdGlvbnMgdGhhdCBsaXN0ZW4gdG9cblx0ICAgICAqIHRoZSBnaXZlbiBzcGFjZSBzZXBhcmF0ZWQgbGlzdCBvZiBgZXZlbnRzYFxuXHQgICAgICogQHBhcmFtICAgeyBTdHJpbmcgfSBldmVudHMgLSBldmVudHMgaWRzXG5cdCAgICAgKiBAcmV0dXJucyB7IE9iamVjdCB9IGVsXG5cdCAgICAgKi9cblx0ICAgIHRyaWdnZXI6IHtcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uKGV2ZW50cykge1xuXHRcblx0ICAgICAgICAvLyBnZXR0aW5nIHRoZSBhcmd1bWVudHNcblx0ICAgICAgICB2YXIgYXJnbGVuID0gYXJndW1lbnRzLmxlbmd0aCAtIDEsXG5cdCAgICAgICAgICBhcmdzID0gbmV3IEFycmF5KGFyZ2xlbiksXG5cdCAgICAgICAgICBmbnNcblx0XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdsZW47IGkrKykge1xuXHQgICAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpICsgMV0gLy8gc2tpcCBmaXJzdCBhcmd1bWVudFxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgb25FYWNoRXZlbnQoZXZlbnRzLCBmdW5jdGlvbihuYW1lLCBwb3MsIG5zKSB7XG5cdFxuXHQgICAgICAgICAgZm5zID0gc2xpY2UuY2FsbChjYWxsYmFja3NbbmFtZV0gfHwgW10sIDApXG5cdFxuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGZuOyBmbiA9IGZuc1tpXTsgKytpKSB7XG5cdCAgICAgICAgICAgIGlmIChmbi5idXN5KSBjb250aW51ZVxuXHQgICAgICAgICAgICBmbi5idXN5ID0gMVxuXHQgICAgICAgICAgICBpZiAoIW5zIHx8IGZuLm5zID09IG5zKSBmbi5hcHBseShlbCwgZm4udHlwZWQgPyBbbmFtZV0uY29uY2F0KGFyZ3MpIDogYXJncylcblx0ICAgICAgICAgICAgaWYgKGZuc1tpXSAhPT0gZm4pIHsgaS0tIH1cblx0ICAgICAgICAgICAgZm4uYnVzeSA9IDBcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICBpZiAoY2FsbGJhY2tzWycqJ10gJiYgbmFtZSAhPSAnKicpXG5cdCAgICAgICAgICAgIGVsLnRyaWdnZXIuYXBwbHkoZWwsIFsnKicsIG5hbWVdLmNvbmNhdChhcmdzKSlcblx0XG5cdCAgICAgICAgfSlcblx0XG5cdCAgICAgICAgcmV0dXJuIGVsXG5cdCAgICAgIH0sXG5cdCAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuXHQgICAgICB3cml0YWJsZTogZmFsc2UsXG5cdCAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2Vcblx0ICAgIH1cblx0ICB9KVxuXHRcblx0ICByZXR1cm4gZWxcblx0XG5cdH1cblx0LyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cblx0OyhmdW5jdGlvbihyaW90KSB7XG5cdFxuXHQvKipcblx0ICogU2ltcGxlIGNsaWVudC1zaWRlIHJvdXRlclxuXHQgKiBAbW9kdWxlIHJpb3Qtcm91dGVcblx0ICovXG5cdFxuXHRcblx0dmFyIFJFX09SSUdJTiA9IC9eLis/XFwvXFwvK1teXFwvXSsvLFxuXHQgIEVWRU5UX0xJU1RFTkVSID0gJ0V2ZW50TGlzdGVuZXInLFxuXHQgIFJFTU9WRV9FVkVOVF9MSVNURU5FUiA9ICdyZW1vdmUnICsgRVZFTlRfTElTVEVORVIsXG5cdCAgQUREX0VWRU5UX0xJU1RFTkVSID0gJ2FkZCcgKyBFVkVOVF9MSVNURU5FUixcblx0ICBIQVNfQVRUUklCVVRFID0gJ2hhc0F0dHJpYnV0ZScsXG5cdCAgUkVQTEFDRSA9ICdyZXBsYWNlJyxcblx0ICBQT1BTVEFURSA9ICdwb3BzdGF0ZScsXG5cdCAgSEFTSENIQU5HRSA9ICdoYXNoY2hhbmdlJyxcblx0ICBUUklHR0VSID0gJ3RyaWdnZXInLFxuXHQgIE1BWF9FTUlUX1NUQUNLX0xFVkVMID0gMyxcblx0ICB3aW4gPSB0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdyxcblx0ICBkb2MgPSB0eXBlb2YgZG9jdW1lbnQgIT0gJ3VuZGVmaW5lZCcgJiYgZG9jdW1lbnQsXG5cdCAgaGlzdCA9IHdpbiAmJiBoaXN0b3J5LFxuXHQgIGxvYyA9IHdpbiAmJiAoaGlzdC5sb2NhdGlvbiB8fCB3aW4ubG9jYXRpb24pLCAvLyBzZWUgaHRtbDUtaGlzdG9yeS1hcGlcblx0ICBwcm90ID0gUm91dGVyLnByb3RvdHlwZSwgLy8gdG8gbWluaWZ5IG1vcmVcblx0ICBjbGlja0V2ZW50ID0gZG9jICYmIGRvYy5vbnRvdWNoc3RhcnQgPyAndG91Y2hzdGFydCcgOiAnY2xpY2snLFxuXHQgIHN0YXJ0ZWQgPSBmYWxzZSxcblx0ICBjZW50cmFsID0gcmlvdC5vYnNlcnZhYmxlKCksXG5cdCAgcm91dGVGb3VuZCA9IGZhbHNlLFxuXHQgIGRlYm91bmNlZEVtaXQsXG5cdCAgYmFzZSwgY3VycmVudCwgcGFyc2VyLCBzZWNvbmRQYXJzZXIsIGVtaXRTdGFjayA9IFtdLCBlbWl0U3RhY2tMZXZlbCA9IDBcblx0XG5cdC8qKlxuXHQgKiBEZWZhdWx0IHBhcnNlci4gWW91IGNhbiByZXBsYWNlIGl0IHZpYSByb3V0ZXIucGFyc2VyIG1ldGhvZC5cblx0ICogQHBhcmFtIHtzdHJpbmd9IHBhdGggLSBjdXJyZW50IHBhdGggKG5vcm1hbGl6ZWQpXG5cdCAqIEByZXR1cm5zIHthcnJheX0gYXJyYXlcblx0ICovXG5cdGZ1bmN0aW9uIERFRkFVTFRfUEFSU0VSKHBhdGgpIHtcblx0ICByZXR1cm4gcGF0aC5zcGxpdCgvWy8/I10vKVxuXHR9XG5cdFxuXHQvKipcblx0ICogRGVmYXVsdCBwYXJzZXIgKHNlY29uZCkuIFlvdSBjYW4gcmVwbGFjZSBpdCB2aWEgcm91dGVyLnBhcnNlciBtZXRob2QuXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIC0gY3VycmVudCBwYXRoIChub3JtYWxpemVkKVxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZmlsdGVyIC0gZmlsdGVyIHN0cmluZyAobm9ybWFsaXplZClcblx0ICogQHJldHVybnMge2FycmF5fSBhcnJheVxuXHQgKi9cblx0ZnVuY3Rpb24gREVGQVVMVF9TRUNPTkRfUEFSU0VSKHBhdGgsIGZpbHRlcikge1xuXHQgIHZhciByZSA9IG5ldyBSZWdFeHAoJ14nICsgZmlsdGVyW1JFUExBQ0VdKC9cXCovZywgJyhbXi8/I10rPyknKVtSRVBMQUNFXSgvXFwuXFwuLywgJy4qJykgKyAnJCcpLFxuXHQgICAgYXJncyA9IHBhdGgubWF0Y2gocmUpXG5cdFxuXHQgIGlmIChhcmdzKSByZXR1cm4gYXJncy5zbGljZSgxKVxuXHR9XG5cdFxuXHQvKipcblx0ICogU2ltcGxlL2NoZWFwIGRlYm91bmNlIGltcGxlbWVudGF0aW9uXG5cdCAqIEBwYXJhbSAgIHtmdW5jdGlvbn0gZm4gLSBjYWxsYmFja1xuXHQgKiBAcGFyYW0gICB7bnVtYmVyfSBkZWxheSAtIGRlbGF5IGluIHNlY29uZHNcblx0ICogQHJldHVybnMge2Z1bmN0aW9ufSBkZWJvdW5jZWQgZnVuY3Rpb25cblx0ICovXG5cdGZ1bmN0aW9uIGRlYm91bmNlKGZuLCBkZWxheSkge1xuXHQgIHZhciB0XG5cdCAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0ICAgIGNsZWFyVGltZW91dCh0KVxuXHQgICAgdCA9IHNldFRpbWVvdXQoZm4sIGRlbGF5KVxuXHQgIH1cblx0fVxuXHRcblx0LyoqXG5cdCAqIFNldCB0aGUgd2luZG93IGxpc3RlbmVycyB0byB0cmlnZ2VyIHRoZSByb3V0ZXNcblx0ICogQHBhcmFtIHtib29sZWFufSBhdXRvRXhlYyAtIHNlZSByb3V0ZS5zdGFydFxuXHQgKi9cblx0ZnVuY3Rpb24gc3RhcnQoYXV0b0V4ZWMpIHtcblx0ICBkZWJvdW5jZWRFbWl0ID0gZGVib3VuY2UoZW1pdCwgMSlcblx0ICB3aW5bQUREX0VWRU5UX0xJU1RFTkVSXShQT1BTVEFURSwgZGVib3VuY2VkRW1pdClcblx0ICB3aW5bQUREX0VWRU5UX0xJU1RFTkVSXShIQVNIQ0hBTkdFLCBkZWJvdW5jZWRFbWl0KVxuXHQgIGRvY1tBRERfRVZFTlRfTElTVEVORVJdKGNsaWNrRXZlbnQsIGNsaWNrKVxuXHQgIGlmIChhdXRvRXhlYykgZW1pdCh0cnVlKVxuXHR9XG5cdFxuXHQvKipcblx0ICogUm91dGVyIGNsYXNzXG5cdCAqL1xuXHRmdW5jdGlvbiBSb3V0ZXIoKSB7XG5cdCAgdGhpcy4kID0gW11cblx0ICByaW90Lm9ic2VydmFibGUodGhpcykgLy8gbWFrZSBpdCBvYnNlcnZhYmxlXG5cdCAgY2VudHJhbC5vbignc3RvcCcsIHRoaXMucy5iaW5kKHRoaXMpKVxuXHQgIGNlbnRyYWwub24oJ2VtaXQnLCB0aGlzLmUuYmluZCh0aGlzKSlcblx0fVxuXHRcblx0ZnVuY3Rpb24gbm9ybWFsaXplKHBhdGgpIHtcblx0ICByZXR1cm4gcGF0aFtSRVBMQUNFXSgvXlxcL3xcXC8kLywgJycpXG5cdH1cblx0XG5cdGZ1bmN0aW9uIGlzU3RyaW5nKHN0cikge1xuXHQgIHJldHVybiB0eXBlb2Ygc3RyID09ICdzdHJpbmcnXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBHZXQgdGhlIHBhcnQgYWZ0ZXIgZG9tYWluIG5hbWVcblx0ICogQHBhcmFtIHtzdHJpbmd9IGhyZWYgLSBmdWxscGF0aFxuXHQgKiBAcmV0dXJucyB7c3RyaW5nfSBwYXRoIGZyb20gcm9vdFxuXHQgKi9cblx0ZnVuY3Rpb24gZ2V0UGF0aEZyb21Sb290KGhyZWYpIHtcblx0ICByZXR1cm4gKGhyZWYgfHwgbG9jLmhyZWYpW1JFUExBQ0VdKFJFX09SSUdJTiwgJycpXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBHZXQgdGhlIHBhcnQgYWZ0ZXIgYmFzZVxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaHJlZiAtIGZ1bGxwYXRoXG5cdCAqIEByZXR1cm5zIHtzdHJpbmd9IHBhdGggZnJvbSBiYXNlXG5cdCAqL1xuXHRmdW5jdGlvbiBnZXRQYXRoRnJvbUJhc2UoaHJlZikge1xuXHQgIHJldHVybiBiYXNlWzBdID09ICcjJ1xuXHQgICAgPyAoaHJlZiB8fCBsb2MuaHJlZiB8fCAnJykuc3BsaXQoYmFzZSlbMV0gfHwgJydcblx0ICAgIDogKGxvYyA/IGdldFBhdGhGcm9tUm9vdChocmVmKSA6IGhyZWYgfHwgJycpW1JFUExBQ0VdKGJhc2UsICcnKVxuXHR9XG5cdFxuXHRmdW5jdGlvbiBlbWl0KGZvcmNlKSB7XG5cdCAgLy8gdGhlIHN0YWNrIGlzIG5lZWRlZCBmb3IgcmVkaXJlY3Rpb25zXG5cdCAgdmFyIGlzUm9vdCA9IGVtaXRTdGFja0xldmVsID09IDBcblx0ICBpZiAoTUFYX0VNSVRfU1RBQ0tfTEVWRUwgPD0gZW1pdFN0YWNrTGV2ZWwpIHJldHVyblxuXHRcblx0ICBlbWl0U3RhY2tMZXZlbCsrXG5cdCAgZW1pdFN0YWNrLnB1c2goZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgcGF0aCA9IGdldFBhdGhGcm9tQmFzZSgpXG5cdCAgICBpZiAoZm9yY2UgfHwgcGF0aCAhPSBjdXJyZW50KSB7XG5cdCAgICAgIGNlbnRyYWxbVFJJR0dFUl0oJ2VtaXQnLCBwYXRoKVxuXHQgICAgICBjdXJyZW50ID0gcGF0aFxuXHQgICAgfVxuXHQgIH0pXG5cdCAgaWYgKGlzUm9vdCkge1xuXHQgICAgd2hpbGUgKGVtaXRTdGFjay5sZW5ndGgpIHtcblx0ICAgICAgZW1pdFN0YWNrWzBdKClcblx0ICAgICAgZW1pdFN0YWNrLnNoaWZ0KClcblx0ICAgIH1cblx0ICAgIGVtaXRTdGFja0xldmVsID0gMFxuXHQgIH1cblx0fVxuXHRcblx0ZnVuY3Rpb24gY2xpY2soZSkge1xuXHQgIGlmIChcblx0ICAgIGUud2hpY2ggIT0gMSAvLyBub3QgbGVmdCBjbGlja1xuXHQgICAgfHwgZS5tZXRhS2V5IHx8IGUuY3RybEtleSB8fCBlLnNoaWZ0S2V5IC8vIG9yIG1ldGEga2V5c1xuXHQgICAgfHwgZS5kZWZhdWx0UHJldmVudGVkIC8vIG9yIGRlZmF1bHQgcHJldmVudGVkXG5cdCAgKSByZXR1cm5cblx0XG5cdCAgdmFyIGVsID0gZS50YXJnZXRcblx0ICB3aGlsZSAoZWwgJiYgZWwubm9kZU5hbWUgIT0gJ0EnKSBlbCA9IGVsLnBhcmVudE5vZGVcblx0XG5cdCAgaWYgKFxuXHQgICAgIWVsIHx8IGVsLm5vZGVOYW1lICE9ICdBJyAvLyBub3QgQSB0YWdcblx0ICAgIHx8IGVsW0hBU19BVFRSSUJVVEVdKCdkb3dubG9hZCcpIC8vIGhhcyBkb3dubG9hZCBhdHRyXG5cdCAgICB8fCAhZWxbSEFTX0FUVFJJQlVURV0oJ2hyZWYnKSAvLyBoYXMgbm8gaHJlZiBhdHRyXG5cdCAgICB8fCBlbC50YXJnZXQgJiYgZWwudGFyZ2V0ICE9ICdfc2VsZicgLy8gYW5vdGhlciB3aW5kb3cgb3IgZnJhbWVcblx0ICAgIHx8IGVsLmhyZWYuaW5kZXhPZihsb2MuaHJlZi5tYXRjaChSRV9PUklHSU4pWzBdKSA9PSAtMSAvLyBjcm9zcyBvcmlnaW5cblx0ICApIHJldHVyblxuXHRcblx0ICBpZiAoZWwuaHJlZiAhPSBsb2MuaHJlZikge1xuXHQgICAgaWYgKFxuXHQgICAgICBlbC5ocmVmLnNwbGl0KCcjJylbMF0gPT0gbG9jLmhyZWYuc3BsaXQoJyMnKVswXSAvLyBpbnRlcm5hbCBqdW1wXG5cdCAgICAgIHx8IGJhc2UgIT0gJyMnICYmIGdldFBhdGhGcm9tUm9vdChlbC5ocmVmKS5pbmRleE9mKGJhc2UpICE9PSAwIC8vIG91dHNpZGUgb2YgYmFzZVxuXHQgICAgICB8fCAhZ28oZ2V0UGF0aEZyb21CYXNlKGVsLmhyZWYpLCBlbC50aXRsZSB8fCBkb2MudGl0bGUpIC8vIHJvdXRlIG5vdCBmb3VuZFxuXHQgICAgKSByZXR1cm5cblx0ICB9XG5cdFxuXHQgIGUucHJldmVudERlZmF1bHQoKVxuXHR9XG5cdFxuXHQvKipcblx0ICogR28gdG8gdGhlIHBhdGhcblx0ICogQHBhcmFtIHtzdHJpbmd9IHBhdGggLSBkZXN0aW5hdGlvbiBwYXRoXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB0aXRsZSAtIHBhZ2UgdGl0bGVcblx0ICogQHBhcmFtIHtib29sZWFufSBzaG91bGRSZXBsYWNlIC0gdXNlIHJlcGxhY2VTdGF0ZSBvciBwdXNoU3RhdGVcblx0ICogQHJldHVybnMge2Jvb2xlYW59IC0gcm91dGUgbm90IGZvdW5kIGZsYWdcblx0ICovXG5cdGZ1bmN0aW9uIGdvKHBhdGgsIHRpdGxlLCBzaG91bGRSZXBsYWNlKSB7XG5cdCAgaWYgKGhpc3QpIHsgLy8gaWYgYSBicm93c2VyXG5cdCAgICBwYXRoID0gYmFzZSArIG5vcm1hbGl6ZShwYXRoKVxuXHQgICAgdGl0bGUgPSB0aXRsZSB8fCBkb2MudGl0bGVcblx0ICAgIC8vIGJyb3dzZXJzIGlnbm9yZXMgdGhlIHNlY29uZCBwYXJhbWV0ZXIgYHRpdGxlYFxuXHQgICAgc2hvdWxkUmVwbGFjZVxuXHQgICAgICA/IGhpc3QucmVwbGFjZVN0YXRlKG51bGwsIHRpdGxlLCBwYXRoKVxuXHQgICAgICA6IGhpc3QucHVzaFN0YXRlKG51bGwsIHRpdGxlLCBwYXRoKVxuXHQgICAgLy8gc28gd2UgbmVlZCB0byBzZXQgaXQgbWFudWFsbHlcblx0ICAgIGRvYy50aXRsZSA9IHRpdGxlXG5cdCAgICByb3V0ZUZvdW5kID0gZmFsc2Vcblx0ICAgIGVtaXQoKVxuXHQgICAgcmV0dXJuIHJvdXRlRm91bmRcblx0ICB9XG5cdFxuXHQgIC8vIFNlcnZlci1zaWRlIHVzYWdlOiBkaXJlY3RseSBleGVjdXRlIGhhbmRsZXJzIGZvciB0aGUgcGF0aFxuXHQgIHJldHVybiBjZW50cmFsW1RSSUdHRVJdKCdlbWl0JywgZ2V0UGF0aEZyb21CYXNlKHBhdGgpKVxuXHR9XG5cdFxuXHQvKipcblx0ICogR28gdG8gcGF0aCBvciBzZXQgYWN0aW9uXG5cdCAqIGEgc2luZ2xlIHN0cmluZzogICAgICAgICAgICAgICAgZ28gdGhlcmVcblx0ICogdHdvIHN0cmluZ3M6ICAgICAgICAgICAgICAgICAgICBnbyB0aGVyZSB3aXRoIHNldHRpbmcgYSB0aXRsZVxuXHQgKiB0d28gc3RyaW5ncyBhbmQgYm9vbGVhbjogICAgICAgIHJlcGxhY2UgaGlzdG9yeSB3aXRoIHNldHRpbmcgYSB0aXRsZVxuXHQgKiBhIHNpbmdsZSBmdW5jdGlvbjogICAgICAgICAgICAgIHNldCBhbiBhY3Rpb24gb24gdGhlIGRlZmF1bHQgcm91dGVcblx0ICogYSBzdHJpbmcvUmVnRXhwIGFuZCBhIGZ1bmN0aW9uOiBzZXQgYW4gYWN0aW9uIG9uIHRoZSByb3V0ZVxuXHQgKiBAcGFyYW0geyhzdHJpbmd8ZnVuY3Rpb24pfSBmaXJzdCAtIHBhdGggLyBhY3Rpb24gLyBmaWx0ZXJcblx0ICogQHBhcmFtIHsoc3RyaW5nfFJlZ0V4cHxmdW5jdGlvbil9IHNlY29uZCAtIHRpdGxlIC8gYWN0aW9uXG5cdCAqIEBwYXJhbSB7Ym9vbGVhbn0gdGhpcmQgLSByZXBsYWNlIGZsYWdcblx0ICovXG5cdHByb3QubSA9IGZ1bmN0aW9uKGZpcnN0LCBzZWNvbmQsIHRoaXJkKSB7XG5cdCAgaWYgKGlzU3RyaW5nKGZpcnN0KSAmJiAoIXNlY29uZCB8fCBpc1N0cmluZyhzZWNvbmQpKSkgZ28oZmlyc3QsIHNlY29uZCwgdGhpcmQgfHwgZmFsc2UpXG5cdCAgZWxzZSBpZiAoc2Vjb25kKSB0aGlzLnIoZmlyc3QsIHNlY29uZClcblx0ICBlbHNlIHRoaXMucignQCcsIGZpcnN0KVxuXHR9XG5cdFxuXHQvKipcblx0ICogU3RvcCByb3V0aW5nXG5cdCAqL1xuXHRwcm90LnMgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLm9mZignKicpXG5cdCAgdGhpcy4kID0gW11cblx0fVxuXHRcblx0LyoqXG5cdCAqIEVtaXRcblx0ICogQHBhcmFtIHtzdHJpbmd9IHBhdGggLSBwYXRoXG5cdCAqL1xuXHRwcm90LmUgPSBmdW5jdGlvbihwYXRoKSB7XG5cdCAgdGhpcy4kLmNvbmNhdCgnQCcpLnNvbWUoZnVuY3Rpb24oZmlsdGVyKSB7XG5cdCAgICB2YXIgYXJncyA9IChmaWx0ZXIgPT0gJ0AnID8gcGFyc2VyIDogc2Vjb25kUGFyc2VyKShub3JtYWxpemUocGF0aCksIG5vcm1hbGl6ZShmaWx0ZXIpKVxuXHQgICAgaWYgKHR5cGVvZiBhcmdzICE9ICd1bmRlZmluZWQnKSB7XG5cdCAgICAgIHRoaXNbVFJJR0dFUl0uYXBwbHkobnVsbCwgW2ZpbHRlcl0uY29uY2F0KGFyZ3MpKVxuXHQgICAgICByZXR1cm4gcm91dGVGb3VuZCA9IHRydWUgLy8gZXhpdCBmcm9tIGxvb3Bcblx0ICAgIH1cblx0ICB9LCB0aGlzKVxuXHR9XG5cdFxuXHQvKipcblx0ICogUmVnaXN0ZXIgcm91dGVcblx0ICogQHBhcmFtIHtzdHJpbmd9IGZpbHRlciAtIGZpbHRlciBmb3IgbWF0Y2hpbmcgdG8gdXJsXG5cdCAqIEBwYXJhbSB7ZnVuY3Rpb259IGFjdGlvbiAtIGFjdGlvbiB0byByZWdpc3RlclxuXHQgKi9cblx0cHJvdC5yID0gZnVuY3Rpb24oZmlsdGVyLCBhY3Rpb24pIHtcblx0ICBpZiAoZmlsdGVyICE9ICdAJykge1xuXHQgICAgZmlsdGVyID0gJy8nICsgbm9ybWFsaXplKGZpbHRlcilcblx0ICAgIHRoaXMuJC5wdXNoKGZpbHRlcilcblx0ICB9XG5cdCAgdGhpcy5vbihmaWx0ZXIsIGFjdGlvbilcblx0fVxuXHRcblx0dmFyIG1haW5Sb3V0ZXIgPSBuZXcgUm91dGVyKClcblx0dmFyIHJvdXRlID0gbWFpblJvdXRlci5tLmJpbmQobWFpblJvdXRlcilcblx0XG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBzdWIgcm91dGVyXG5cdCAqIEByZXR1cm5zIHtmdW5jdGlvbn0gdGhlIG1ldGhvZCBvZiBhIG5ldyBSb3V0ZXIgb2JqZWN0XG5cdCAqL1xuXHRyb3V0ZS5jcmVhdGUgPSBmdW5jdGlvbigpIHtcblx0ICB2YXIgbmV3U3ViUm91dGVyID0gbmV3IFJvdXRlcigpXG5cdCAgLy8gYXNzaWduIHN1Yi1yb3V0ZXIncyBtYWluIG1ldGhvZFxuXHQgIHZhciByb3V0ZXIgPSBuZXdTdWJSb3V0ZXIubS5iaW5kKG5ld1N1YlJvdXRlcilcblx0ICAvLyBzdG9wIG9ubHkgdGhpcyBzdWItcm91dGVyXG5cdCAgcm91dGVyLnN0b3AgPSBuZXdTdWJSb3V0ZXIucy5iaW5kKG5ld1N1YlJvdXRlcilcblx0ICByZXR1cm4gcm91dGVyXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBTZXQgdGhlIGJhc2Ugb2YgdXJsXG5cdCAqIEBwYXJhbSB7KHN0cnxSZWdFeHApfSBhcmcgLSBhIG5ldyBiYXNlIG9yICcjJyBvciAnIyEnXG5cdCAqL1xuXHRyb3V0ZS5iYXNlID0gZnVuY3Rpb24oYXJnKSB7XG5cdCAgYmFzZSA9IGFyZyB8fCAnIydcblx0ICBjdXJyZW50ID0gZ2V0UGF0aEZyb21CYXNlKCkgLy8gcmVjYWxjdWxhdGUgY3VycmVudCBwYXRoXG5cdH1cblx0XG5cdC8qKiBFeGVjIHJvdXRpbmcgcmlnaHQgbm93ICoqL1xuXHRyb3V0ZS5leGVjID0gZnVuY3Rpb24oKSB7XG5cdCAgZW1pdCh0cnVlKVxuXHR9XG5cdFxuXHQvKipcblx0ICogUmVwbGFjZSB0aGUgZGVmYXVsdCByb3V0ZXIgdG8geW91cnNcblx0ICogQHBhcmFtIHtmdW5jdGlvbn0gZm4gLSB5b3VyIHBhcnNlciBmdW5jdGlvblxuXHQgKiBAcGFyYW0ge2Z1bmN0aW9ufSBmbjIgLSB5b3VyIHNlY29uZFBhcnNlciBmdW5jdGlvblxuXHQgKi9cblx0cm91dGUucGFyc2VyID0gZnVuY3Rpb24oZm4sIGZuMikge1xuXHQgIGlmICghZm4gJiYgIWZuMikge1xuXHQgICAgLy8gcmVzZXQgcGFyc2VyIGZvciB0ZXN0aW5nLi4uXG5cdCAgICBwYXJzZXIgPSBERUZBVUxUX1BBUlNFUlxuXHQgICAgc2Vjb25kUGFyc2VyID0gREVGQVVMVF9TRUNPTkRfUEFSU0VSXG5cdCAgfVxuXHQgIGlmIChmbikgcGFyc2VyID0gZm5cblx0ICBpZiAoZm4yKSBzZWNvbmRQYXJzZXIgPSBmbjJcblx0fVxuXHRcblx0LyoqXG5cdCAqIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgdXJsIHF1ZXJ5IGFzIGFuIG9iamVjdFxuXHQgKiBAcmV0dXJucyB7b2JqZWN0fSBwYXJzZWQgcXVlcnlcblx0ICovXG5cdHJvdXRlLnF1ZXJ5ID0gZnVuY3Rpb24oKSB7XG5cdCAgdmFyIHEgPSB7fVxuXHQgIHZhciBocmVmID0gbG9jLmhyZWYgfHwgY3VycmVudFxuXHQgIGhyZWZbUkVQTEFDRV0oL1s/Jl0oLis/KT0oW14mXSopL2csIGZ1bmN0aW9uKF8sIGssIHYpIHsgcVtrXSA9IHYgfSlcblx0ICByZXR1cm4gcVxuXHR9XG5cdFxuXHQvKiogU3RvcCByb3V0aW5nICoqL1xuXHRyb3V0ZS5zdG9wID0gZnVuY3Rpb24gKCkge1xuXHQgIGlmIChzdGFydGVkKSB7XG5cdCAgICBpZiAod2luKSB7XG5cdCAgICAgIHdpbltSRU1PVkVfRVZFTlRfTElTVEVORVJdKFBPUFNUQVRFLCBkZWJvdW5jZWRFbWl0KVxuXHQgICAgICB3aW5bUkVNT1ZFX0VWRU5UX0xJU1RFTkVSXShIQVNIQ0hBTkdFLCBkZWJvdW5jZWRFbWl0KVxuXHQgICAgICBkb2NbUkVNT1ZFX0VWRU5UX0xJU1RFTkVSXShjbGlja0V2ZW50LCBjbGljaylcblx0ICAgIH1cblx0ICAgIGNlbnRyYWxbVFJJR0dFUl0oJ3N0b3AnKVxuXHQgICAgc3RhcnRlZCA9IGZhbHNlXG5cdCAgfVxuXHR9XG5cdFxuXHQvKipcblx0ICogU3RhcnQgcm91dGluZ1xuXHQgKiBAcGFyYW0ge2Jvb2xlYW59IGF1dG9FeGVjIC0gYXV0b21hdGljYWxseSBleGVjIGFmdGVyIHN0YXJ0aW5nIGlmIHRydWVcblx0ICovXG5cdHJvdXRlLnN0YXJ0ID0gZnVuY3Rpb24gKGF1dG9FeGVjKSB7XG5cdCAgaWYgKCFzdGFydGVkKSB7XG5cdCAgICBpZiAod2luKSB7XG5cdCAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09ICdjb21wbGV0ZScpIHN0YXJ0KGF1dG9FeGVjKVxuXHQgICAgICAvLyB0aGUgdGltZW91dCBpcyBuZWVkZWQgdG8gc29sdmVcblx0ICAgICAgLy8gYSB3ZWlyZCBzYWZhcmkgYnVnIGh0dHBzOi8vZ2l0aHViLmNvbS9yaW90L3JvdXRlL2lzc3Vlcy8zM1xuXHQgICAgICBlbHNlIHdpbltBRERfRVZFTlRfTElTVEVORVJdKCdsb2FkJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgc3RhcnQoYXV0b0V4ZWMpIH0sIDEpXG5cdCAgICAgIH0pXG5cdCAgICB9XG5cdCAgICBzdGFydGVkID0gdHJ1ZVxuXHQgIH1cblx0fVxuXHRcblx0LyoqIFByZXBhcmUgdGhlIHJvdXRlciAqKi9cblx0cm91dGUuYmFzZSgpXG5cdHJvdXRlLnBhcnNlcigpXG5cdFxuXHRyaW90LnJvdXRlID0gcm91dGVcblx0fSkocmlvdClcblx0LyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cblx0XG5cdC8qKlxuXHQgKiBUaGUgcmlvdCB0ZW1wbGF0ZSBlbmdpbmVcblx0ICogQHZlcnNpb24gdjIuNC4wXG5cdCAqL1xuXHQvKipcblx0ICogcmlvdC51dGlsLmJyYWNrZXRzXG5cdCAqXG5cdCAqIC0gYGJyYWNrZXRzICAgIGAgLSBSZXR1cm5zIGEgc3RyaW5nIG9yIHJlZ2V4IGJhc2VkIG9uIGl0cyBwYXJhbWV0ZXJcblx0ICogLSBgYnJhY2tldHMuc2V0YCAtIENoYW5nZSB0aGUgY3VycmVudCByaW90IGJyYWNrZXRzXG5cdCAqXG5cdCAqIEBtb2R1bGVcblx0ICovXG5cdFxuXHR2YXIgYnJhY2tldHMgPSAoZnVuY3Rpb24gKFVOREVGKSB7XG5cdFxuXHQgIHZhclxuXHQgICAgUkVHTE9CID0gJ2cnLFxuXHRcblx0ICAgIFJfTUxDT01NUyA9IC9cXC9cXCpbXipdKlxcKisoPzpbXipcXC9dW14qXSpcXCorKSpcXC8vZyxcblx0XG5cdCAgICBSX1NUUklOR1MgPSAvXCJbXlwiXFxcXF0qKD86XFxcXFtcXFNcXHNdW15cIlxcXFxdKikqXCJ8J1teJ1xcXFxdKig/OlxcXFxbXFxTXFxzXVteJ1xcXFxdKikqJy9nLFxuXHRcblx0ICAgIFNfUUJMT0NLUyA9IFJfU1RSSU5HUy5zb3VyY2UgKyAnfCcgK1xuXHQgICAgICAvKD86XFxicmV0dXJuXFxzK3woPzpbJFxcd1xcKVxcXV18XFwrXFwrfC0tKVxccyooXFwvKSg/IVsqXFwvXSkpLy5zb3VyY2UgKyAnfCcgK1xuXHQgICAgICAvXFwvKD89W14qXFwvXSlbXltcXC9cXFxcXSooPzooPzpcXFsoPzpcXFxcLnxbXlxcXVxcXFxdKikqXFxdfFxcXFwuKVteW1xcL1xcXFxdKikqPyhcXC8pW2dpbV0qLy5zb3VyY2UsXG5cdFxuXHQgICAgRklOREJSQUNFUyA9IHtcblx0ICAgICAgJygnOiBSZWdFeHAoJyhbKCldKXwnICAgKyBTX1FCTE9DS1MsIFJFR0xPQiksXG5cdCAgICAgICdbJzogUmVnRXhwKCcoW1tcXFxcXV0pfCcgKyBTX1FCTE9DS1MsIFJFR0xPQiksXG5cdCAgICAgICd7JzogUmVnRXhwKCcoW3t9XSl8JyAgICsgU19RQkxPQ0tTLCBSRUdMT0IpXG5cdCAgICB9LFxuXHRcblx0ICAgIERFRkFVTFQgPSAneyB9J1xuXHRcblx0ICB2YXIgX3BhaXJzID0gW1xuXHQgICAgJ3snLCAnfScsXG5cdCAgICAneycsICd9Jyxcblx0ICAgIC97W159XSp9Lyxcblx0ICAgIC9cXFxcKFt7fV0pL2csXG5cdCAgICAvXFxcXCh7KXx7L2csXG5cdCAgICBSZWdFeHAoJ1xcXFxcXFxcKH0pfChbWyh7XSl8KH0pfCcgKyBTX1FCTE9DS1MsIFJFR0xPQiksXG5cdCAgICBERUZBVUxULFxuXHQgICAgL15cXHMqe1xcXj9cXHMqKFskXFx3XSspKD86XFxzKixcXHMqKFxcUyspKT9cXHMraW5cXHMrKFxcUy4qKVxccyp9Lyxcblx0ICAgIC8oXnxbXlxcXFxdKXs9W1xcU1xcc10qP30vXG5cdCAgXVxuXHRcblx0ICB2YXJcblx0ICAgIGNhY2hlZEJyYWNrZXRzID0gVU5ERUYsXG5cdCAgICBfcmVnZXgsXG5cdCAgICBfY2FjaGUgPSBbXSxcblx0ICAgIF9zZXR0aW5nc1xuXHRcblx0ICBmdW5jdGlvbiBfbG9vcGJhY2sgKHJlKSB7IHJldHVybiByZSB9XG5cdFxuXHQgIGZ1bmN0aW9uIF9yZXdyaXRlIChyZSwgYnApIHtcblx0ICAgIGlmICghYnApIGJwID0gX2NhY2hlXG5cdCAgICByZXR1cm4gbmV3IFJlZ0V4cChcblx0ICAgICAgcmUuc291cmNlLnJlcGxhY2UoL3svZywgYnBbMl0pLnJlcGxhY2UoL30vZywgYnBbM10pLCByZS5nbG9iYWwgPyBSRUdMT0IgOiAnJ1xuXHQgICAgKVxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gX2NyZWF0ZSAocGFpcikge1xuXHQgICAgaWYgKHBhaXIgPT09IERFRkFVTFQpIHJldHVybiBfcGFpcnNcblx0XG5cdCAgICB2YXIgYXJyID0gcGFpci5zcGxpdCgnICcpXG5cdFxuXHQgICAgaWYgKGFyci5sZW5ndGggIT09IDIgfHwgL1tcXHgwMC1cXHgxRjw+YS16QS1aMC05J1wiLDtcXFxcXS8udGVzdChwYWlyKSkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cdCAgICAgIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgYnJhY2tldHMgXCInICsgcGFpciArICdcIicpXG5cdCAgICB9XG5cdCAgICBhcnIgPSBhcnIuY29uY2F0KHBhaXIucmVwbGFjZSgvKD89W1tcXF0oKSorPy5eJHxdKS9nLCAnXFxcXCcpLnNwbGl0KCcgJykpXG5cdFxuXHQgICAgYXJyWzRdID0gX3Jld3JpdGUoYXJyWzFdLmxlbmd0aCA+IDEgPyAve1tcXFNcXHNdKj99LyA6IF9wYWlyc1s0XSwgYXJyKVxuXHQgICAgYXJyWzVdID0gX3Jld3JpdGUocGFpci5sZW5ndGggPiAzID8gL1xcXFwoe3x9KS9nIDogX3BhaXJzWzVdLCBhcnIpXG5cdCAgICBhcnJbNl0gPSBfcmV3cml0ZShfcGFpcnNbNl0sIGFycilcblx0ICAgIGFycls3XSA9IFJlZ0V4cCgnXFxcXFxcXFwoJyArIGFyclszXSArICcpfChbWyh7XSl8KCcgKyBhcnJbM10gKyAnKXwnICsgU19RQkxPQ0tTLCBSRUdMT0IpXG5cdCAgICBhcnJbOF0gPSBwYWlyXG5cdCAgICByZXR1cm4gYXJyXG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBfYnJhY2tldHMgKHJlT3JJZHgpIHtcblx0ICAgIHJldHVybiByZU9ySWR4IGluc3RhbmNlb2YgUmVnRXhwID8gX3JlZ2V4KHJlT3JJZHgpIDogX2NhY2hlW3JlT3JJZHhdXG5cdCAgfVxuXHRcblx0ICBfYnJhY2tldHMuc3BsaXQgPSBmdW5jdGlvbiBzcGxpdCAoc3RyLCB0bXBsLCBfYnApIHtcblx0ICAgIC8vIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBfYnAgaXMgZm9yIHRoZSBjb21waWxlclxuXHQgICAgaWYgKCFfYnApIF9icCA9IF9jYWNoZVxuXHRcblx0ICAgIHZhclxuXHQgICAgICBwYXJ0cyA9IFtdLFxuXHQgICAgICBtYXRjaCxcblx0ICAgICAgaXNleHByLFxuXHQgICAgICBzdGFydCxcblx0ICAgICAgcG9zLFxuXHQgICAgICByZSA9IF9icFs2XVxuXHRcblx0ICAgIGlzZXhwciA9IHN0YXJ0ID0gcmUubGFzdEluZGV4ID0gMFxuXHRcblx0ICAgIHdoaWxlICgobWF0Y2ggPSByZS5leGVjKHN0cikpKSB7XG5cdFxuXHQgICAgICBwb3MgPSBtYXRjaC5pbmRleFxuXHRcblx0ICAgICAgaWYgKGlzZXhwcikge1xuXHRcblx0ICAgICAgICBpZiAobWF0Y2hbMl0pIHtcblx0ICAgICAgICAgIHJlLmxhc3RJbmRleCA9IHNraXBCcmFjZXMoc3RyLCBtYXRjaFsyXSwgcmUubGFzdEluZGV4KVxuXHQgICAgICAgICAgY29udGludWVcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKCFtYXRjaFszXSkge1xuXHQgICAgICAgICAgY29udGludWVcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmICghbWF0Y2hbMV0pIHtcblx0ICAgICAgICB1bmVzY2FwZVN0cihzdHIuc2xpY2Uoc3RhcnQsIHBvcykpXG5cdCAgICAgICAgc3RhcnQgPSByZS5sYXN0SW5kZXhcblx0ICAgICAgICByZSA9IF9icFs2ICsgKGlzZXhwciBePSAxKV1cblx0ICAgICAgICByZS5sYXN0SW5kZXggPSBzdGFydFxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKHN0ciAmJiBzdGFydCA8IHN0ci5sZW5ndGgpIHtcblx0ICAgICAgdW5lc2NhcGVTdHIoc3RyLnNsaWNlKHN0YXJ0KSlcblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gcGFydHNcblx0XG5cdCAgICBmdW5jdGlvbiB1bmVzY2FwZVN0ciAocykge1xuXHQgICAgICBpZiAodG1wbCB8fCBpc2V4cHIpIHtcblx0ICAgICAgICBwYXJ0cy5wdXNoKHMgJiYgcy5yZXBsYWNlKF9icFs1XSwgJyQxJykpXG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcGFydHMucHVzaChzKVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gc2tpcEJyYWNlcyAocywgY2gsIGl4KSB7XG5cdCAgICAgIHZhclxuXHQgICAgICAgIG1hdGNoLFxuXHQgICAgICAgIHJlY2NoID0gRklOREJSQUNFU1tjaF1cblx0XG5cdCAgICAgIHJlY2NoLmxhc3RJbmRleCA9IGl4XG5cdCAgICAgIGl4ID0gMVxuXHQgICAgICB3aGlsZSAoKG1hdGNoID0gcmVjY2guZXhlYyhzKSkpIHtcblx0ICAgICAgICBpZiAobWF0Y2hbMV0gJiZcblx0ICAgICAgICAgICEobWF0Y2hbMV0gPT09IGNoID8gKytpeCA6IC0taXgpKSBicmVha1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBpeCA/IHMubGVuZ3RoIDogcmVjY2gubGFzdEluZGV4XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICBfYnJhY2tldHMuaGFzRXhwciA9IGZ1bmN0aW9uIGhhc0V4cHIgKHN0cikge1xuXHQgICAgcmV0dXJuIF9jYWNoZVs0XS50ZXN0KHN0cilcblx0ICB9XG5cdFxuXHQgIF9icmFja2V0cy5sb29wS2V5cyA9IGZ1bmN0aW9uIGxvb3BLZXlzIChleHByKSB7XG5cdCAgICB2YXIgbSA9IGV4cHIubWF0Y2goX2NhY2hlWzldKVxuXHRcblx0ICAgIHJldHVybiBtXG5cdCAgICAgID8geyBrZXk6IG1bMV0sIHBvczogbVsyXSwgdmFsOiBfY2FjaGVbMF0gKyBtWzNdLnRyaW0oKSArIF9jYWNoZVsxXSB9XG5cdCAgICAgIDogeyB2YWw6IGV4cHIudHJpbSgpIH1cblx0ICB9XG5cdFxuXHQgIF9icmFja2V0cy5hcnJheSA9IGZ1bmN0aW9uIGFycmF5IChwYWlyKSB7XG5cdCAgICByZXR1cm4gcGFpciA/IF9jcmVhdGUocGFpcikgOiBfY2FjaGVcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIF9yZXNldCAocGFpcikge1xuXHQgICAgaWYgKChwYWlyIHx8IChwYWlyID0gREVGQVVMVCkpICE9PSBfY2FjaGVbOF0pIHtcblx0ICAgICAgX2NhY2hlID0gX2NyZWF0ZShwYWlyKVxuXHQgICAgICBfcmVnZXggPSBwYWlyID09PSBERUZBVUxUID8gX2xvb3BiYWNrIDogX3Jld3JpdGVcblx0ICAgICAgX2NhY2hlWzldID0gX3JlZ2V4KF9wYWlyc1s5XSlcblx0ICAgIH1cblx0ICAgIGNhY2hlZEJyYWNrZXRzID0gcGFpclxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gX3NldFNldHRpbmdzIChvKSB7XG5cdCAgICB2YXIgYlxuXHRcblx0ICAgIG8gPSBvIHx8IHt9XG5cdCAgICBiID0gby5icmFja2V0c1xuXHQgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sICdicmFja2V0cycsIHtcblx0ICAgICAgc2V0OiBfcmVzZXQsXG5cdCAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gY2FjaGVkQnJhY2tldHMgfSxcblx0ICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuXHQgICAgfSlcblx0ICAgIF9zZXR0aW5ncyA9IG9cblx0ICAgIF9yZXNldChiKVxuXHQgIH1cblx0XG5cdCAgT2JqZWN0LmRlZmluZVByb3BlcnR5KF9icmFja2V0cywgJ3NldHRpbmdzJywge1xuXHQgICAgc2V0OiBfc2V0U2V0dGluZ3MsXG5cdCAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9zZXR0aW5ncyB9XG5cdCAgfSlcblx0XG5cdCAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IGluIHRoZSBicm93c2VyIHJpb3QgaXMgYWx3YXlzIGluIHRoZSBzY29wZSAqL1xuXHQgIF9icmFja2V0cy5zZXR0aW5ncyA9IHR5cGVvZiByaW90ICE9PSAndW5kZWZpbmVkJyAmJiByaW90LnNldHRpbmdzIHx8IHt9XG5cdCAgX2JyYWNrZXRzLnNldCA9IF9yZXNldFxuXHRcblx0ICBfYnJhY2tldHMuUl9TVFJJTkdTID0gUl9TVFJJTkdTXG5cdCAgX2JyYWNrZXRzLlJfTUxDT01NUyA9IFJfTUxDT01NU1xuXHQgIF9icmFja2V0cy5TX1FCTE9DS1MgPSBTX1FCTE9DS1Ncblx0XG5cdCAgcmV0dXJuIF9icmFja2V0c1xuXHRcblx0fSkoKVxuXHRcblx0LyoqXG5cdCAqIEBtb2R1bGUgdG1wbFxuXHQgKlxuXHQgKiB0bXBsICAgICAgICAgIC0gUm9vdCBmdW5jdGlvbiwgcmV0dXJucyB0aGUgdGVtcGxhdGUgdmFsdWUsIHJlbmRlciB3aXRoIGRhdGFcblx0ICogdG1wbC5oYXNFeHByICAtIFRlc3QgdGhlIGV4aXN0ZW5jZSBvZiBhIGV4cHJlc3Npb24gaW5zaWRlIGEgc3RyaW5nXG5cdCAqIHRtcGwubG9vcEtleXMgLSBHZXQgdGhlIGtleXMgZm9yIGFuICdlYWNoJyBsb29wICh1c2VkIGJ5IGBfZWFjaGApXG5cdCAqL1xuXHRcblx0dmFyIHRtcGwgPSAoZnVuY3Rpb24gKCkge1xuXHRcblx0ICB2YXIgX2NhY2hlID0ge31cblx0XG5cdCAgZnVuY3Rpb24gX3RtcGwgKHN0ciwgZGF0YSkge1xuXHQgICAgaWYgKCFzdHIpIHJldHVybiBzdHJcblx0XG5cdCAgICByZXR1cm4gKF9jYWNoZVtzdHJdIHx8IChfY2FjaGVbc3RyXSA9IF9jcmVhdGUoc3RyKSkpLmNhbGwoZGF0YSwgX2xvZ0Vycilcblx0ICB9XG5cdFxuXHQgIF90bXBsLmhhdmVSYXcgPSBicmFja2V0cy5oYXNSYXdcblx0XG5cdCAgX3RtcGwuaGFzRXhwciA9IGJyYWNrZXRzLmhhc0V4cHJcblx0XG5cdCAgX3RtcGwubG9vcEtleXMgPSBicmFja2V0cy5sb29wS2V5c1xuXHRcblx0ICBfdG1wbC5lcnJvckhhbmRsZXIgPSBudWxsXG5cdFxuXHQgIGZ1bmN0aW9uIF9sb2dFcnIgKGVyciwgY3R4KSB7XG5cdFxuXHQgICAgaWYgKF90bXBsLmVycm9ySGFuZGxlcikge1xuXHRcblx0ICAgICAgZXJyLnJpb3REYXRhID0ge1xuXHQgICAgICAgIHRhZ05hbWU6IGN0eCAmJiBjdHgucm9vdCAmJiBjdHgucm9vdC50YWdOYW1lLFxuXHQgICAgICAgIF9yaW90X2lkOiBjdHggJiYgY3R4Ll9yaW90X2lkICAvL2VzbGludC1kaXNhYmxlLWxpbmUgY2FtZWxjYXNlXG5cdCAgICAgIH1cblx0ICAgICAgX3RtcGwuZXJyb3JIYW5kbGVyKGVycilcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIF9jcmVhdGUgKHN0cikge1xuXHQgICAgdmFyIGV4cHIgPSBfZ2V0VG1wbChzdHIpXG5cdFxuXHQgICAgaWYgKGV4cHIuc2xpY2UoMCwgMTEpICE9PSAndHJ5e3JldHVybiAnKSBleHByID0gJ3JldHVybiAnICsgZXhwclxuXHRcblx0LyogZXNsaW50LWRpc2FibGUgKi9cblx0XG5cdCAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKCdFJywgZXhwciArICc7Jylcblx0LyogZXNsaW50LWVuYWJsZSAqL1xuXHQgIH1cblx0XG5cdCAgdmFyXG5cdCAgICBDSF9JREVYUFIgPSAnXFx1MjA1NycsXG5cdCAgICBSRV9DU05BTUUgPSAvXig/OigtP1tfQS1aYS16XFx4QTAtXFx4RkZdWy1cXHdcXHhBMC1cXHhGRl0qKXxcXHUyMDU3KFxcZCspfik6Lyxcblx0ICAgIFJFX1FCTE9DSyA9IFJlZ0V4cChicmFja2V0cy5TX1FCTE9DS1MsICdnJyksXG5cdCAgICBSRV9EUVVPVEUgPSAvXFx1MjA1Ny9nLFxuXHQgICAgUkVfUUJNQVJLID0gL1xcdTIwNTcoXFxkKyl+L2dcblx0XG5cdCAgZnVuY3Rpb24gX2dldFRtcGwgKHN0cikge1xuXHQgICAgdmFyXG5cdCAgICAgIHFzdHIgPSBbXSxcblx0ICAgICAgZXhwcixcblx0ICAgICAgcGFydHMgPSBicmFja2V0cy5zcGxpdChzdHIucmVwbGFjZShSRV9EUVVPVEUsICdcIicpLCAxKVxuXHRcblx0ICAgIGlmIChwYXJ0cy5sZW5ndGggPiAyIHx8IHBhcnRzWzBdKSB7XG5cdCAgICAgIHZhciBpLCBqLCBsaXN0ID0gW11cblx0XG5cdCAgICAgIGZvciAoaSA9IGogPSAwOyBpIDwgcGFydHMubGVuZ3RoOyArK2kpIHtcblx0XG5cdCAgICAgICAgZXhwciA9IHBhcnRzW2ldXG5cdFxuXHQgICAgICAgIGlmIChleHByICYmIChleHByID0gaSAmIDFcblx0XG5cdCAgICAgICAgICAgID8gX3BhcnNlRXhwcihleHByLCAxLCBxc3RyKVxuXHRcblx0ICAgICAgICAgICAgOiAnXCInICsgZXhwclxuXHQgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFwvZywgJ1xcXFxcXFxcJylcblx0ICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXHJcXG4/fFxcbi9nLCAnXFxcXG4nKVxuXHQgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1wiL2csICdcXFxcXCInKSArXG5cdCAgICAgICAgICAgICAgJ1wiJ1xuXHRcblx0ICAgICAgICAgICkpIGxpc3RbaisrXSA9IGV4cHJcblx0XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGV4cHIgPSBqIDwgMiA/IGxpc3RbMF1cblx0ICAgICAgICAgICA6ICdbJyArIGxpc3Quam9pbignLCcpICsgJ10uam9pbihcIlwiKSdcblx0XG5cdCAgICB9IGVsc2Uge1xuXHRcblx0ICAgICAgZXhwciA9IF9wYXJzZUV4cHIocGFydHNbMV0sIDAsIHFzdHIpXG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKHFzdHJbMF0pIHtcblx0ICAgICAgZXhwciA9IGV4cHIucmVwbGFjZShSRV9RQk1BUkssIGZ1bmN0aW9uIChfLCBwb3MpIHtcblx0ICAgICAgICByZXR1cm4gcXN0cltwb3NdXG5cdCAgICAgICAgICAucmVwbGFjZSgvXFxyL2csICdcXFxccicpXG5cdCAgICAgICAgICAucmVwbGFjZSgvXFxuL2csICdcXFxcbicpXG5cdCAgICAgIH0pXG5cdCAgICB9XG5cdCAgICByZXR1cm4gZXhwclxuXHQgIH1cblx0XG5cdCAgdmFyXG5cdCAgICBSRV9CUkVORCA9IHtcblx0ICAgICAgJygnOiAvWygpXS9nLFxuXHQgICAgICAnWyc6IC9bW1xcXV0vZyxcblx0ICAgICAgJ3snOiAvW3t9XS9nXG5cdCAgICB9XG5cdFxuXHQgIGZ1bmN0aW9uIF9wYXJzZUV4cHIgKGV4cHIsIGFzVGV4dCwgcXN0cikge1xuXHRcblx0ICAgIGV4cHIgPSBleHByXG5cdCAgICAgICAgICAucmVwbGFjZShSRV9RQkxPQ0ssIGZ1bmN0aW9uIChzLCBkaXYpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHMubGVuZ3RoID4gMiAmJiAhZGl2ID8gQ0hfSURFWFBSICsgKHFzdHIucHVzaChzKSAtIDEpICsgJ34nIDogc1xuXHQgICAgICAgICAgfSlcblx0ICAgICAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpXG5cdCAgICAgICAgICAucmVwbGFjZSgvXFwgPyhbW1xcKHt9LD9cXC46XSlcXCA/L2csICckMScpXG5cdFxuXHQgICAgaWYgKGV4cHIpIHtcblx0ICAgICAgdmFyXG5cdCAgICAgICAgbGlzdCA9IFtdLFxuXHQgICAgICAgIGNudCA9IDAsXG5cdCAgICAgICAgbWF0Y2hcblx0XG5cdCAgICAgIHdoaWxlIChleHByICYmXG5cdCAgICAgICAgICAgIChtYXRjaCA9IGV4cHIubWF0Y2goUkVfQ1NOQU1FKSkgJiZcblx0ICAgICAgICAgICAgIW1hdGNoLmluZGV4XG5cdCAgICAgICAgKSB7XG5cdCAgICAgICAgdmFyXG5cdCAgICAgICAgICBrZXksXG5cdCAgICAgICAgICBqc2IsXG5cdCAgICAgICAgICByZSA9IC8sfChbW3soXSl8JC9nXG5cdFxuXHQgICAgICAgIGV4cHIgPSBSZWdFeHAucmlnaHRDb250ZXh0XG5cdCAgICAgICAga2V5ICA9IG1hdGNoWzJdID8gcXN0clttYXRjaFsyXV0uc2xpY2UoMSwgLTEpLnRyaW0oKS5yZXBsYWNlKC9cXHMrL2csICcgJykgOiBtYXRjaFsxXVxuXHRcblx0ICAgICAgICB3aGlsZSAoanNiID0gKG1hdGNoID0gcmUuZXhlYyhleHByKSlbMV0pIHNraXBCcmFjZXMoanNiLCByZSlcblx0XG5cdCAgICAgICAganNiICA9IGV4cHIuc2xpY2UoMCwgbWF0Y2guaW5kZXgpXG5cdCAgICAgICAgZXhwciA9IFJlZ0V4cC5yaWdodENvbnRleHRcblx0XG5cdCAgICAgICAgbGlzdFtjbnQrK10gPSBfd3JhcEV4cHIoanNiLCAxLCBrZXkpXG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGV4cHIgPSAhY250ID8gX3dyYXBFeHByKGV4cHIsIGFzVGV4dClcblx0ICAgICAgICAgICA6IGNudCA+IDEgPyAnWycgKyBsaXN0LmpvaW4oJywnKSArICddLmpvaW4oXCIgXCIpLnRyaW0oKScgOiBsaXN0WzBdXG5cdCAgICB9XG5cdCAgICByZXR1cm4gZXhwclxuXHRcblx0ICAgIGZ1bmN0aW9uIHNraXBCcmFjZXMgKGNoLCByZSkge1xuXHQgICAgICB2YXJcblx0ICAgICAgICBtbSxcblx0ICAgICAgICBsdiA9IDEsXG5cdCAgICAgICAgaXIgPSBSRV9CUkVORFtjaF1cblx0XG5cdCAgICAgIGlyLmxhc3RJbmRleCA9IHJlLmxhc3RJbmRleFxuXHQgICAgICB3aGlsZSAobW0gPSBpci5leGVjKGV4cHIpKSB7XG5cdCAgICAgICAgaWYgKG1tWzBdID09PSBjaCkgKytsdlxuXHQgICAgICAgIGVsc2UgaWYgKCEtLWx2KSBicmVha1xuXHQgICAgICB9XG5cdCAgICAgIHJlLmxhc3RJbmRleCA9IGx2ID8gZXhwci5sZW5ndGggOiBpci5sYXN0SW5kZXhcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIC8vIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBub3QgYm90aFxuXHQgIHZhciAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxlblxuXHQgICAgSlNfQ09OVEVYVCA9ICdcImluIHRoaXM/dGhpczonICsgKHR5cGVvZiB3aW5kb3cgIT09ICdvYmplY3QnID8gJ2dsb2JhbCcgOiAnd2luZG93JykgKyAnKS4nLFxuXHQgICAgSlNfVkFSTkFNRSA9IC9bLHtdWyRcXHddKzp8KF4gKnxbXiRcXHdcXC5dKSg/ISg/OnR5cGVvZnx0cnVlfGZhbHNlfG51bGx8dW5kZWZpbmVkfGlufGluc3RhbmNlb2Z8aXMoPzpGaW5pdGV8TmFOKXx2b2lkfE5hTnxuZXd8RGF0ZXxSZWdFeHB8TWF0aCkoPyFbJFxcd10pKShbJF9BLVphLXpdWyRcXHddKikvZyxcblx0ICAgIEpTX05PUFJPUFMgPSAvXig/PShcXC5bJFxcd10rKSlcXDEoPzpbXi5bKF18JCkvXG5cdFxuXHQgIGZ1bmN0aW9uIF93cmFwRXhwciAoZXhwciwgYXNUZXh0LCBrZXkpIHtcblx0ICAgIHZhciB0YlxuXHRcblx0ICAgIGV4cHIgPSBleHByLnJlcGxhY2UoSlNfVkFSTkFNRSwgZnVuY3Rpb24gKG1hdGNoLCBwLCBtdmFyLCBwb3MsIHMpIHtcblx0ICAgICAgaWYgKG12YXIpIHtcblx0ICAgICAgICBwb3MgPSB0YiA/IDAgOiBwb3MgKyBtYXRjaC5sZW5ndGhcblx0XG5cdCAgICAgICAgaWYgKG12YXIgIT09ICd0aGlzJyAmJiBtdmFyICE9PSAnZ2xvYmFsJyAmJiBtdmFyICE9PSAnd2luZG93Jykge1xuXHQgICAgICAgICAgbWF0Y2ggPSBwICsgJyhcIicgKyBtdmFyICsgSlNfQ09OVEVYVCArIG12YXJcblx0ICAgICAgICAgIGlmIChwb3MpIHRiID0gKHMgPSBzW3Bvc10pID09PSAnLicgfHwgcyA9PT0gJygnIHx8IHMgPT09ICdbJ1xuXHQgICAgICAgIH0gZWxzZSBpZiAocG9zKSB7XG5cdCAgICAgICAgICB0YiA9ICFKU19OT1BST1BTLnRlc3Qocy5zbGljZShwb3MpKVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gbWF0Y2hcblx0ICAgIH0pXG5cdFxuXHQgICAgaWYgKHRiKSB7XG5cdCAgICAgIGV4cHIgPSAndHJ5e3JldHVybiAnICsgZXhwciArICd9Y2F0Y2goZSl7RShlLHRoaXMpfSdcblx0ICAgIH1cblx0XG5cdCAgICBpZiAoa2V5KSB7XG5cdFxuXHQgICAgICBleHByID0gKHRiXG5cdCAgICAgICAgICA/ICdmdW5jdGlvbigpeycgKyBleHByICsgJ30uY2FsbCh0aGlzKScgOiAnKCcgKyBleHByICsgJyknXG5cdCAgICAgICAgKSArICc/XCInICsga2V5ICsgJ1wiOlwiXCInXG5cdFxuXHQgICAgfSBlbHNlIGlmIChhc1RleHQpIHtcblx0XG5cdCAgICAgIGV4cHIgPSAnZnVuY3Rpb24odil7JyArICh0YlxuXHQgICAgICAgICAgPyBleHByLnJlcGxhY2UoJ3JldHVybiAnLCAndj0nKSA6ICd2PSgnICsgZXhwciArICcpJ1xuXHQgICAgICAgICkgKyAnO3JldHVybiB2fHx2PT09MD92OlwiXCJ9LmNhbGwodGhpcyknXG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIGV4cHJcblx0ICB9XG5cdFxuXHQgIC8vIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBjb21wYXRpYmlsaXR5IGZpeCBmb3IgYmV0YSB2ZXJzaW9uc1xuXHQgIF90bXBsLnBhcnNlID0gZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMgfVxuXHRcblx0ICBfdG1wbC52ZXJzaW9uID0gYnJhY2tldHMudmVyc2lvbiA9ICd2Mi40LjAnXG5cdFxuXHQgIHJldHVybiBfdG1wbFxuXHRcblx0fSkoKVxuXHRcblx0Lypcblx0ICBsaWIvYnJvd3Nlci90YWcvbWtkb20uanNcblx0XG5cdCAgSW5jbHVkZXMgaGFja3MgbmVlZGVkIGZvciB0aGUgSW50ZXJuZXQgRXhwbG9yZXIgdmVyc2lvbiA5IGFuZCBiZWxvd1xuXHQgIFNlZTogaHR0cDovL2thbmdheC5naXRodWIuaW8vY29tcGF0LXRhYmxlL2VzNS8jaWU4XG5cdCAgICAgICBodHRwOi8vY29kZXBsYW5ldC5pby9kcm9wcGluZy1pZTgvXG5cdCovXG5cdHZhciBta2RvbSA9IChmdW5jdGlvbiBfbWtkb20oKSB7XG5cdCAgdmFyXG5cdCAgICByZUhhc1lpZWxkICA9IC88eWllbGRcXGIvaSxcblx0ICAgIHJlWWllbGRBbGwgID0gLzx5aWVsZFxccyooPzpcXC8+fD4oW1xcU1xcc10qPyk8XFwveWllbGRcXHMqPnw+KS9pZyxcblx0ICAgIHJlWWllbGRTcmMgID0gLzx5aWVsZFxccyt0bz1bJ1wiXShbXidcIj5dKilbJ1wiXVxccyo+KFtcXFNcXHNdKj8pPFxcL3lpZWxkXFxzKj4vaWcsXG5cdCAgICByZVlpZWxkRGVzdCA9IC88eWllbGRcXHMrZnJvbT1bJ1wiXT8oWy1cXHddKylbJ1wiXT9cXHMqKD86XFwvPnw+KFtcXFNcXHNdKj8pPFxcL3lpZWxkXFxzKj4pL2lnXG5cdCAgdmFyXG5cdCAgICByb290RWxzID0geyB0cjogJ3Rib2R5JywgdGg6ICd0cicsIHRkOiAndHInLCBjb2w6ICdjb2xncm91cCcgfSxcblx0ICAgIHRibFRhZ3MgPSBJRV9WRVJTSU9OICYmIElFX1ZFUlNJT04gPCAxMFxuXHQgICAgICA/IFNQRUNJQUxfVEFHU19SRUdFWCA6IC9eKD86dCg/OmJvZHl8aGVhZHxmb290fFtyaGRdKXxjYXB0aW9ufGNvbCg/Omdyb3VwKT8pJC9cblx0XG5cdCAgLyoqXG5cdCAgICogQ3JlYXRlcyBhIERPTSBlbGVtZW50IHRvIHdyYXAgdGhlIGdpdmVuIGNvbnRlbnQuIE5vcm1hbGx5IGFuIGBESVZgLCBidXQgY2FuIGJlXG5cdCAgICogYWxzbyBhIGBUQUJMRWAsIGBTRUxFQ1RgLCBgVEJPRFlgLCBgVFJgLCBvciBgQ09MR1JPVVBgIGVsZW1lbnQuXG5cdCAgICpcblx0ICAgKiBAcGFyYW0gICB7c3RyaW5nfSB0ZW1wbCAgLSBUaGUgdGVtcGxhdGUgY29taW5nIGZyb20gdGhlIGN1c3RvbSB0YWcgZGVmaW5pdGlvblxuXHQgICAqIEBwYXJhbSAgIHtzdHJpbmd9IFtodG1sXSAtIEhUTUwgY29udGVudCB0aGF0IGNvbWVzIGZyb20gdGhlIERPTSBlbGVtZW50IHdoZXJlIHlvdVxuXHQgICAqICAgICAgICAgICB3aWxsIG1vdW50IHRoZSB0YWcsIG1vc3RseSB0aGUgb3JpZ2luYWwgdGFnIGluIHRoZSBwYWdlXG5cdCAgICogQHJldHVybnMge0hUTUxFbGVtZW50fSBET00gZWxlbWVudCB3aXRoIF90ZW1wbF8gbWVyZ2VkIHRocm91Z2ggYFlJRUxEYCB3aXRoIHRoZSBfaHRtbF8uXG5cdCAgICovXG5cdCAgZnVuY3Rpb24gX21rZG9tKHRlbXBsLCBodG1sKSB7XG5cdCAgICB2YXJcblx0ICAgICAgbWF0Y2ggICA9IHRlbXBsICYmIHRlbXBsLm1hdGNoKC9eXFxzKjwoWy1cXHddKykvKSxcblx0ICAgICAgdGFnTmFtZSA9IG1hdGNoICYmIG1hdGNoWzFdLnRvTG93ZXJDYXNlKCksXG5cdCAgICAgIGVsID0gbWtFbCgnZGl2JywgaXNTVkdUYWcodGFnTmFtZSkpXG5cdFxuXHQgICAgLy8gcmVwbGFjZSBhbGwgdGhlIHlpZWxkIHRhZ3Mgd2l0aCB0aGUgdGFnIGlubmVyIGh0bWxcblx0ICAgIHRlbXBsID0gcmVwbGFjZVlpZWxkKHRlbXBsLCBodG1sKVxuXHRcblx0ICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG5cdCAgICBpZiAodGJsVGFncy50ZXN0KHRhZ05hbWUpKVxuXHQgICAgICBlbCA9IHNwZWNpYWxUYWdzKGVsLCB0ZW1wbCwgdGFnTmFtZSlcblx0ICAgIGVsc2Vcblx0ICAgICAgc2V0SW5uZXJIVE1MKGVsLCB0ZW1wbClcblx0XG5cdCAgICBlbC5zdHViID0gdHJ1ZVxuXHRcblx0ICAgIHJldHVybiBlbFxuXHQgIH1cblx0XG5cdCAgLypcblx0ICAgIENyZWF0ZXMgdGhlIHJvb3QgZWxlbWVudCBmb3IgdGFibGUgb3Igc2VsZWN0IGNoaWxkIGVsZW1lbnRzOlxuXHQgICAgdHIvdGgvdGQvdGhlYWQvdGZvb3QvdGJvZHkvY2FwdGlvbi9jb2wvY29sZ3JvdXAvb3B0aW9uL29wdGdyb3VwXG5cdCAgKi9cblx0ICBmdW5jdGlvbiBzcGVjaWFsVGFncyhlbCwgdGVtcGwsIHRhZ05hbWUpIHtcblx0ICAgIHZhclxuXHQgICAgICBzZWxlY3QgPSB0YWdOYW1lWzBdID09PSAnbycsXG5cdCAgICAgIHBhcmVudCA9IHNlbGVjdCA/ICdzZWxlY3Q+JyA6ICd0YWJsZT4nXG5cdFxuXHQgICAgLy8gdHJpbSgpIGlzIGltcG9ydGFudCBoZXJlLCB0aGlzIGVuc3VyZXMgd2UgZG9uJ3QgaGF2ZSBhcnRpZmFjdHMsXG5cdCAgICAvLyBzbyB3ZSBjYW4gY2hlY2sgaWYgd2UgaGF2ZSBvbmx5IG9uZSBlbGVtZW50IGluc2lkZSB0aGUgcGFyZW50XG5cdCAgICBlbC5pbm5lckhUTUwgPSAnPCcgKyBwYXJlbnQgKyB0ZW1wbC50cmltKCkgKyAnPC8nICsgcGFyZW50XG5cdCAgICBwYXJlbnQgPSBlbC5maXJzdENoaWxkXG5cdFxuXHQgICAgLy8gcmV0dXJucyB0aGUgaW1tZWRpYXRlIHBhcmVudCBpZiB0ci90aC90ZC9jb2wgaXMgdGhlIG9ubHkgZWxlbWVudCwgaWYgbm90XG5cdCAgICAvLyByZXR1cm5zIHRoZSB3aG9sZSB0cmVlLCBhcyB0aGlzIGNhbiBpbmNsdWRlIGFkZGl0aW9uYWwgZWxlbWVudHNcblx0ICAgIGlmIChzZWxlY3QpIHtcblx0ICAgICAgcGFyZW50LnNlbGVjdGVkSW5kZXggPSAtMSAgLy8gZm9yIElFOSwgY29tcGF0aWJsZSB3L2N1cnJlbnQgcmlvdCBiZWhhdmlvclxuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgLy8gYXZvaWRzIGluc2VydGlvbiBvZiBjb2ludGFpbmVyIGluc2lkZSBjb250YWluZXIgKGV4OiB0Ym9keSBpbnNpZGUgdGJvZHkpXG5cdCAgICAgIHZhciB0bmFtZSA9IHJvb3RFbHNbdGFnTmFtZV1cblx0ICAgICAgaWYgKHRuYW1lICYmIHBhcmVudC5jaGlsZEVsZW1lbnRDb3VudCA9PT0gMSkgcGFyZW50ID0gJCh0bmFtZSwgcGFyZW50KVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIHBhcmVudFxuXHQgIH1cblx0XG5cdCAgLypcblx0ICAgIFJlcGxhY2UgdGhlIHlpZWxkIHRhZyBmcm9tIGFueSB0YWcgdGVtcGxhdGUgd2l0aCB0aGUgaW5uZXJIVE1MIG9mIHRoZVxuXHQgICAgb3JpZ2luYWwgdGFnIGluIHRoZSBwYWdlXG5cdCAgKi9cblx0ICBmdW5jdGlvbiByZXBsYWNlWWllbGQodGVtcGwsIGh0bWwpIHtcblx0ICAgIC8vIGRvIG5vdGhpbmcgaWYgbm8geWllbGRcblx0ICAgIGlmICghcmVIYXNZaWVsZC50ZXN0KHRlbXBsKSkgcmV0dXJuIHRlbXBsXG5cdFxuXHQgICAgLy8gYmUgY2FyZWZ1bCB3aXRoICMxMzQzIC0gc3RyaW5nIG9uIHRoZSBzb3VyY2UgaGF2aW5nIGAkMWBcblx0ICAgIHZhciBzcmMgPSB7fVxuXHRcblx0ICAgIGh0bWwgPSBodG1sICYmIGh0bWwucmVwbGFjZShyZVlpZWxkU3JjLCBmdW5jdGlvbiAoXywgcmVmLCB0ZXh0KSB7XG5cdCAgICAgIHNyY1tyZWZdID0gc3JjW3JlZl0gfHwgdGV4dCAgIC8vIHByZXNlcnZlIGZpcnN0IGRlZmluaXRpb25cblx0ICAgICAgcmV0dXJuICcnXG5cdCAgICB9KS50cmltKClcblx0XG5cdCAgICByZXR1cm4gdGVtcGxcblx0ICAgICAgLnJlcGxhY2UocmVZaWVsZERlc3QsIGZ1bmN0aW9uIChfLCByZWYsIGRlZikgeyAgLy8geWllbGQgd2l0aCBmcm9tIC0gdG8gYXR0cnNcblx0ICAgICAgICByZXR1cm4gc3JjW3JlZl0gfHwgZGVmIHx8ICcnXG5cdCAgICAgIH0pXG5cdCAgICAgIC5yZXBsYWNlKHJlWWllbGRBbGwsIGZ1bmN0aW9uIChfLCBkZWYpIHsgICAgICAgIC8vIHlpZWxkIHdpdGhvdXQgYW55IFwiZnJvbVwiXG5cdCAgICAgICAgcmV0dXJuIGh0bWwgfHwgZGVmIHx8ICcnXG5cdCAgICAgIH0pXG5cdCAgfVxuXHRcblx0ICByZXR1cm4gX21rZG9tXG5cdFxuXHR9KSgpXG5cdFxuXHQvKipcblx0ICogQ29udmVydCB0aGUgaXRlbSBsb29wZWQgaW50byBhbiBvYmplY3QgdXNlZCB0byBleHRlbmQgdGhlIGNoaWxkIHRhZyBwcm9wZXJ0aWVzXG5cdCAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gZXhwciAtIG9iamVjdCBjb250YWluaW5nIHRoZSBrZXlzIHVzZWQgdG8gZXh0ZW5kIHRoZSBjaGlsZHJlbiB0YWdzXG5cdCAqIEBwYXJhbSAgIHsgKiB9IGtleSAtIHZhbHVlIHRvIGFzc2lnbiB0byB0aGUgbmV3IG9iamVjdCByZXR1cm5lZFxuXHQgKiBAcGFyYW0gICB7ICogfSB2YWwgLSB2YWx1ZSBjb250YWluaW5nIHRoZSBwb3NpdGlvbiBvZiB0aGUgaXRlbSBpbiB0aGUgYXJyYXlcblx0ICogQHJldHVybnMgeyBPYmplY3QgfSAtIG5ldyBvYmplY3QgY29udGFpbmluZyB0aGUgdmFsdWVzIG9mIHRoZSBvcmlnaW5hbCBpdGVtXG5cdCAqXG5cdCAqIFRoZSB2YXJpYWJsZXMgJ2tleScgYW5kICd2YWwnIGFyZSBhcmJpdHJhcnkuXG5cdCAqIFRoZXkgZGVwZW5kIG9uIHRoZSBjb2xsZWN0aW9uIHR5cGUgbG9vcGVkIChBcnJheSwgT2JqZWN0KVxuXHQgKiBhbmQgb24gdGhlIGV4cHJlc3Npb24gdXNlZCBvbiB0aGUgZWFjaCB0YWdcblx0ICpcblx0ICovXG5cdGZ1bmN0aW9uIG1raXRlbShleHByLCBrZXksIHZhbCkge1xuXHQgIHZhciBpdGVtID0ge31cblx0ICBpdGVtW2V4cHIua2V5XSA9IGtleVxuXHQgIGlmIChleHByLnBvcykgaXRlbVtleHByLnBvc10gPSB2YWxcblx0ICByZXR1cm4gaXRlbVxuXHR9XG5cdFxuXHQvKipcblx0ICogVW5tb3VudCB0aGUgcmVkdW5kYW50IHRhZ3Ncblx0ICogQHBhcmFtICAgeyBBcnJheSB9IGl0ZW1zIC0gYXJyYXkgY29udGFpbmluZyB0aGUgY3VycmVudCBpdGVtcyB0byBsb29wXG5cdCAqIEBwYXJhbSAgIHsgQXJyYXkgfSB0YWdzIC0gYXJyYXkgY29udGFpbmluZyBhbGwgdGhlIGNoaWxkcmVuIHRhZ3Ncblx0ICovXG5cdGZ1bmN0aW9uIHVubW91bnRSZWR1bmRhbnQoaXRlbXMsIHRhZ3MpIHtcblx0XG5cdCAgdmFyIGkgPSB0YWdzLmxlbmd0aCxcblx0ICAgIGogPSBpdGVtcy5sZW5ndGgsXG5cdCAgICB0XG5cdFxuXHQgIHdoaWxlIChpID4gaikge1xuXHQgICAgdCA9IHRhZ3NbLS1pXVxuXHQgICAgdGFncy5zcGxpY2UoaSwgMSlcblx0ICAgIHQudW5tb3VudCgpXG5cdCAgfVxuXHR9XG5cdFxuXHQvKipcblx0ICogTW92ZSB0aGUgbmVzdGVkIGN1c3RvbSB0YWdzIGluIG5vbiBjdXN0b20gbG9vcCB0YWdzXG5cdCAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gY2hpbGQgLSBub24gY3VzdG9tIGxvb3AgdGFnXG5cdCAqIEBwYXJhbSAgIHsgTnVtYmVyIH0gaSAtIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlIGxvb3AgdGFnXG5cdCAqL1xuXHRmdW5jdGlvbiBtb3ZlTmVzdGVkVGFncyhjaGlsZCwgaSkge1xuXHQgIE9iamVjdC5rZXlzKGNoaWxkLnRhZ3MpLmZvckVhY2goZnVuY3Rpb24odGFnTmFtZSkge1xuXHQgICAgdmFyIHRhZyA9IGNoaWxkLnRhZ3NbdGFnTmFtZV1cblx0ICAgIGlmIChpc0FycmF5KHRhZykpXG5cdCAgICAgIGVhY2godGFnLCBmdW5jdGlvbiAodCkge1xuXHQgICAgICAgIG1vdmVDaGlsZFRhZyh0LCB0YWdOYW1lLCBpKVxuXHQgICAgICB9KVxuXHQgICAgZWxzZVxuXHQgICAgICBtb3ZlQ2hpbGRUYWcodGFnLCB0YWdOYW1lLCBpKVxuXHQgIH0pXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBBZGRzIHRoZSBlbGVtZW50cyBmb3IgYSB2aXJ0dWFsIHRhZ1xuXHQgKiBAcGFyYW0geyBUYWcgfSB0YWcgLSB0aGUgdGFnIHdob3NlIHJvb3QncyBjaGlsZHJlbiB3aWxsIGJlIGluc2VydGVkIG9yIGFwcGVuZGVkXG5cdCAqIEBwYXJhbSB7IE5vZGUgfSBzcmMgLSB0aGUgbm9kZSB0aGF0IHdpbGwgZG8gdGhlIGluc2VydGluZyBvciBhcHBlbmRpbmdcblx0ICogQHBhcmFtIHsgVGFnIH0gdGFyZ2V0IC0gb25seSBpZiBpbnNlcnRpbmcsIGluc2VydCBiZWZvcmUgdGhpcyB0YWcncyBmaXJzdCBjaGlsZFxuXHQgKi9cblx0ZnVuY3Rpb24gYWRkVmlydHVhbCh0YWcsIHNyYywgdGFyZ2V0KSB7XG5cdCAgdmFyIGVsID0gdGFnLl9yb290LCBzaWJcblx0ICB0YWcuX3ZpcnRzID0gW11cblx0ICB3aGlsZSAoZWwpIHtcblx0ICAgIHNpYiA9IGVsLm5leHRTaWJsaW5nXG5cdCAgICBpZiAodGFyZ2V0KVxuXHQgICAgICBzcmMuaW5zZXJ0QmVmb3JlKGVsLCB0YXJnZXQuX3Jvb3QpXG5cdCAgICBlbHNlXG5cdCAgICAgIHNyYy5hcHBlbmRDaGlsZChlbClcblx0XG5cdCAgICB0YWcuX3ZpcnRzLnB1c2goZWwpIC8vIGhvbGQgZm9yIHVubW91bnRpbmdcblx0ICAgIGVsID0gc2liXG5cdCAgfVxuXHR9XG5cdFxuXHQvKipcblx0ICogTW92ZSB2aXJ0dWFsIHRhZyBhbmQgYWxsIGNoaWxkIG5vZGVzXG5cdCAqIEBwYXJhbSB7IFRhZyB9IHRhZyAtIGZpcnN0IGNoaWxkIHJlZmVyZW5jZSB1c2VkIHRvIHN0YXJ0IG1vdmVcblx0ICogQHBhcmFtIHsgTm9kZSB9IHNyYyAgLSB0aGUgbm9kZSB0aGF0IHdpbGwgZG8gdGhlIGluc2VydGluZ1xuXHQgKiBAcGFyYW0geyBUYWcgfSB0YXJnZXQgLSBpbnNlcnQgYmVmb3JlIHRoaXMgdGFnJ3MgZmlyc3QgY2hpbGRcblx0ICogQHBhcmFtIHsgTnVtYmVyIH0gbGVuIC0gaG93IG1hbnkgY2hpbGQgbm9kZXMgdG8gbW92ZVxuXHQgKi9cblx0ZnVuY3Rpb24gbW92ZVZpcnR1YWwodGFnLCBzcmMsIHRhcmdldCwgbGVuKSB7XG5cdCAgdmFyIGVsID0gdGFnLl9yb290LCBzaWIsIGkgPSAwXG5cdCAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgc2liID0gZWwubmV4dFNpYmxpbmdcblx0ICAgIHNyYy5pbnNlcnRCZWZvcmUoZWwsIHRhcmdldC5fcm9vdClcblx0ICAgIGVsID0gc2liXG5cdCAgfVxuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIE1hbmFnZSB0YWdzIGhhdmluZyB0aGUgJ2VhY2gnXG5cdCAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gZG9tIC0gRE9NIG5vZGUgd2UgbmVlZCB0byBsb29wXG5cdCAqIEBwYXJhbSAgIHsgVGFnIH0gcGFyZW50IC0gcGFyZW50IHRhZyBpbnN0YW5jZSB3aGVyZSB0aGUgZG9tIG5vZGUgaXMgY29udGFpbmVkXG5cdCAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gZXhwciAtIHN0cmluZyBjb250YWluZWQgaW4gdGhlICdlYWNoJyBhdHRyaWJ1dGVcblx0ICovXG5cdGZ1bmN0aW9uIF9lYWNoKGRvbSwgcGFyZW50LCBleHByKSB7XG5cdFxuXHQgIC8vIHJlbW92ZSB0aGUgZWFjaCBwcm9wZXJ0eSBmcm9tIHRoZSBvcmlnaW5hbCB0YWdcblx0ICByZW1BdHRyKGRvbSwgJ2VhY2gnKVxuXHRcblx0ICB2YXIgbXVzdFJlb3JkZXIgPSB0eXBlb2YgZ2V0QXR0cihkb20sICduby1yZW9yZGVyJykgIT09IFRfU1RSSU5HIHx8IHJlbUF0dHIoZG9tLCAnbm8tcmVvcmRlcicpLFxuXHQgICAgdGFnTmFtZSA9IGdldFRhZ05hbWUoZG9tKSxcblx0ICAgIGltcGwgPSBfX3RhZ0ltcGxbdGFnTmFtZV0gfHwgeyB0bXBsOiBnZXRPdXRlckhUTUwoZG9tKSB9LFxuXHQgICAgdXNlUm9vdCA9IFNQRUNJQUxfVEFHU19SRUdFWC50ZXN0KHRhZ05hbWUpLFxuXHQgICAgcm9vdCA9IGRvbS5wYXJlbnROb2RlLFxuXHQgICAgcmVmID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpLFxuXHQgICAgY2hpbGQgPSBnZXRUYWcoZG9tKSxcblx0ICAgIGlzT3B0aW9uID0gdGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnb3B0aW9uJywgLy8gdGhlIG9wdGlvbiB0YWdzIG11c3QgYmUgdHJlYXRlZCBkaWZmZXJlbnRseVxuXHQgICAgdGFncyA9IFtdLFxuXHQgICAgb2xkSXRlbXMgPSBbXSxcblx0ICAgIGhhc0tleXMsXG5cdCAgICBpc1ZpcnR1YWwgPSBkb20udGFnTmFtZSA9PSAnVklSVFVBTCdcblx0XG5cdCAgLy8gcGFyc2UgdGhlIGVhY2ggZXhwcmVzc2lvblxuXHQgIGV4cHIgPSB0bXBsLmxvb3BLZXlzKGV4cHIpXG5cdFxuXHQgIC8vIGluc2VydCBhIG1hcmtlZCB3aGVyZSB0aGUgbG9vcCB0YWdzIHdpbGwgYmUgaW5qZWN0ZWRcblx0ICByb290Lmluc2VydEJlZm9yZShyZWYsIGRvbSlcblx0XG5cdCAgLy8gY2xlYW4gdGVtcGxhdGUgY29kZVxuXHQgIHBhcmVudC5vbmUoJ2JlZm9yZS1tb3VudCcsIGZ1bmN0aW9uICgpIHtcblx0XG5cdCAgICAvLyByZW1vdmUgdGhlIG9yaWdpbmFsIERPTSBub2RlXG5cdCAgICBkb20ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkb20pXG5cdCAgICBpZiAocm9vdC5zdHViKSByb290ID0gcGFyZW50LnJvb3Rcblx0XG5cdCAgfSkub24oJ3VwZGF0ZScsIGZ1bmN0aW9uICgpIHtcblx0ICAgIC8vIGdldCB0aGUgbmV3IGl0ZW1zIGNvbGxlY3Rpb25cblx0ICAgIHZhciBpdGVtcyA9IHRtcGwoZXhwci52YWwsIHBhcmVudCksXG5cdCAgICAgIC8vIGNyZWF0ZSBhIGZyYWdtZW50IHRvIGhvbGQgdGhlIG5ldyBET00gbm9kZXMgdG8gaW5qZWN0IGluIHRoZSBwYXJlbnQgdGFnXG5cdCAgICAgIGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KClcblx0XG5cdCAgICAvLyBvYmplY3QgbG9vcC4gYW55IGNoYW5nZXMgY2F1c2UgZnVsbCByZWRyYXdcblx0ICAgIGlmICghaXNBcnJheShpdGVtcykpIHtcblx0ICAgICAgaGFzS2V5cyA9IGl0ZW1zIHx8IGZhbHNlXG5cdCAgICAgIGl0ZW1zID0gaGFzS2V5cyA/XG5cdCAgICAgICAgT2JqZWN0LmtleXMoaXRlbXMpLm1hcChmdW5jdGlvbiAoa2V5KSB7XG5cdCAgICAgICAgICByZXR1cm4gbWtpdGVtKGV4cHIsIGtleSwgaXRlbXNba2V5XSlcblx0ICAgICAgICB9KSA6IFtdXG5cdCAgICB9XG5cdFxuXHQgICAgLy8gbG9vcCBhbGwgdGhlIG5ldyBpdGVtc1xuXHQgICAgdmFyIGkgPSAwLFxuXHQgICAgICBpdGVtc0xlbmd0aCA9IGl0ZW1zLmxlbmd0aFxuXHRcblx0ICAgIGZvciAoOyBpIDwgaXRlbXNMZW5ndGg7IGkrKykge1xuXHQgICAgICAvLyByZW9yZGVyIG9ubHkgaWYgdGhlIGl0ZW1zIGFyZSBvYmplY3RzXG5cdCAgICAgIHZhclxuXHQgICAgICAgIGl0ZW0gPSBpdGVtc1tpXSxcblx0ICAgICAgICBfbXVzdFJlb3JkZXIgPSBtdXN0UmVvcmRlciAmJiB0eXBlb2YgaXRlbSA9PSBUX09CSkVDVCAmJiAhaGFzS2V5cyxcblx0ICAgICAgICBvbGRQb3MgPSBvbGRJdGVtcy5pbmRleE9mKGl0ZW0pLFxuXHQgICAgICAgIHBvcyA9IH5vbGRQb3MgJiYgX211c3RSZW9yZGVyID8gb2xkUG9zIDogaSxcblx0ICAgICAgICAvLyBkb2VzIGEgdGFnIGV4aXN0IGluIHRoaXMgcG9zaXRpb24/XG5cdCAgICAgICAgdGFnID0gdGFnc1twb3NdXG5cdFxuXHQgICAgICBpdGVtID0gIWhhc0tleXMgJiYgZXhwci5rZXkgPyBta2l0ZW0oZXhwciwgaXRlbSwgaSkgOiBpdGVtXG5cdFxuXHQgICAgICAvLyBuZXcgdGFnXG5cdCAgICAgIGlmIChcblx0ICAgICAgICAhX211c3RSZW9yZGVyICYmICF0YWcgLy8gd2l0aCBuby1yZW9yZGVyIHdlIGp1c3QgdXBkYXRlIHRoZSBvbGQgdGFnc1xuXHQgICAgICAgIHx8XG5cdCAgICAgICAgX211c3RSZW9yZGVyICYmICF+b2xkUG9zIHx8ICF0YWcgLy8gYnkgZGVmYXVsdCB3ZSBhbHdheXMgdHJ5IHRvIHJlb3JkZXIgdGhlIERPTSBlbGVtZW50c1xuXHQgICAgICApIHtcblx0XG5cdCAgICAgICAgdGFnID0gbmV3IFRhZyhpbXBsLCB7XG5cdCAgICAgICAgICBwYXJlbnQ6IHBhcmVudCxcblx0ICAgICAgICAgIGlzTG9vcDogdHJ1ZSxcblx0ICAgICAgICAgIGhhc0ltcGw6ICEhX190YWdJbXBsW3RhZ05hbWVdLFxuXHQgICAgICAgICAgcm9vdDogdXNlUm9vdCA/IHJvb3QgOiBkb20uY2xvbmVOb2RlKCksXG5cdCAgICAgICAgICBpdGVtOiBpdGVtXG5cdCAgICAgICAgfSwgZG9tLmlubmVySFRNTClcblx0XG5cdCAgICAgICAgdGFnLm1vdW50KClcblx0XG5cdCAgICAgICAgaWYgKGlzVmlydHVhbCkgdGFnLl9yb290ID0gdGFnLnJvb3QuZmlyc3RDaGlsZCAvLyBzYXZlIHJlZmVyZW5jZSBmb3IgZnVydGhlciBtb3ZlcyBvciBpbnNlcnRzXG5cdCAgICAgICAgLy8gdGhpcyB0YWcgbXVzdCBiZSBhcHBlbmRlZFxuXHQgICAgICAgIGlmIChpID09IHRhZ3MubGVuZ3RoIHx8ICF0YWdzW2ldKSB7IC8vIGZpeCAxNTgxXG5cdCAgICAgICAgICBpZiAoaXNWaXJ0dWFsKVxuXHQgICAgICAgICAgICBhZGRWaXJ0dWFsKHRhZywgZnJhZylcblx0ICAgICAgICAgIGVsc2UgZnJhZy5hcHBlbmRDaGlsZCh0YWcucm9vdClcblx0ICAgICAgICB9XG5cdCAgICAgICAgLy8gdGhpcyB0YWcgbXVzdCBiZSBpbnNlcnRcblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgIGlmIChpc1ZpcnR1YWwpXG5cdCAgICAgICAgICAgIGFkZFZpcnR1YWwodGFnLCByb290LCB0YWdzW2ldKVxuXHQgICAgICAgICAgZWxzZSByb290Lmluc2VydEJlZm9yZSh0YWcucm9vdCwgdGFnc1tpXS5yb290KSAvLyAjMTM3NCBzb21lIGJyb3dzZXJzIHJlc2V0IHNlbGVjdGVkIGhlcmVcblx0ICAgICAgICAgIG9sZEl0ZW1zLnNwbGljZShpLCAwLCBpdGVtKVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGFncy5zcGxpY2UoaSwgMCwgdGFnKVxuXHQgICAgICAgIHBvcyA9IGkgLy8gaGFuZGxlZCBoZXJlIHNvIG5vIG1vdmVcblx0ICAgICAgfSBlbHNlIHRhZy51cGRhdGUoaXRlbSwgdHJ1ZSlcblx0XG5cdCAgICAgIC8vIHJlb3JkZXIgdGhlIHRhZyBpZiBpdCdzIG5vdCBsb2NhdGVkIGluIGl0cyBwcmV2aW91cyBwb3NpdGlvblxuXHQgICAgICBpZiAoXG5cdCAgICAgICAgcG9zICE9PSBpICYmIF9tdXN0UmVvcmRlciAmJlxuXHQgICAgICAgIHRhZ3NbaV0gLy8gZml4IDE1ODEgdW5hYmxlIHRvIHJlcHJvZHVjZSBpdCBpbiBhIHRlc3QhXG5cdCAgICAgICkge1xuXHQgICAgICAgIC8vIHVwZGF0ZSB0aGUgRE9NXG5cdCAgICAgICAgaWYgKGlzVmlydHVhbClcblx0ICAgICAgICAgIG1vdmVWaXJ0dWFsKHRhZywgcm9vdCwgdGFnc1tpXSwgZG9tLmNoaWxkTm9kZXMubGVuZ3RoKVxuXHQgICAgICAgIGVsc2Ugcm9vdC5pbnNlcnRCZWZvcmUodGFnLnJvb3QsIHRhZ3NbaV0ucm9vdClcblx0ICAgICAgICAvLyB1cGRhdGUgdGhlIHBvc2l0aW9uIGF0dHJpYnV0ZSBpZiBpdCBleGlzdHNcblx0ICAgICAgICBpZiAoZXhwci5wb3MpXG5cdCAgICAgICAgICB0YWdbZXhwci5wb3NdID0gaVxuXHQgICAgICAgIC8vIG1vdmUgdGhlIG9sZCB0YWcgaW5zdGFuY2Vcblx0ICAgICAgICB0YWdzLnNwbGljZShpLCAwLCB0YWdzLnNwbGljZShwb3MsIDEpWzBdKVxuXHQgICAgICAgIC8vIG1vdmUgdGhlIG9sZCBpdGVtXG5cdCAgICAgICAgb2xkSXRlbXMuc3BsaWNlKGksIDAsIG9sZEl0ZW1zLnNwbGljZShwb3MsIDEpWzBdKVxuXHQgICAgICAgIC8vIGlmIHRoZSBsb29wIHRhZ3MgYXJlIG5vdCBjdXN0b21cblx0ICAgICAgICAvLyB3ZSBuZWVkIHRvIG1vdmUgYWxsIHRoZWlyIGN1c3RvbSB0YWdzIGludG8gdGhlIHJpZ2h0IHBvc2l0aW9uXG5cdCAgICAgICAgaWYgKCFjaGlsZCAmJiB0YWcudGFncykgbW92ZU5lc3RlZFRhZ3ModGFnLCBpKVxuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyBjYWNoZSB0aGUgb3JpZ2luYWwgaXRlbSB0byB1c2UgaXQgaW4gdGhlIGV2ZW50cyBib3VuZCB0byB0aGlzIG5vZGVcblx0ICAgICAgLy8gYW5kIGl0cyBjaGlsZHJlblxuXHQgICAgICB0YWcuX2l0ZW0gPSBpdGVtXG5cdCAgICAgIC8vIGNhY2hlIHRoZSByZWFsIHBhcmVudCB0YWcgaW50ZXJuYWxseVxuXHQgICAgICBkZWZpbmVQcm9wZXJ0eSh0YWcsICdfcGFyZW50JywgcGFyZW50KVxuXHQgICAgfVxuXHRcblx0ICAgIC8vIHJlbW92ZSB0aGUgcmVkdW5kYW50IHRhZ3Ncblx0ICAgIHVubW91bnRSZWR1bmRhbnQoaXRlbXMsIHRhZ3MpXG5cdFxuXHQgICAgLy8gaW5zZXJ0IHRoZSBuZXcgbm9kZXNcblx0ICAgIHJvb3QuaW5zZXJ0QmVmb3JlKGZyYWcsIHJlZilcblx0ICAgIGlmIChpc09wdGlvbikge1xuXHRcblx0ICAgICAgLy8gIzEzNzQgRmlyZUZveCBidWcgaW4gPG9wdGlvbiBzZWxlY3RlZD17ZXhwcmVzc2lvbn0+XG5cdCAgICAgIGlmIChGSVJFRk9YICYmICFyb290Lm11bHRpcGxlKSB7XG5cdCAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCByb290Lmxlbmd0aDsgbisrKSB7XG5cdCAgICAgICAgICBpZiAocm9vdFtuXS5fX3Jpb3QxMzc0KSB7XG5cdCAgICAgICAgICAgIHJvb3Quc2VsZWN0ZWRJbmRleCA9IG4gIC8vIGNsZWFyIG90aGVyIG9wdGlvbnNcblx0ICAgICAgICAgICAgZGVsZXRlIHJvb3Rbbl0uX19yaW90MTM3NFxuXHQgICAgICAgICAgICBicmVha1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIC8vIHNldCB0aGUgJ3RhZ3MnIHByb3BlcnR5IG9mIHRoZSBwYXJlbnQgdGFnXG5cdCAgICAvLyBpZiBjaGlsZCBpcyAndW5kZWZpbmVkJyBpdCBtZWFucyB0aGF0IHdlIGRvbid0IG5lZWQgdG8gc2V0IHRoaXMgcHJvcGVydHlcblx0ICAgIC8vIGZvciBleGFtcGxlOlxuXHQgICAgLy8gd2UgZG9uJ3QgbmVlZCBzdG9yZSB0aGUgYG15VGFnLnRhZ3NbJ2RpdiddYCBwcm9wZXJ0eSBpZiB3ZSBhcmUgbG9vcGluZyBhIGRpdiB0YWdcblx0ICAgIC8vIGJ1dCB3ZSBuZWVkIHRvIHRyYWNrIHRoZSBgbXlUYWcudGFnc1snY2hpbGQnXWAgcHJvcGVydHkgbG9vcGluZyBhIGN1c3RvbSBjaGlsZCBub2RlIG5hbWVkIGBjaGlsZGBcblx0ICAgIGlmIChjaGlsZCkgcGFyZW50LnRhZ3NbdGFnTmFtZV0gPSB0YWdzXG5cdFxuXHQgICAgLy8gY2xvbmUgdGhlIGl0ZW1zIGFycmF5XG5cdCAgICBvbGRJdGVtcyA9IGl0ZW1zLnNsaWNlKClcblx0XG5cdCAgfSlcblx0XG5cdH1cblx0LyoqXG5cdCAqIE9iamVjdCB0aGF0IHdpbGwgYmUgdXNlZCB0byBpbmplY3QgYW5kIG1hbmFnZSB0aGUgY3NzIG9mIGV2ZXJ5IHRhZyBpbnN0YW5jZVxuXHQgKi9cblx0dmFyIHN0eWxlTWFuYWdlciA9IChmdW5jdGlvbihfcmlvdCkge1xuXHRcblx0ICBpZiAoIXdpbmRvdykgcmV0dXJuIHsgLy8gc2tpcCBpbmplY3Rpb24gb24gdGhlIHNlcnZlclxuXHQgICAgYWRkOiBmdW5jdGlvbiAoKSB7fSxcblx0ICAgIGluamVjdDogZnVuY3Rpb24gKCkge31cblx0ICB9XG5cdFxuXHQgIHZhciBzdHlsZU5vZGUgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgLy8gY3JlYXRlIGEgbmV3IHN0eWxlIGVsZW1lbnQgd2l0aCB0aGUgY29ycmVjdCB0eXBlXG5cdCAgICB2YXIgbmV3Tm9kZSA9IG1rRWwoJ3N0eWxlJylcblx0ICAgIHNldEF0dHIobmV3Tm9kZSwgJ3R5cGUnLCAndGV4dC9jc3MnKVxuXHRcblx0ICAgIC8vIHJlcGxhY2UgYW55IHVzZXIgbm9kZSBvciBpbnNlcnQgdGhlIG5ldyBvbmUgaW50byB0aGUgaGVhZFxuXHQgICAgdmFyIHVzZXJOb2RlID0gJCgnc3R5bGVbdHlwZT1yaW90XScpXG5cdCAgICBpZiAodXNlck5vZGUpIHtcblx0ICAgICAgaWYgKHVzZXJOb2RlLmlkKSBuZXdOb2RlLmlkID0gdXNlck5vZGUuaWRcblx0ICAgICAgdXNlck5vZGUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3Tm9kZSwgdXNlck5vZGUpXG5cdCAgICB9XG5cdCAgICBlbHNlIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQobmV3Tm9kZSlcblx0XG5cdCAgICByZXR1cm4gbmV3Tm9kZVxuXHQgIH0pKClcblx0XG5cdCAgLy8gQ3JlYXRlIGNhY2hlIGFuZCBzaG9ydGN1dCB0byB0aGUgY29ycmVjdCBwcm9wZXJ0eVxuXHQgIHZhciBjc3NUZXh0UHJvcCA9IHN0eWxlTm9kZS5zdHlsZVNoZWV0LFxuXHQgICAgc3R5bGVzVG9JbmplY3QgPSAnJ1xuXHRcblx0ICAvLyBFeHBvc2UgdGhlIHN0eWxlIG5vZGUgaW4gYSBub24tbW9kaWZpY2FibGUgcHJvcGVydHlcblx0ICBPYmplY3QuZGVmaW5lUHJvcGVydHkoX3Jpb3QsICdzdHlsZU5vZGUnLCB7XG5cdCAgICB2YWx1ZTogc3R5bGVOb2RlLFxuXHQgICAgd3JpdGFibGU6IHRydWVcblx0ICB9KVxuXHRcblx0ICAvKipcblx0ICAgKiBQdWJsaWMgYXBpXG5cdCAgICovXG5cdCAgcmV0dXJuIHtcblx0ICAgIC8qKlxuXHQgICAgICogU2F2ZSBhIHRhZyBzdHlsZSB0byBiZSBsYXRlciBpbmplY3RlZCBpbnRvIERPTVxuXHQgICAgICogQHBhcmFtICAgeyBTdHJpbmcgfSBjc3MgW2Rlc2NyaXB0aW9uXVxuXHQgICAgICovXG5cdCAgICBhZGQ6IGZ1bmN0aW9uKGNzcykge1xuXHQgICAgICBzdHlsZXNUb0luamVjdCArPSBjc3Ncblx0ICAgIH0sXG5cdCAgICAvKipcblx0ICAgICAqIEluamVjdCBhbGwgcHJldmlvdXNseSBzYXZlZCB0YWcgc3R5bGVzIGludG8gRE9NXG5cdCAgICAgKiBpbm5lckhUTUwgc2VlbXMgc2xvdzogaHR0cDovL2pzcGVyZi5jb20vcmlvdC1pbnNlcnQtc3R5bGVcblx0ICAgICAqL1xuXHQgICAgaW5qZWN0OiBmdW5jdGlvbigpIHtcblx0ICAgICAgaWYgKHN0eWxlc1RvSW5qZWN0KSB7XG5cdCAgICAgICAgaWYgKGNzc1RleHRQcm9wKSBjc3NUZXh0UHJvcC5jc3NUZXh0ICs9IHN0eWxlc1RvSW5qZWN0XG5cdCAgICAgICAgZWxzZSBzdHlsZU5vZGUuaW5uZXJIVE1MICs9IHN0eWxlc1RvSW5qZWN0XG5cdCAgICAgICAgc3R5bGVzVG9JbmplY3QgPSAnJ1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0fSkocmlvdClcblx0XG5cdFxuXHRmdW5jdGlvbiBwYXJzZU5hbWVkRWxlbWVudHMocm9vdCwgdGFnLCBjaGlsZFRhZ3MsIGZvcmNlUGFyc2luZ05hbWVkKSB7XG5cdFxuXHQgIHdhbGsocm9vdCwgZnVuY3Rpb24oZG9tKSB7XG5cdCAgICBpZiAoZG9tLm5vZGVUeXBlID09IDEpIHtcblx0ICAgICAgZG9tLmlzTG9vcCA9IGRvbS5pc0xvb3AgfHxcblx0ICAgICAgICAgICAgICAgICAgKGRvbS5wYXJlbnROb2RlICYmIGRvbS5wYXJlbnROb2RlLmlzTG9vcCB8fCBnZXRBdHRyKGRvbSwgJ2VhY2gnKSlcblx0ICAgICAgICAgICAgICAgICAgICA/IDEgOiAwXG5cdFxuXHQgICAgICAvLyBjdXN0b20gY2hpbGQgdGFnXG5cdCAgICAgIGlmIChjaGlsZFRhZ3MpIHtcblx0ICAgICAgICB2YXIgY2hpbGQgPSBnZXRUYWcoZG9tKVxuXHRcblx0ICAgICAgICBpZiAoY2hpbGQgJiYgIWRvbS5pc0xvb3ApXG5cdCAgICAgICAgICBjaGlsZFRhZ3MucHVzaChpbml0Q2hpbGRUYWcoY2hpbGQsIHtyb290OiBkb20sIHBhcmVudDogdGFnfSwgZG9tLmlubmVySFRNTCwgdGFnKSlcblx0ICAgICAgfVxuXHRcblx0ICAgICAgaWYgKCFkb20uaXNMb29wIHx8IGZvcmNlUGFyc2luZ05hbWVkKVxuXHQgICAgICAgIHNldE5hbWVkKGRvbSwgdGFnLCBbXSlcblx0ICAgIH1cblx0XG5cdCAgfSlcblx0XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHBhcnNlRXhwcmVzc2lvbnMocm9vdCwgdGFnLCBleHByZXNzaW9ucykge1xuXHRcblx0ICBmdW5jdGlvbiBhZGRFeHByKGRvbSwgdmFsLCBleHRyYSkge1xuXHQgICAgaWYgKHRtcGwuaGFzRXhwcih2YWwpKSB7XG5cdCAgICAgIGV4cHJlc3Npb25zLnB1c2goZXh0ZW5kKHsgZG9tOiBkb20sIGV4cHI6IHZhbCB9LCBleHRyYSkpXG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICB3YWxrKHJvb3QsIGZ1bmN0aW9uKGRvbSkge1xuXHQgICAgdmFyIHR5cGUgPSBkb20ubm9kZVR5cGUsXG5cdCAgICAgIGF0dHJcblx0XG5cdCAgICAvLyB0ZXh0IG5vZGVcblx0ICAgIGlmICh0eXBlID09IDMgJiYgZG9tLnBhcmVudE5vZGUudGFnTmFtZSAhPSAnU1RZTEUnKSBhZGRFeHByKGRvbSwgZG9tLm5vZGVWYWx1ZSlcblx0ICAgIGlmICh0eXBlICE9IDEpIHJldHVyblxuXHRcblx0ICAgIC8qIGVsZW1lbnQgKi9cblx0XG5cdCAgICAvLyBsb29wXG5cdCAgICBhdHRyID0gZ2V0QXR0cihkb20sICdlYWNoJylcblx0XG5cdCAgICBpZiAoYXR0cikgeyBfZWFjaChkb20sIHRhZywgYXR0cik7IHJldHVybiBmYWxzZSB9XG5cdFxuXHQgICAgLy8gYXR0cmlidXRlIGV4cHJlc3Npb25zXG5cdCAgICBlYWNoKGRvbS5hdHRyaWJ1dGVzLCBmdW5jdGlvbihhdHRyKSB7XG5cdCAgICAgIHZhciBuYW1lID0gYXR0ci5uYW1lLFxuXHQgICAgICAgIGJvb2wgPSBuYW1lLnNwbGl0KCdfXycpWzFdXG5cdFxuXHQgICAgICBhZGRFeHByKGRvbSwgYXR0ci52YWx1ZSwgeyBhdHRyOiBib29sIHx8IG5hbWUsIGJvb2w6IGJvb2wgfSlcblx0ICAgICAgaWYgKGJvb2wpIHsgcmVtQXR0cihkb20sIG5hbWUpOyByZXR1cm4gZmFsc2UgfVxuXHRcblx0ICAgIH0pXG5cdFxuXHQgICAgLy8gc2tpcCBjdXN0b20gdGFnc1xuXHQgICAgaWYgKGdldFRhZyhkb20pKSByZXR1cm4gZmFsc2Vcblx0XG5cdCAgfSlcblx0XG5cdH1cblx0ZnVuY3Rpb24gVGFnKGltcGwsIGNvbmYsIGlubmVySFRNTCkge1xuXHRcblx0ICB2YXIgc2VsZiA9IHJpb3Qub2JzZXJ2YWJsZSh0aGlzKSxcblx0ICAgIG9wdHMgPSBpbmhlcml0KGNvbmYub3B0cykgfHwge30sXG5cdCAgICBwYXJlbnQgPSBjb25mLnBhcmVudCxcblx0ICAgIGlzTG9vcCA9IGNvbmYuaXNMb29wLFxuXHQgICAgaGFzSW1wbCA9IGNvbmYuaGFzSW1wbCxcblx0ICAgIGl0ZW0gPSBjbGVhblVwRGF0YShjb25mLml0ZW0pLFxuXHQgICAgZXhwcmVzc2lvbnMgPSBbXSxcblx0ICAgIGNoaWxkVGFncyA9IFtdLFxuXHQgICAgcm9vdCA9IGNvbmYucm9vdCxcblx0ICAgIHRhZ05hbWUgPSByb290LnRhZ05hbWUudG9Mb3dlckNhc2UoKSxcblx0ICAgIGF0dHIgPSB7fSxcblx0ICAgIHByb3BzSW5TeW5jV2l0aFBhcmVudCA9IFtdLFxuXHQgICAgZG9tXG5cdFxuXHQgIC8vIG9ubHkgY2FsbCB1bm1vdW50IGlmIHdlIGhhdmUgYSB2YWxpZCBfX3RhZ0ltcGwgKGhhcyBuYW1lIHByb3BlcnR5KVxuXHQgIGlmIChpbXBsLm5hbWUgJiYgcm9vdC5fdGFnKSByb290Ll90YWcudW5tb3VudCh0cnVlKVxuXHRcblx0ICAvLyBub3QgeWV0IG1vdW50ZWRcblx0ICB0aGlzLmlzTW91bnRlZCA9IGZhbHNlXG5cdCAgcm9vdC5pc0xvb3AgPSBpc0xvb3Bcblx0XG5cdCAgLy8ga2VlcCBhIHJlZmVyZW5jZSB0byB0aGUgdGFnIGp1c3QgY3JlYXRlZFxuXHQgIC8vIHNvIHdlIHdpbGwgYmUgYWJsZSB0byBtb3VudCB0aGlzIHRhZyBtdWx0aXBsZSB0aW1lc1xuXHQgIHJvb3QuX3RhZyA9IHRoaXNcblx0XG5cdCAgLy8gY3JlYXRlIGEgdW5pcXVlIGlkIHRvIHRoaXMgdGFnXG5cdCAgLy8gaXQgY291bGQgYmUgaGFuZHkgdG8gdXNlIGl0IGFsc28gdG8gaW1wcm92ZSB0aGUgdmlydHVhbCBkb20gcmVuZGVyaW5nIHNwZWVkXG5cdCAgZGVmaW5lUHJvcGVydHkodGhpcywgJ19yaW90X2lkJywgKytfX3VpZCkgLy8gYmFzZSAxIGFsbG93cyB0ZXN0ICF0Ll9yaW90X2lkXG5cdFxuXHQgIGV4dGVuZCh0aGlzLCB7IHBhcmVudDogcGFyZW50LCByb290OiByb290LCBvcHRzOiBvcHRzfSwgaXRlbSlcblx0ICAvLyBwcm90ZWN0IHRoZSBcInRhZ3NcIiBwcm9wZXJ0eSBmcm9tIGJlaW5nIG92ZXJyaWRkZW5cblx0ICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCAndGFncycsIHt9KVxuXHRcblx0ICAvLyBncmFiIGF0dHJpYnV0ZXNcblx0ICBlYWNoKHJvb3QuYXR0cmlidXRlcywgZnVuY3Rpb24oZWwpIHtcblx0ICAgIHZhciB2YWwgPSBlbC52YWx1ZVxuXHQgICAgLy8gcmVtZW1iZXIgYXR0cmlidXRlcyB3aXRoIGV4cHJlc3Npb25zIG9ubHlcblx0ICAgIGlmICh0bXBsLmhhc0V4cHIodmFsKSkgYXR0cltlbC5uYW1lXSA9IHZhbFxuXHQgIH0pXG5cdFxuXHQgIGRvbSA9IG1rZG9tKGltcGwudG1wbCwgaW5uZXJIVE1MKVxuXHRcblx0ICAvLyBvcHRpb25zXG5cdCAgZnVuY3Rpb24gdXBkYXRlT3B0cygpIHtcblx0ICAgIHZhciBjdHggPSBoYXNJbXBsICYmIGlzTG9vcCA/IHNlbGYgOiBwYXJlbnQgfHwgc2VsZlxuXHRcblx0ICAgIC8vIHVwZGF0ZSBvcHRzIGZyb20gY3VycmVudCBET00gYXR0cmlidXRlc1xuXHQgICAgZWFjaChyb290LmF0dHJpYnV0ZXMsIGZ1bmN0aW9uKGVsKSB7XG5cdCAgICAgIHZhciB2YWwgPSBlbC52YWx1ZVxuXHQgICAgICBvcHRzW3RvQ2FtZWwoZWwubmFtZSldID0gdG1wbC5oYXNFeHByKHZhbCkgPyB0bXBsKHZhbCwgY3R4KSA6IHZhbFxuXHQgICAgfSlcblx0ICAgIC8vIHJlY292ZXIgdGhvc2Ugd2l0aCBleHByZXNzaW9uc1xuXHQgICAgZWFjaChPYmplY3Qua2V5cyhhdHRyKSwgZnVuY3Rpb24obmFtZSkge1xuXHQgICAgICBvcHRzW3RvQ2FtZWwobmFtZSldID0gdG1wbChhdHRyW25hbWVdLCBjdHgpXG5cdCAgICB9KVxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gbm9ybWFsaXplRGF0YShkYXRhKSB7XG5cdCAgICBmb3IgKHZhciBrZXkgaW4gaXRlbSkge1xuXHQgICAgICBpZiAodHlwZW9mIHNlbGZba2V5XSAhPT0gVF9VTkRFRiAmJiBpc1dyaXRhYmxlKHNlbGYsIGtleSkpXG5cdCAgICAgICAgc2VsZltrZXldID0gZGF0YVtrZXldXG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBpbmhlcml0RnJvbVBhcmVudCAoKSB7XG5cdCAgICBpZiAoIXNlbGYucGFyZW50IHx8ICFpc0xvb3ApIHJldHVyblxuXHQgICAgZWFjaChPYmplY3Qua2V5cyhzZWxmLnBhcmVudCksIGZ1bmN0aW9uKGspIHtcblx0ICAgICAgLy8gc29tZSBwcm9wZXJ0aWVzIG11c3QgYmUgYWx3YXlzIGluIHN5bmMgd2l0aCB0aGUgcGFyZW50IHRhZ1xuXHQgICAgICB2YXIgbXVzdFN5bmMgPSAhUkVTRVJWRURfV09SRFNfQkxBQ0tMSVNULnRlc3QoaykgJiYgY29udGFpbnMocHJvcHNJblN5bmNXaXRoUGFyZW50LCBrKVxuXHQgICAgICBpZiAodHlwZW9mIHNlbGZba10gPT09IFRfVU5ERUYgfHwgbXVzdFN5bmMpIHtcblx0ICAgICAgICAvLyB0cmFjayB0aGUgcHJvcGVydHkgdG8ga2VlcCBpbiBzeW5jXG5cdCAgICAgICAgLy8gc28gd2UgY2FuIGtlZXAgaXQgdXBkYXRlZFxuXHQgICAgICAgIGlmICghbXVzdFN5bmMpIHByb3BzSW5TeW5jV2l0aFBhcmVudC5wdXNoKGspXG5cdCAgICAgICAgc2VsZltrXSA9IHNlbGYucGFyZW50W2tdXG5cdCAgICAgIH1cblx0ICAgIH0pXG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiBVcGRhdGUgdGhlIHRhZyBleHByZXNzaW9ucyBhbmQgb3B0aW9uc1xuXHQgICAqIEBwYXJhbSAgIHsgKiB9ICBkYXRhIC0gZGF0YSB3ZSB3YW50IHRvIHVzZSB0byBleHRlbmQgdGhlIHRhZyBwcm9wZXJ0aWVzXG5cdCAgICogQHBhcmFtICAgeyBCb29sZWFuIH0gaXNJbmhlcml0ZWQgLSBpcyB0aGlzIHVwZGF0ZSBjb21pbmcgZnJvbSBhIHBhcmVudCB0YWc/XG5cdCAgICogQHJldHVybnMgeyBzZWxmIH1cblx0ICAgKi9cblx0ICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCAndXBkYXRlJywgZnVuY3Rpb24oZGF0YSwgaXNJbmhlcml0ZWQpIHtcblx0XG5cdCAgICAvLyBtYWtlIHN1cmUgdGhlIGRhdGEgcGFzc2VkIHdpbGwgbm90IG92ZXJyaWRlXG5cdCAgICAvLyB0aGUgY29tcG9uZW50IGNvcmUgbWV0aG9kc1xuXHQgICAgZGF0YSA9IGNsZWFuVXBEYXRhKGRhdGEpXG5cdCAgICAvLyBpbmhlcml0IHByb3BlcnRpZXMgZnJvbSB0aGUgcGFyZW50XG5cdCAgICBpbmhlcml0RnJvbVBhcmVudCgpXG5cdCAgICAvLyBub3JtYWxpemUgdGhlIHRhZyBwcm9wZXJ0aWVzIGluIGNhc2UgYW4gaXRlbSBvYmplY3Qgd2FzIGluaXRpYWxseSBwYXNzZWRcblx0ICAgIGlmIChkYXRhICYmIGlzT2JqZWN0KGl0ZW0pKSB7XG5cdCAgICAgIG5vcm1hbGl6ZURhdGEoZGF0YSlcblx0ICAgICAgaXRlbSA9IGRhdGFcblx0ICAgIH1cblx0ICAgIGV4dGVuZChzZWxmLCBkYXRhKVxuXHQgICAgdXBkYXRlT3B0cygpXG5cdCAgICBzZWxmLnRyaWdnZXIoJ3VwZGF0ZScsIGRhdGEpXG5cdCAgICB1cGRhdGUoZXhwcmVzc2lvbnMsIHNlbGYpXG5cdFxuXHQgICAgLy8gdGhlIHVwZGF0ZWQgZXZlbnQgd2lsbCBiZSB0cmlnZ2VyZWRcblx0ICAgIC8vIG9uY2UgdGhlIERPTSB3aWxsIGJlIHJlYWR5IGFuZCBhbGwgdGhlIHJlLWZsb3dzIGFyZSBjb21wbGV0ZWRcblx0ICAgIC8vIHRoaXMgaXMgdXNlZnVsIGlmIHlvdSB3YW50IHRvIGdldCB0aGUgXCJyZWFsXCIgcm9vdCBwcm9wZXJ0aWVzXG5cdCAgICAvLyA0IGV4OiByb290Lm9mZnNldFdpZHRoIC4uLlxuXHQgICAgaWYgKGlzSW5oZXJpdGVkICYmIHNlbGYucGFyZW50KVxuXHQgICAgICAvLyBjbG9zZXMgIzE1OTlcblx0ICAgICAgc2VsZi5wYXJlbnQub25lKCd1cGRhdGVkJywgZnVuY3Rpb24oKSB7IHNlbGYudHJpZ2dlcigndXBkYXRlZCcpIH0pXG5cdCAgICBlbHNlIHJBRihmdW5jdGlvbigpIHsgc2VsZi50cmlnZ2VyKCd1cGRhdGVkJykgfSlcblx0XG5cdCAgICByZXR1cm4gdGhpc1xuXHQgIH0pXG5cdFxuXHQgIGRlZmluZVByb3BlcnR5KHRoaXMsICdtaXhpbicsIGZ1bmN0aW9uKCkge1xuXHQgICAgZWFjaChhcmd1bWVudHMsIGZ1bmN0aW9uKG1peCkge1xuXHQgICAgICB2YXIgaW5zdGFuY2UsXG5cdCAgICAgICAgcHJvcHMgPSBbXSxcblx0ICAgICAgICBvYmpcblx0XG5cdCAgICAgIG1peCA9IHR5cGVvZiBtaXggPT09IFRfU1RSSU5HID8gcmlvdC5taXhpbihtaXgpIDogbWl4XG5cdFxuXHQgICAgICAvLyBjaGVjayBpZiB0aGUgbWl4aW4gaXMgYSBmdW5jdGlvblxuXHQgICAgICBpZiAoaXNGdW5jdGlvbihtaXgpKSB7XG5cdCAgICAgICAgLy8gY3JlYXRlIHRoZSBuZXcgbWl4aW4gaW5zdGFuY2Vcblx0ICAgICAgICBpbnN0YW5jZSA9IG5ldyBtaXgoKVxuXHQgICAgICB9IGVsc2UgaW5zdGFuY2UgPSBtaXhcblx0XG5cdCAgICAgIC8vIGJ1aWxkIG11bHRpbGV2ZWwgcHJvdG90eXBlIGluaGVyaXRhbmNlIGNoYWluIHByb3BlcnR5IGxpc3Rcblx0ICAgICAgZG8gcHJvcHMgPSBwcm9wcy5jb25jYXQoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMob2JqIHx8IGluc3RhbmNlKSlcblx0ICAgICAgd2hpbGUgKG9iaiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmogfHwgaW5zdGFuY2UpKVxuXHRcblx0ICAgICAgLy8gbG9vcCB0aGUga2V5cyBpbiB0aGUgZnVuY3Rpb24gcHJvdG90eXBlIG9yIHRoZSBhbGwgb2JqZWN0IGtleXNcblx0ICAgICAgZWFjaChwcm9wcywgZnVuY3Rpb24oa2V5KSB7XG5cdCAgICAgICAgLy8gYmluZCBtZXRob2RzIHRvIHNlbGZcblx0ICAgICAgICBpZiAoa2V5ICE9ICdpbml0JyAmJiAhc2VsZltrZXldKVxuXHQgICAgICAgICAgLy8gYXBwbHkgbWV0aG9kIG9ubHkgaWYgaXQgZG9lcyBub3QgYWxyZWFkeSBleGlzdCBvbiB0aGUgaW5zdGFuY2Vcblx0ICAgICAgICAgIHNlbGZba2V5XSA9IGlzRnVuY3Rpb24oaW5zdGFuY2Vba2V5XSkgP1xuXHQgICAgICAgICAgICBpbnN0YW5jZVtrZXldLmJpbmQoc2VsZikgOlxuXHQgICAgICAgICAgICBpbnN0YW5jZVtrZXldXG5cdCAgICAgIH0pXG5cdFxuXHQgICAgICAvLyBpbml0IG1ldGhvZCB3aWxsIGJlIGNhbGxlZCBhdXRvbWF0aWNhbGx5XG5cdCAgICAgIGlmIChpbnN0YW5jZS5pbml0KSBpbnN0YW5jZS5pbml0LmJpbmQoc2VsZikoKVxuXHQgICAgfSlcblx0ICAgIHJldHVybiB0aGlzXG5cdCAgfSlcblx0XG5cdCAgZGVmaW5lUHJvcGVydHkodGhpcywgJ21vdW50JywgZnVuY3Rpb24oKSB7XG5cdFxuXHQgICAgdXBkYXRlT3B0cygpXG5cdFxuXHQgICAgLy8gYWRkIGdsb2JhbCBtaXhpbnNcblx0ICAgIHZhciBnbG9iYWxNaXhpbiA9IHJpb3QubWl4aW4oR0xPQkFMX01JWElOKVxuXHQgICAgaWYgKGdsb2JhbE1peGluKVxuXHQgICAgICBmb3IgKHZhciBpIGluIGdsb2JhbE1peGluKVxuXHQgICAgICAgIGlmIChnbG9iYWxNaXhpbi5oYXNPd25Qcm9wZXJ0eShpKSlcblx0ICAgICAgICAgIHNlbGYubWl4aW4oZ2xvYmFsTWl4aW5baV0pXG5cdFxuXHQgICAgLy8gaW5pdGlhbGlhdGlvblxuXHQgICAgaWYgKGltcGwuZm4pIGltcGwuZm4uY2FsbChzZWxmLCBvcHRzKVxuXHRcblx0ICAgIC8vIHBhcnNlIGxheW91dCBhZnRlciBpbml0LiBmbiBtYXkgY2FsY3VsYXRlIGFyZ3MgZm9yIG5lc3RlZCBjdXN0b20gdGFnc1xuXHQgICAgcGFyc2VFeHByZXNzaW9ucyhkb20sIHNlbGYsIGV4cHJlc3Npb25zKVxuXHRcblx0ICAgIC8vIG1vdW50IHRoZSBjaGlsZCB0YWdzXG5cdCAgICB0b2dnbGUodHJ1ZSlcblx0XG5cdCAgICAvLyB1cGRhdGUgdGhlIHJvb3QgYWRkaW5nIGN1c3RvbSBhdHRyaWJ1dGVzIGNvbWluZyBmcm9tIHRoZSBjb21waWxlclxuXHQgICAgLy8gaXQgZml4ZXMgYWxzbyAjMTA4N1xuXHQgICAgaWYgKGltcGwuYXR0cnMpXG5cdCAgICAgIHdhbGtBdHRyaWJ1dGVzKGltcGwuYXR0cnMsIGZ1bmN0aW9uIChrLCB2KSB7IHNldEF0dHIocm9vdCwgaywgdikgfSlcblx0ICAgIGlmIChpbXBsLmF0dHJzIHx8IGhhc0ltcGwpXG5cdCAgICAgIHBhcnNlRXhwcmVzc2lvbnMoc2VsZi5yb290LCBzZWxmLCBleHByZXNzaW9ucylcblx0XG5cdCAgICBpZiAoIXNlbGYucGFyZW50IHx8IGlzTG9vcCkgc2VsZi51cGRhdGUoaXRlbSlcblx0XG5cdCAgICAvLyBpbnRlcm5hbCB1c2Ugb25seSwgZml4ZXMgIzQwM1xuXHQgICAgc2VsZi50cmlnZ2VyKCdiZWZvcmUtbW91bnQnKVxuXHRcblx0ICAgIGlmIChpc0xvb3AgJiYgIWhhc0ltcGwpIHtcblx0ICAgICAgLy8gdXBkYXRlIHRoZSByb290IGF0dHJpYnV0ZSBmb3IgdGhlIGxvb3BlZCBlbGVtZW50c1xuXHQgICAgICByb290ID0gZG9tLmZpcnN0Q2hpbGRcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHdoaWxlIChkb20uZmlyc3RDaGlsZCkgcm9vdC5hcHBlbmRDaGlsZChkb20uZmlyc3RDaGlsZClcblx0ICAgICAgaWYgKHJvb3Quc3R1Yikgcm9vdCA9IHBhcmVudC5yb290XG5cdCAgICB9XG5cdFxuXHQgICAgZGVmaW5lUHJvcGVydHkoc2VsZiwgJ3Jvb3QnLCByb290KVxuXHRcblx0ICAgIC8vIHBhcnNlIHRoZSBuYW1lZCBkb20gbm9kZXMgaW4gdGhlIGxvb3BlZCBjaGlsZFxuXHQgICAgLy8gYWRkaW5nIHRoZW0gdG8gdGhlIHBhcmVudCBhcyB3ZWxsXG5cdCAgICBpZiAoaXNMb29wKVxuXHQgICAgICBwYXJzZU5hbWVkRWxlbWVudHMoc2VsZi5yb290LCBzZWxmLnBhcmVudCwgbnVsbCwgdHJ1ZSlcblx0XG5cdCAgICAvLyBpZiBpdCdzIG5vdCBhIGNoaWxkIHRhZyB3ZSBjYW4gdHJpZ2dlciBpdHMgbW91bnQgZXZlbnRcblx0ICAgIGlmICghc2VsZi5wYXJlbnQgfHwgc2VsZi5wYXJlbnQuaXNNb3VudGVkKSB7XG5cdCAgICAgIHNlbGYuaXNNb3VudGVkID0gdHJ1ZVxuXHQgICAgICBzZWxmLnRyaWdnZXIoJ21vdW50Jylcblx0ICAgIH1cblx0ICAgIC8vIG90aGVyd2lzZSB3ZSBuZWVkIHRvIHdhaXQgdGhhdCB0aGUgcGFyZW50IGV2ZW50IGdldHMgdHJpZ2dlcmVkXG5cdCAgICBlbHNlIHNlbGYucGFyZW50Lm9uZSgnbW91bnQnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgLy8gYXZvaWQgdG8gdHJpZ2dlciB0aGUgYG1vdW50YCBldmVudCBmb3IgdGhlIHRhZ3Ncblx0ICAgICAgLy8gbm90IHZpc2libGUgaW5jbHVkZWQgaW4gYW4gaWYgc3RhdGVtZW50XG5cdCAgICAgIGlmICghaXNJblN0dWIoc2VsZi5yb290KSkge1xuXHQgICAgICAgIHNlbGYucGFyZW50LmlzTW91bnRlZCA9IHNlbGYuaXNNb3VudGVkID0gdHJ1ZVxuXHQgICAgICAgIHNlbGYudHJpZ2dlcignbW91bnQnKVxuXHQgICAgICB9XG5cdCAgICB9KVxuXHQgIH0pXG5cdFxuXHRcblx0ICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCAndW5tb3VudCcsIGZ1bmN0aW9uKGtlZXBSb290VGFnKSB7XG5cdCAgICB2YXIgZWwgPSByb290LFxuXHQgICAgICBwID0gZWwucGFyZW50Tm9kZSxcblx0ICAgICAgcHRhZyxcblx0ICAgICAgdGFnSW5kZXggPSBfX3ZpcnR1YWxEb20uaW5kZXhPZihzZWxmKVxuXHRcblx0ICAgIHNlbGYudHJpZ2dlcignYmVmb3JlLXVubW91bnQnKVxuXHRcblx0ICAgIC8vIHJlbW92ZSB0aGlzIHRhZyBpbnN0YW5jZSBmcm9tIHRoZSBnbG9iYWwgdmlydHVhbERvbSB2YXJpYWJsZVxuXHQgICAgaWYgKH50YWdJbmRleClcblx0ICAgICAgX192aXJ0dWFsRG9tLnNwbGljZSh0YWdJbmRleCwgMSlcblx0XG5cdCAgICBpZiAocCkge1xuXHRcblx0ICAgICAgaWYgKHBhcmVudCkge1xuXHQgICAgICAgIHB0YWcgPSBnZXRJbW1lZGlhdGVDdXN0b21QYXJlbnRUYWcocGFyZW50KVxuXHQgICAgICAgIC8vIHJlbW92ZSB0aGlzIHRhZyBmcm9tIHRoZSBwYXJlbnQgdGFncyBvYmplY3Rcblx0ICAgICAgICAvLyBpZiB0aGVyZSBhcmUgbXVsdGlwbGUgbmVzdGVkIHRhZ3Mgd2l0aCBzYW1lIG5hbWUuLlxuXHQgICAgICAgIC8vIHJlbW92ZSB0aGlzIGVsZW1lbnQgZm9ybSB0aGUgYXJyYXlcblx0ICAgICAgICBpZiAoaXNBcnJheShwdGFnLnRhZ3NbdGFnTmFtZV0pKVxuXHQgICAgICAgICAgZWFjaChwdGFnLnRhZ3NbdGFnTmFtZV0sIGZ1bmN0aW9uKHRhZywgaSkge1xuXHQgICAgICAgICAgICBpZiAodGFnLl9yaW90X2lkID09IHNlbGYuX3Jpb3RfaWQpXG5cdCAgICAgICAgICAgICAgcHRhZy50YWdzW3RhZ05hbWVdLnNwbGljZShpLCAxKVxuXHQgICAgICAgICAgfSlcblx0ICAgICAgICBlbHNlXG5cdCAgICAgICAgICAvLyBvdGhlcndpc2UganVzdCBkZWxldGUgdGhlIHRhZyBpbnN0YW5jZVxuXHQgICAgICAgICAgcHRhZy50YWdzW3RhZ05hbWVdID0gdW5kZWZpbmVkXG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGVsc2Vcblx0ICAgICAgICB3aGlsZSAoZWwuZmlyc3RDaGlsZCkgZWwucmVtb3ZlQ2hpbGQoZWwuZmlyc3RDaGlsZClcblx0XG5cdCAgICAgIGlmICgha2VlcFJvb3RUYWcpXG5cdCAgICAgICAgcC5yZW1vdmVDaGlsZChlbClcblx0ICAgICAgZWxzZSB7XG5cdCAgICAgICAgLy8gdGhlIHJpb3QtdGFnIGFuZCB0aGUgZGF0YS1pcyBhdHRyaWJ1dGVzIGFyZW4ndCBuZWVkZWQgYW55bW9yZSwgcmVtb3ZlIHRoZW1cblx0ICAgICAgICByZW1BdHRyKHAsIFJJT1RfVEFHX0lTKVxuXHQgICAgICAgIHJlbUF0dHIocCwgUklPVF9UQUcpIC8vIHRoaXMgd2lsbCBiZSByZW1vdmVkIGluIHJpb3QgMy4wLjBcblx0ICAgICAgfVxuXHRcblx0ICAgIH1cblx0XG5cdCAgICBpZiAodGhpcy5fdmlydHMpIHtcblx0ICAgICAgZWFjaCh0aGlzLl92aXJ0cywgZnVuY3Rpb24odikge1xuXHQgICAgICAgIGlmICh2LnBhcmVudE5vZGUpIHYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh2KVxuXHQgICAgICB9KVxuXHQgICAgfVxuXHRcblx0ICAgIHNlbGYudHJpZ2dlcigndW5tb3VudCcpXG5cdCAgICB0b2dnbGUoKVxuXHQgICAgc2VsZi5vZmYoJyonKVxuXHQgICAgc2VsZi5pc01vdW50ZWQgPSBmYWxzZVxuXHQgICAgZGVsZXRlIHJvb3QuX3RhZ1xuXHRcblx0ICB9KVxuXHRcblx0ICAvLyBwcm94eSBmdW5jdGlvbiB0byBiaW5kIHVwZGF0ZXNcblx0ICAvLyBkaXNwYXRjaGVkIGZyb20gYSBwYXJlbnQgdGFnXG5cdCAgZnVuY3Rpb24gb25DaGlsZFVwZGF0ZShkYXRhKSB7IHNlbGYudXBkYXRlKGRhdGEsIHRydWUpIH1cblx0XG5cdCAgZnVuY3Rpb24gdG9nZ2xlKGlzTW91bnQpIHtcblx0XG5cdCAgICAvLyBtb3VudC91bm1vdW50IGNoaWxkcmVuXG5cdCAgICBlYWNoKGNoaWxkVGFncywgZnVuY3Rpb24oY2hpbGQpIHsgY2hpbGRbaXNNb3VudCA/ICdtb3VudCcgOiAndW5tb3VudCddKCkgfSlcblx0XG5cdCAgICAvLyBsaXN0ZW4vdW5saXN0ZW4gcGFyZW50IChldmVudHMgZmxvdyBvbmUgd2F5IGZyb20gcGFyZW50IHRvIGNoaWxkcmVuKVxuXHQgICAgaWYgKCFwYXJlbnQpIHJldHVyblxuXHQgICAgdmFyIGV2dCA9IGlzTW91bnQgPyAnb24nIDogJ29mZidcblx0XG5cdCAgICAvLyB0aGUgbG9vcCB0YWdzIHdpbGwgYmUgYWx3YXlzIGluIHN5bmMgd2l0aCB0aGUgcGFyZW50IGF1dG9tYXRpY2FsbHlcblx0ICAgIGlmIChpc0xvb3ApXG5cdCAgICAgIHBhcmVudFtldnRdKCd1bm1vdW50Jywgc2VsZi51bm1vdW50KVxuXHQgICAgZWxzZSB7XG5cdCAgICAgIHBhcmVudFtldnRdKCd1cGRhdGUnLCBvbkNoaWxkVXBkYXRlKVtldnRdKCd1bm1vdW50Jywgc2VsZi51bm1vdW50KVxuXHQgICAgfVxuXHQgIH1cblx0XG5cdFxuXHQgIC8vIG5hbWVkIGVsZW1lbnRzIGF2YWlsYWJsZSBmb3IgZm5cblx0ICBwYXJzZU5hbWVkRWxlbWVudHMoZG9tLCB0aGlzLCBjaGlsZFRhZ3MpXG5cdFxuXHR9XG5cdC8qKlxuXHQgKiBBdHRhY2ggYW4gZXZlbnQgdG8gYSBET00gbm9kZVxuXHQgKiBAcGFyYW0geyBTdHJpbmcgfSBuYW1lIC0gZXZlbnQgbmFtZVxuXHQgKiBAcGFyYW0geyBGdW5jdGlvbiB9IGhhbmRsZXIgLSBldmVudCBjYWxsYmFja1xuXHQgKiBAcGFyYW0geyBPYmplY3QgfSBkb20gLSBkb20gbm9kZVxuXHQgKiBAcGFyYW0geyBUYWcgfSB0YWcgLSB0YWcgaW5zdGFuY2Vcblx0ICovXG5cdGZ1bmN0aW9uIHNldEV2ZW50SGFuZGxlcihuYW1lLCBoYW5kbGVyLCBkb20sIHRhZykge1xuXHRcblx0ICBkb21bbmFtZV0gPSBmdW5jdGlvbihlKSB7XG5cdFxuXHQgICAgdmFyIHB0YWcgPSB0YWcuX3BhcmVudCxcblx0ICAgICAgaXRlbSA9IHRhZy5faXRlbSxcblx0ICAgICAgZWxcblx0XG5cdCAgICBpZiAoIWl0ZW0pXG5cdCAgICAgIHdoaWxlIChwdGFnICYmICFpdGVtKSB7XG5cdCAgICAgICAgaXRlbSA9IHB0YWcuX2l0ZW1cblx0ICAgICAgICBwdGFnID0gcHRhZy5fcGFyZW50XG5cdCAgICAgIH1cblx0XG5cdCAgICAvLyBjcm9zcyBicm93c2VyIGV2ZW50IGZpeFxuXHQgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50XG5cdFxuXHQgICAgLy8gb3ZlcnJpZGUgdGhlIGV2ZW50IHByb3BlcnRpZXNcblx0ICAgIGlmIChpc1dyaXRhYmxlKGUsICdjdXJyZW50VGFyZ2V0JykpIGUuY3VycmVudFRhcmdldCA9IGRvbVxuXHQgICAgaWYgKGlzV3JpdGFibGUoZSwgJ3RhcmdldCcpKSBlLnRhcmdldCA9IGUuc3JjRWxlbWVudFxuXHQgICAgaWYgKGlzV3JpdGFibGUoZSwgJ3doaWNoJykpIGUud2hpY2ggPSBlLmNoYXJDb2RlIHx8IGUua2V5Q29kZVxuXHRcblx0ICAgIGUuaXRlbSA9IGl0ZW1cblx0XG5cdCAgICAvLyBwcmV2ZW50IGRlZmF1bHQgYmVoYXZpb3VyIChieSBkZWZhdWx0KVxuXHQgICAgaWYgKGhhbmRsZXIuY2FsbCh0YWcsIGUpICE9PSB0cnVlICYmICEvcmFkaW98Y2hlY2svLnRlc3QoZG9tLnR5cGUpKSB7XG5cdCAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSBlLnByZXZlbnREZWZhdWx0KClcblx0ICAgICAgZS5yZXR1cm5WYWx1ZSA9IGZhbHNlXG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKCFlLnByZXZlbnRVcGRhdGUpIHtcblx0ICAgICAgZWwgPSBpdGVtID8gZ2V0SW1tZWRpYXRlQ3VzdG9tUGFyZW50VGFnKHB0YWcpIDogdGFnXG5cdCAgICAgIGVsLnVwZGF0ZSgpXG5cdCAgICB9XG5cdFxuXHQgIH1cblx0XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogSW5zZXJ0IGEgRE9NIG5vZGUgcmVwbGFjaW5nIGFub3RoZXIgb25lICh1c2VkIGJ5IGlmLSBhdHRyaWJ1dGUpXG5cdCAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gcm9vdCAtIHBhcmVudCBub2RlXG5cdCAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gbm9kZSAtIG5vZGUgcmVwbGFjZWRcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBiZWZvcmUgLSBub2RlIGFkZGVkXG5cdCAqL1xuXHRmdW5jdGlvbiBpbnNlcnRUbyhyb290LCBub2RlLCBiZWZvcmUpIHtcblx0ICBpZiAoIXJvb3QpIHJldHVyblxuXHQgIHJvb3QuaW5zZXJ0QmVmb3JlKGJlZm9yZSwgbm9kZSlcblx0ICByb290LnJlbW92ZUNoaWxkKG5vZGUpXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBVcGRhdGUgdGhlIGV4cHJlc3Npb25zIGluIGEgVGFnIGluc3RhbmNlXG5cdCAqIEBwYXJhbSAgIHsgQXJyYXkgfSBleHByZXNzaW9ucyAtIGV4cHJlc3Npb24gdGhhdCBtdXN0IGJlIHJlIGV2YWx1YXRlZFxuXHQgKiBAcGFyYW0gICB7IFRhZyB9IHRhZyAtIHRhZyBpbnN0YW5jZVxuXHQgKi9cblx0ZnVuY3Rpb24gdXBkYXRlKGV4cHJlc3Npb25zLCB0YWcpIHtcblx0XG5cdCAgZWFjaChleHByZXNzaW9ucywgZnVuY3Rpb24oZXhwciwgaSkge1xuXHRcblx0ICAgIHZhciBkb20gPSBleHByLmRvbSxcblx0ICAgICAgYXR0ck5hbWUgPSBleHByLmF0dHIsXG5cdCAgICAgIHZhbHVlID0gdG1wbChleHByLmV4cHIsIHRhZyksXG5cdCAgICAgIHBhcmVudCA9IGV4cHIuZG9tLnBhcmVudE5vZGVcblx0XG5cdCAgICBpZiAoZXhwci5ib29sKSB7XG5cdCAgICAgIHZhbHVlID0gISF2YWx1ZVxuXHQgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSBudWxsKSB7XG5cdCAgICAgIHZhbHVlID0gJydcblx0ICAgIH1cblx0XG5cdCAgICAvLyAjMTYzODogcmVncmVzc2lvbiBvZiAjMTYxMiwgdXBkYXRlIHRoZSBkb20gb25seSBpZiB0aGUgdmFsdWUgb2YgdGhlXG5cdCAgICAvLyBleHByZXNzaW9uIHdhcyBjaGFuZ2VkXG5cdCAgICBpZiAoZXhwci52YWx1ZSA9PT0gdmFsdWUpIHtcblx0ICAgICAgcmV0dXJuXG5cdCAgICB9XG5cdCAgICBleHByLnZhbHVlID0gdmFsdWVcblx0XG5cdCAgICAvLyB0ZXh0YXJlYSBhbmQgdGV4dCBub2RlcyBoYXMgbm8gYXR0cmlidXRlIG5hbWVcblx0ICAgIGlmICghYXR0ck5hbWUpIHtcblx0ICAgICAgLy8gYWJvdXQgIzgxNSB3L28gcmVwbGFjZTogdGhlIGJyb3dzZXIgY29udmVydHMgdGhlIHZhbHVlIHRvIGEgc3RyaW5nLFxuXHQgICAgICAvLyB0aGUgY29tcGFyaXNvbiBieSBcIj09XCIgZG9lcyB0b28sIGJ1dCBub3QgaW4gdGhlIHNlcnZlclxuXHQgICAgICB2YWx1ZSArPSAnJ1xuXHQgICAgICAvLyB0ZXN0IGZvciBwYXJlbnQgYXZvaWRzIGVycm9yIHdpdGggaW52YWxpZCBhc3NpZ25tZW50IHRvIG5vZGVWYWx1ZVxuXHQgICAgICBpZiAocGFyZW50KSB7XG5cdCAgICAgICAgaWYgKHBhcmVudC50YWdOYW1lID09PSAnVEVYVEFSRUEnKSB7XG5cdCAgICAgICAgICBwYXJlbnQudmFsdWUgPSB2YWx1ZSAgICAgICAgICAgICAgICAgICAgLy8gIzExMTNcblx0ICAgICAgICAgIGlmICghSUVfVkVSU0lPTikgZG9tLm5vZGVWYWx1ZSA9IHZhbHVlICAvLyAjMTYyNSBJRSB0aHJvd3MgaGVyZSwgbm9kZVZhbHVlXG5cdCAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2lsbCBiZSBhdmFpbGFibGUgb24gJ3VwZGF0ZWQnXG5cdCAgICAgICAgZWxzZSBkb20ubm9kZVZhbHVlID0gdmFsdWVcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm5cblx0ICAgIH1cblx0XG5cdCAgICAvLyB+fiMxNjEyOiBsb29rIGZvciBjaGFuZ2VzIGluIGRvbS52YWx1ZSB3aGVuIHVwZGF0aW5nIHRoZSB2YWx1ZX5+XG5cdCAgICBpZiAoYXR0ck5hbWUgPT09ICd2YWx1ZScpIHtcblx0ICAgICAgZG9tLnZhbHVlID0gdmFsdWVcblx0ICAgICAgcmV0dXJuXG5cdCAgICB9XG5cdFxuXHQgICAgLy8gcmVtb3ZlIG9yaWdpbmFsIGF0dHJpYnV0ZVxuXHQgICAgcmVtQXR0cihkb20sIGF0dHJOYW1lKVxuXHRcblx0ICAgIC8vIGV2ZW50IGhhbmRsZXJcblx0ICAgIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkge1xuXHQgICAgICBzZXRFdmVudEhhbmRsZXIoYXR0ck5hbWUsIHZhbHVlLCBkb20sIHRhZylcblx0XG5cdCAgICAvLyBpZi0gY29uZGl0aW9uYWxcblx0ICAgIH0gZWxzZSBpZiAoYXR0ck5hbWUgPT0gJ2lmJykge1xuXHQgICAgICB2YXIgc3R1YiA9IGV4cHIuc3R1Yixcblx0ICAgICAgICBhZGQgPSBmdW5jdGlvbigpIHsgaW5zZXJ0VG8oc3R1Yi5wYXJlbnROb2RlLCBzdHViLCBkb20pIH0sXG5cdCAgICAgICAgcmVtb3ZlID0gZnVuY3Rpb24oKSB7IGluc2VydFRvKGRvbS5wYXJlbnROb2RlLCBkb20sIHN0dWIpIH1cblx0XG5cdCAgICAgIC8vIGFkZCB0byBET01cblx0ICAgICAgaWYgKHZhbHVlKSB7XG5cdCAgICAgICAgaWYgKHN0dWIpIHtcblx0ICAgICAgICAgIGFkZCgpXG5cdCAgICAgICAgICBkb20uaW5TdHViID0gZmFsc2Vcblx0ICAgICAgICAgIC8vIGF2b2lkIHRvIHRyaWdnZXIgdGhlIG1vdW50IGV2ZW50IGlmIHRoZSB0YWdzIGlzIG5vdCB2aXNpYmxlIHlldFxuXHQgICAgICAgICAgLy8gbWF5YmUgd2UgY2FuIG9wdGltaXplIHRoaXMgYXZvaWRpbmcgdG8gbW91bnQgdGhlIHRhZyBhdCBhbGxcblx0ICAgICAgICAgIGlmICghaXNJblN0dWIoZG9tKSkge1xuXHQgICAgICAgICAgICB3YWxrKGRvbSwgZnVuY3Rpb24oZWwpIHtcblx0ICAgICAgICAgICAgICBpZiAoZWwuX3RhZyAmJiAhZWwuX3RhZy5pc01vdW50ZWQpXG5cdCAgICAgICAgICAgICAgICBlbC5fdGFnLmlzTW91bnRlZCA9ICEhZWwuX3RhZy50cmlnZ2VyKCdtb3VudCcpXG5cdCAgICAgICAgICAgIH0pXG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAvLyByZW1vdmUgZnJvbSBET01cblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBzdHViID0gZXhwci5zdHViID0gc3R1YiB8fCBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJylcblx0ICAgICAgICAvLyBpZiB0aGUgcGFyZW50Tm9kZSBpcyBkZWZpbmVkIHdlIGNhbiBlYXNpbHkgcmVwbGFjZSB0aGUgdGFnXG5cdCAgICAgICAgaWYgKGRvbS5wYXJlbnROb2RlKVxuXHQgICAgICAgICAgcmVtb3ZlKClcblx0ICAgICAgICAvLyBvdGhlcndpc2Ugd2UgbmVlZCB0byB3YWl0IHRoZSB1cGRhdGVkIGV2ZW50XG5cdCAgICAgICAgZWxzZSAodGFnLnBhcmVudCB8fCB0YWcpLm9uZSgndXBkYXRlZCcsIHJlbW92ZSlcblx0XG5cdCAgICAgICAgZG9tLmluU3R1YiA9IHRydWVcblx0ICAgICAgfVxuXHQgICAgLy8gc2hvdyAvIGhpZGVcblx0ICAgIH0gZWxzZSBpZiAoYXR0ck5hbWUgPT09ICdzaG93Jykge1xuXHQgICAgICBkb20uc3R5bGUuZGlzcGxheSA9IHZhbHVlID8gJycgOiAnbm9uZSdcblx0XG5cdCAgICB9IGVsc2UgaWYgKGF0dHJOYW1lID09PSAnaGlkZScpIHtcblx0ICAgICAgZG9tLnN0eWxlLmRpc3BsYXkgPSB2YWx1ZSA/ICdub25lJyA6ICcnXG5cdFxuXHQgICAgfSBlbHNlIGlmIChleHByLmJvb2wpIHtcblx0ICAgICAgZG9tW2F0dHJOYW1lXSA9IHZhbHVlXG5cdCAgICAgIGlmICh2YWx1ZSkgc2V0QXR0cihkb20sIGF0dHJOYW1lLCBhdHRyTmFtZSlcblx0ICAgICAgaWYgKEZJUkVGT1ggJiYgYXR0ck5hbWUgPT09ICdzZWxlY3RlZCcgJiYgZG9tLnRhZ05hbWUgPT09ICdPUFRJT04nKSB7XG5cdCAgICAgICAgZG9tLl9fcmlvdDEzNzQgPSB2YWx1ZSAgIC8vICMxMzc0XG5cdCAgICAgIH1cblx0XG5cdCAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAwIHx8IHZhbHVlICYmIHR5cGVvZiB2YWx1ZSAhPT0gVF9PQkpFQ1QpIHtcblx0ICAgICAgLy8gPGltZyBzcmM9XCJ7IGV4cHIgfVwiPlxuXHQgICAgICBpZiAoc3RhcnRzV2l0aChhdHRyTmFtZSwgUklPVF9QUkVGSVgpICYmIGF0dHJOYW1lICE9IFJJT1RfVEFHKSB7XG5cdCAgICAgICAgYXR0ck5hbWUgPSBhdHRyTmFtZS5zbGljZShSSU9UX1BSRUZJWC5sZW5ndGgpXG5cdCAgICAgIH1cblx0ICAgICAgc2V0QXR0cihkb20sIGF0dHJOYW1lLCB2YWx1ZSlcblx0ICAgIH1cblx0XG5cdCAgfSlcblx0XG5cdH1cblx0LyoqXG5cdCAqIFNwZWNpYWxpemVkIGZ1bmN0aW9uIGZvciBsb29waW5nIGFuIGFycmF5LWxpa2UgY29sbGVjdGlvbiB3aXRoIGBlYWNoPXt9YFxuXHQgKiBAcGFyYW0gICB7IEFycmF5IH0gZWxzIC0gY29sbGVjdGlvbiBvZiBpdGVtc1xuXHQgKiBAcGFyYW0gICB7RnVuY3Rpb259IGZuIC0gY2FsbGJhY2sgZnVuY3Rpb25cblx0ICogQHJldHVybnMgeyBBcnJheSB9IHRoZSBhcnJheSBsb29wZWRcblx0ICovXG5cdGZ1bmN0aW9uIGVhY2goZWxzLCBmbikge1xuXHQgIHZhciBsZW4gPSBlbHMgPyBlbHMubGVuZ3RoIDogMFxuXHRcblx0ICBmb3IgKHZhciBpID0gMCwgZWw7IGkgPCBsZW47IGkrKykge1xuXHQgICAgZWwgPSBlbHNbaV1cblx0ICAgIC8vIHJldHVybiBmYWxzZSAtPiBjdXJyZW50IGl0ZW0gd2FzIHJlbW92ZWQgYnkgZm4gZHVyaW5nIHRoZSBsb29wXG5cdCAgICBpZiAoZWwgIT0gbnVsbCAmJiBmbihlbCwgaSkgPT09IGZhbHNlKSBpLS1cblx0ICB9XG5cdCAgcmV0dXJuIGVsc1xuXHR9XG5cdFxuXHQvKipcblx0ICogRGV0ZWN0IGlmIHRoZSBhcmd1bWVudCBwYXNzZWQgaXMgYSBmdW5jdGlvblxuXHQgKiBAcGFyYW0gICB7ICogfSB2IC0gd2hhdGV2ZXIgeW91IHdhbnQgdG8gcGFzcyB0byB0aGlzIGZ1bmN0aW9uXG5cdCAqIEByZXR1cm5zIHsgQm9vbGVhbiB9IC1cblx0ICovXG5cdGZ1bmN0aW9uIGlzRnVuY3Rpb24odikge1xuXHQgIHJldHVybiB0eXBlb2YgdiA9PT0gVF9GVU5DVElPTiB8fCBmYWxzZSAgIC8vIGF2b2lkIElFIHByb2JsZW1zXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBHZXQgdGhlIG91dGVyIGh0bWwgb2YgYW55IERPTSBub2RlIFNWR3MgaW5jbHVkZWRcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBlbCAtIERPTSBub2RlIHRvIHBhcnNlXG5cdCAqIEByZXR1cm5zIHsgU3RyaW5nIH0gZWwub3V0ZXJIVE1MXG5cdCAqL1xuXHRmdW5jdGlvbiBnZXRPdXRlckhUTUwoZWwpIHtcblx0ICBpZiAoZWwub3V0ZXJIVE1MKSByZXR1cm4gZWwub3V0ZXJIVE1MXG5cdCAgLy8gc29tZSBicm93c2VycyBkbyBub3Qgc3VwcG9ydCBvdXRlckhUTUwgb24gdGhlIFNWR3MgdGFnc1xuXHQgIGVsc2Uge1xuXHQgICAgdmFyIGNvbnRhaW5lciA9IG1rRWwoJ2RpdicpXG5cdCAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZWwuY2xvbmVOb2RlKHRydWUpKVxuXHQgICAgcmV0dXJuIGNvbnRhaW5lci5pbm5lckhUTUxcblx0ICB9XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBTZXQgdGhlIGlubmVyIGh0bWwgb2YgYW55IERPTSBub2RlIFNWR3MgaW5jbHVkZWRcblx0ICogQHBhcmFtIHsgT2JqZWN0IH0gY29udGFpbmVyIC0gRE9NIG5vZGUgd2hlcmUgd2Ugd2lsbCBpbmplY3QgdGhlIG5ldyBodG1sXG5cdCAqIEBwYXJhbSB7IFN0cmluZyB9IGh0bWwgLSBodG1sIHRvIGluamVjdFxuXHQgKi9cblx0ZnVuY3Rpb24gc2V0SW5uZXJIVE1MKGNvbnRhaW5lciwgaHRtbCkge1xuXHQgIGlmICh0eXBlb2YgY29udGFpbmVyLmlubmVySFRNTCAhPSBUX1VOREVGKSBjb250YWluZXIuaW5uZXJIVE1MID0gaHRtbFxuXHQgIC8vIHNvbWUgYnJvd3NlcnMgZG8gbm90IHN1cHBvcnQgaW5uZXJIVE1MIG9uIHRoZSBTVkdzIHRhZ3Ncblx0ICBlbHNlIHtcblx0ICAgIHZhciBkb2MgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGh0bWwsICdhcHBsaWNhdGlvbi94bWwnKVxuXHQgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKFxuXHQgICAgICBjb250YWluZXIub3duZXJEb2N1bWVudC5pbXBvcnROb2RlKGRvYy5kb2N1bWVudEVsZW1lbnQsIHRydWUpXG5cdCAgICApXG5cdCAgfVxuXHR9XG5cdFxuXHQvKipcblx0ICogQ2hlY2tzIHdldGhlciBhIERPTSBub2RlIG11c3QgYmUgY29uc2lkZXJlZCBwYXJ0IG9mIGFuIHN2ZyBkb2N1bWVudFxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9ICBuYW1lIC0gdGFnIG5hbWVcblx0ICogQHJldHVybnMgeyBCb29sZWFuIH0gLVxuXHQgKi9cblx0ZnVuY3Rpb24gaXNTVkdUYWcobmFtZSkge1xuXHQgIHJldHVybiB+U1ZHX1RBR1NfTElTVC5pbmRleE9mKG5hbWUpXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBEZXRlY3QgaWYgdGhlIGFyZ3VtZW50IHBhc3NlZCBpcyBhbiBvYmplY3QsIGV4Y2x1ZGUgbnVsbC5cblx0ICogTk9URTogVXNlIGlzT2JqZWN0KHgpICYmICFpc0FycmF5KHgpIHRvIGV4Y2x1ZGVzIGFycmF5cy5cblx0ICogQHBhcmFtICAgeyAqIH0gdiAtIHdoYXRldmVyIHlvdSB3YW50IHRvIHBhc3MgdG8gdGhpcyBmdW5jdGlvblxuXHQgKiBAcmV0dXJucyB7IEJvb2xlYW4gfSAtXG5cdCAqL1xuXHRmdW5jdGlvbiBpc09iamVjdCh2KSB7XG5cdCAgcmV0dXJuIHYgJiYgdHlwZW9mIHYgPT09IFRfT0JKRUNUICAgICAgICAgLy8gdHlwZW9mIG51bGwgaXMgJ29iamVjdCdcblx0fVxuXHRcblx0LyoqXG5cdCAqIFJlbW92ZSBhbnkgRE9NIGF0dHJpYnV0ZSBmcm9tIGEgbm9kZVxuXHQgKiBAcGFyYW0gICB7IE9iamVjdCB9IGRvbSAtIERPTSBub2RlIHdlIHdhbnQgdG8gdXBkYXRlXG5cdCAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gbmFtZSAtIG5hbWUgb2YgdGhlIHByb3BlcnR5IHdlIHdhbnQgdG8gcmVtb3ZlXG5cdCAqL1xuXHRmdW5jdGlvbiByZW1BdHRyKGRvbSwgbmFtZSkge1xuXHQgIGRvbS5yZW1vdmVBdHRyaWJ1dGUobmFtZSlcblx0fVxuXHRcblx0LyoqXG5cdCAqIENvbnZlcnQgYSBzdHJpbmcgY29udGFpbmluZyBkYXNoZXMgdG8gY2FtZWwgY2FzZVxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9IHN0cmluZyAtIGlucHV0IHN0cmluZ1xuXHQgKiBAcmV0dXJucyB7IFN0cmluZyB9IG15LXN0cmluZyAtPiBteVN0cmluZ1xuXHQgKi9cblx0ZnVuY3Rpb24gdG9DYW1lbChzdHJpbmcpIHtcblx0ICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoLy0oXFx3KS9nLCBmdW5jdGlvbihfLCBjKSB7XG5cdCAgICByZXR1cm4gYy50b1VwcGVyQ2FzZSgpXG5cdCAgfSlcblx0fVxuXHRcblx0LyoqXG5cdCAqIEdldCB0aGUgdmFsdWUgb2YgYW55IERPTSBhdHRyaWJ1dGUgb24gYSBub2RlXG5cdCAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gZG9tIC0gRE9NIG5vZGUgd2Ugd2FudCB0byBwYXJzZVxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9IG5hbWUgLSBuYW1lIG9mIHRoZSBhdHRyaWJ1dGUgd2Ugd2FudCB0byBnZXRcblx0ICogQHJldHVybnMgeyBTdHJpbmcgfCB1bmRlZmluZWQgfSBuYW1lIG9mIHRoZSBub2RlIGF0dHJpYnV0ZSB3aGV0aGVyIGl0IGV4aXN0c1xuXHQgKi9cblx0ZnVuY3Rpb24gZ2V0QXR0cihkb20sIG5hbWUpIHtcblx0ICByZXR1cm4gZG9tLmdldEF0dHJpYnV0ZShuYW1lKVxuXHR9XG5cdFxuXHQvKipcblx0ICogU2V0IGFueSBET00gYXR0cmlidXRlXG5cdCAqIEBwYXJhbSB7IE9iamVjdCB9IGRvbSAtIERPTSBub2RlIHdlIHdhbnQgdG8gdXBkYXRlXG5cdCAqIEBwYXJhbSB7IFN0cmluZyB9IG5hbWUgLSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB3ZSB3YW50IHRvIHNldFxuXHQgKiBAcGFyYW0geyBTdHJpbmcgfSB2YWwgLSB2YWx1ZSBvZiB0aGUgcHJvcGVydHkgd2Ugd2FudCB0byBzZXRcblx0ICovXG5cdGZ1bmN0aW9uIHNldEF0dHIoZG9tLCBuYW1lLCB2YWwpIHtcblx0ICBkb20uc2V0QXR0cmlidXRlKG5hbWUsIHZhbClcblx0fVxuXHRcblx0LyoqXG5cdCAqIERldGVjdCB0aGUgdGFnIGltcGxlbWVudGF0aW9uIGJ5IGEgRE9NIG5vZGVcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBkb20gLSBET00gbm9kZSB3ZSBuZWVkIHRvIHBhcnNlIHRvIGdldCBpdHMgdGFnIGltcGxlbWVudGF0aW9uXG5cdCAqIEByZXR1cm5zIHsgT2JqZWN0IH0gaXQgcmV0dXJucyBhbiBvYmplY3QgY29udGFpbmluZyB0aGUgaW1wbGVtZW50YXRpb24gb2YgYSBjdXN0b20gdGFnICh0ZW1wbGF0ZSBhbmQgYm9vdCBmdW5jdGlvbilcblx0ICovXG5cdGZ1bmN0aW9uIGdldFRhZyhkb20pIHtcblx0ICByZXR1cm4gZG9tLnRhZ05hbWUgJiYgX190YWdJbXBsW2dldEF0dHIoZG9tLCBSSU9UX1RBR19JUykgfHxcblx0ICAgIGdldEF0dHIoZG9tLCBSSU9UX1RBRykgfHwgZG9tLnRhZ05hbWUudG9Mb3dlckNhc2UoKV1cblx0fVxuXHQvKipcblx0ICogQWRkIGEgY2hpbGQgdGFnIHRvIGl0cyBwYXJlbnQgaW50byB0aGUgYHRhZ3NgIG9iamVjdFxuXHQgKiBAcGFyYW0gICB7IE9iamVjdCB9IHRhZyAtIGNoaWxkIHRhZyBpbnN0YW5jZVxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9IHRhZ05hbWUgLSBrZXkgd2hlcmUgdGhlIG5ldyB0YWcgd2lsbCBiZSBzdG9yZWRcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBwYXJlbnQgLSB0YWcgaW5zdGFuY2Ugd2hlcmUgdGhlIG5ldyBjaGlsZCB0YWcgd2lsbCBiZSBpbmNsdWRlZFxuXHQgKi9cblx0ZnVuY3Rpb24gYWRkQ2hpbGRUYWcodGFnLCB0YWdOYW1lLCBwYXJlbnQpIHtcblx0ICB2YXIgY2FjaGVkVGFnID0gcGFyZW50LnRhZ3NbdGFnTmFtZV1cblx0XG5cdCAgLy8gaWYgdGhlcmUgYXJlIG11bHRpcGxlIGNoaWxkcmVuIHRhZ3MgaGF2aW5nIHRoZSBzYW1lIG5hbWVcblx0ICBpZiAoY2FjaGVkVGFnKSB7XG5cdCAgICAvLyBpZiB0aGUgcGFyZW50IHRhZ3MgcHJvcGVydHkgaXMgbm90IHlldCBhbiBhcnJheVxuXHQgICAgLy8gY3JlYXRlIGl0IGFkZGluZyB0aGUgZmlyc3QgY2FjaGVkIHRhZ1xuXHQgICAgaWYgKCFpc0FycmF5KGNhY2hlZFRhZykpXG5cdCAgICAgIC8vIGRvbid0IGFkZCB0aGUgc2FtZSB0YWcgdHdpY2Vcblx0ICAgICAgaWYgKGNhY2hlZFRhZyAhPT0gdGFnKVxuXHQgICAgICAgIHBhcmVudC50YWdzW3RhZ05hbWVdID0gW2NhY2hlZFRhZ11cblx0ICAgIC8vIGFkZCB0aGUgbmV3IG5lc3RlZCB0YWcgdG8gdGhlIGFycmF5XG5cdCAgICBpZiAoIWNvbnRhaW5zKHBhcmVudC50YWdzW3RhZ05hbWVdLCB0YWcpKVxuXHQgICAgICBwYXJlbnQudGFnc1t0YWdOYW1lXS5wdXNoKHRhZylcblx0ICB9IGVsc2Uge1xuXHQgICAgcGFyZW50LnRhZ3NbdGFnTmFtZV0gPSB0YWdcblx0ICB9XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBNb3ZlIHRoZSBwb3NpdGlvbiBvZiBhIGN1c3RvbSB0YWcgaW4gaXRzIHBhcmVudCB0YWdcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSB0YWcgLSBjaGlsZCB0YWcgaW5zdGFuY2Vcblx0ICogQHBhcmFtICAgeyBTdHJpbmcgfSB0YWdOYW1lIC0ga2V5IHdoZXJlIHRoZSB0YWcgd2FzIHN0b3JlZFxuXHQgKiBAcGFyYW0gICB7IE51bWJlciB9IG5ld1BvcyAtIGluZGV4IHdoZXJlIHRoZSBuZXcgdGFnIHdpbGwgYmUgc3RvcmVkXG5cdCAqL1xuXHRmdW5jdGlvbiBtb3ZlQ2hpbGRUYWcodGFnLCB0YWdOYW1lLCBuZXdQb3MpIHtcblx0ICB2YXIgcGFyZW50ID0gdGFnLnBhcmVudCxcblx0ICAgIHRhZ3Ncblx0ICAvLyBubyBwYXJlbnQgbm8gbW92ZVxuXHQgIGlmICghcGFyZW50KSByZXR1cm5cblx0XG5cdCAgdGFncyA9IHBhcmVudC50YWdzW3RhZ05hbWVdXG5cdFxuXHQgIGlmIChpc0FycmF5KHRhZ3MpKVxuXHQgICAgdGFncy5zcGxpY2UobmV3UG9zLCAwLCB0YWdzLnNwbGljZSh0YWdzLmluZGV4T2YodGFnKSwgMSlbMF0pXG5cdCAgZWxzZSBhZGRDaGlsZFRhZyh0YWcsIHRhZ05hbWUsIHBhcmVudClcblx0fVxuXHRcblx0LyoqXG5cdCAqIENyZWF0ZSBhIG5ldyBjaGlsZCB0YWcgaW5jbHVkaW5nIGl0IGNvcnJlY3RseSBpbnRvIGl0cyBwYXJlbnRcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBjaGlsZCAtIGNoaWxkIHRhZyBpbXBsZW1lbnRhdGlvblxuXHQgKiBAcGFyYW0gICB7IE9iamVjdCB9IG9wdHMgLSB0YWcgb3B0aW9ucyBjb250YWluaW5nIHRoZSBET00gbm9kZSB3aGVyZSB0aGUgdGFnIHdpbGwgYmUgbW91bnRlZFxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9IGlubmVySFRNTCAtIGlubmVyIGh0bWwgb2YgdGhlIGNoaWxkIG5vZGVcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBwYXJlbnQgLSBpbnN0YW5jZSBvZiB0aGUgcGFyZW50IHRhZyBpbmNsdWRpbmcgdGhlIGNoaWxkIGN1c3RvbSB0YWdcblx0ICogQHJldHVybnMgeyBPYmplY3QgfSBpbnN0YW5jZSBvZiB0aGUgbmV3IGNoaWxkIHRhZyBqdXN0IGNyZWF0ZWRcblx0ICovXG5cdGZ1bmN0aW9uIGluaXRDaGlsZFRhZyhjaGlsZCwgb3B0cywgaW5uZXJIVE1MLCBwYXJlbnQpIHtcblx0ICB2YXIgdGFnID0gbmV3IFRhZyhjaGlsZCwgb3B0cywgaW5uZXJIVE1MKSxcblx0ICAgIHRhZ05hbWUgPSBnZXRUYWdOYW1lKG9wdHMucm9vdCksXG5cdCAgICBwdGFnID0gZ2V0SW1tZWRpYXRlQ3VzdG9tUGFyZW50VGFnKHBhcmVudClcblx0ICAvLyBmaXggZm9yIHRoZSBwYXJlbnQgYXR0cmlidXRlIGluIHRoZSBsb29wZWQgZWxlbWVudHNcblx0ICB0YWcucGFyZW50ID0gcHRhZ1xuXHQgIC8vIHN0b3JlIHRoZSByZWFsIHBhcmVudCB0YWdcblx0ICAvLyBpbiBzb21lIGNhc2VzIHRoaXMgY291bGQgYmUgZGlmZmVyZW50IGZyb20gdGhlIGN1c3RvbSBwYXJlbnQgdGFnXG5cdCAgLy8gZm9yIGV4YW1wbGUgaW4gbmVzdGVkIGxvb3BzXG5cdCAgdGFnLl9wYXJlbnQgPSBwYXJlbnRcblx0XG5cdCAgLy8gYWRkIHRoaXMgdGFnIHRvIHRoZSBjdXN0b20gcGFyZW50IHRhZ1xuXHQgIGFkZENoaWxkVGFnKHRhZywgdGFnTmFtZSwgcHRhZylcblx0ICAvLyBhbmQgYWxzbyB0byB0aGUgcmVhbCBwYXJlbnQgdGFnXG5cdCAgaWYgKHB0YWcgIT09IHBhcmVudClcblx0ICAgIGFkZENoaWxkVGFnKHRhZywgdGFnTmFtZSwgcGFyZW50KVxuXHQgIC8vIGVtcHR5IHRoZSBjaGlsZCBub2RlIG9uY2Ugd2UgZ290IGl0cyB0ZW1wbGF0ZVxuXHQgIC8vIHRvIGF2b2lkIHRoYXQgaXRzIGNoaWxkcmVuIGdldCBjb21waWxlZCBtdWx0aXBsZSB0aW1lc1xuXHQgIG9wdHMucm9vdC5pbm5lckhUTUwgPSAnJ1xuXHRcblx0ICByZXR1cm4gdGFnXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBMb29wIGJhY2t3YXJkIGFsbCB0aGUgcGFyZW50cyB0cmVlIHRvIGRldGVjdCB0aGUgZmlyc3QgY3VzdG9tIHBhcmVudCB0YWdcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSB0YWcgLSBhIFRhZyBpbnN0YW5jZVxuXHQgKiBAcmV0dXJucyB7IE9iamVjdCB9IHRoZSBpbnN0YW5jZSBvZiB0aGUgZmlyc3QgY3VzdG9tIHBhcmVudCB0YWcgZm91bmRcblx0ICovXG5cdGZ1bmN0aW9uIGdldEltbWVkaWF0ZUN1c3RvbVBhcmVudFRhZyh0YWcpIHtcblx0ICB2YXIgcHRhZyA9IHRhZ1xuXHQgIHdoaWxlICghZ2V0VGFnKHB0YWcucm9vdCkpIHtcblx0ICAgIGlmICghcHRhZy5wYXJlbnQpIGJyZWFrXG5cdCAgICBwdGFnID0gcHRhZy5wYXJlbnRcblx0ICB9XG5cdCAgcmV0dXJuIHB0YWdcblx0fVxuXHRcblx0LyoqXG5cdCAqIEhlbHBlciBmdW5jdGlvbiB0byBzZXQgYW4gaW1tdXRhYmxlIHByb3BlcnR5XG5cdCAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gZWwgLSBvYmplY3Qgd2hlcmUgdGhlIG5ldyBwcm9wZXJ0eSB3aWxsIGJlIHNldFxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9IGtleSAtIG9iamVjdCBrZXkgd2hlcmUgdGhlIG5ldyBwcm9wZXJ0eSB3aWxsIGJlIHN0b3JlZFxuXHQgKiBAcGFyYW0gICB7ICogfSB2YWx1ZSAtIHZhbHVlIG9mIHRoZSBuZXcgcHJvcGVydHlcblx0KiBAcGFyYW0gICB7IE9iamVjdCB9IG9wdGlvbnMgLSBzZXQgdGhlIHByb3Blcnkgb3ZlcnJpZGluZyB0aGUgZGVmYXVsdCBvcHRpb25zXG5cdCAqIEByZXR1cm5zIHsgT2JqZWN0IH0gLSB0aGUgaW5pdGlhbCBvYmplY3Rcblx0ICovXG5cdGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KGVsLCBrZXksIHZhbHVlLCBvcHRpb25zKSB7XG5cdCAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsLCBrZXksIGV4dGVuZCh7XG5cdCAgICB2YWx1ZTogdmFsdWUsXG5cdCAgICBlbnVtZXJhYmxlOiBmYWxzZSxcblx0ICAgIHdyaXRhYmxlOiBmYWxzZSxcblx0ICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuXHQgIH0sIG9wdGlvbnMpKVxuXHQgIHJldHVybiBlbFxuXHR9XG5cdFxuXHQvKipcblx0ICogR2V0IHRoZSB0YWcgbmFtZSBvZiBhbnkgRE9NIG5vZGVcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBkb20gLSBET00gbm9kZSB3ZSB3YW50IHRvIHBhcnNlXG5cdCAqIEByZXR1cm5zIHsgU3RyaW5nIH0gbmFtZSB0byBpZGVudGlmeSB0aGlzIGRvbSBub2RlIGluIHJpb3Rcblx0ICovXG5cdGZ1bmN0aW9uIGdldFRhZ05hbWUoZG9tKSB7XG5cdCAgdmFyIGNoaWxkID0gZ2V0VGFnKGRvbSksXG5cdCAgICBuYW1lZFRhZyA9IGdldEF0dHIoZG9tLCAnbmFtZScpLFxuXHQgICAgdGFnTmFtZSA9IG5hbWVkVGFnICYmICF0bXBsLmhhc0V4cHIobmFtZWRUYWcpID9cblx0ICAgICAgICAgICAgICAgIG5hbWVkVGFnIDpcblx0ICAgICAgICAgICAgICBjaGlsZCA/IGNoaWxkLm5hbWUgOiBkb20udGFnTmFtZS50b0xvd2VyQ2FzZSgpXG5cdFxuXHQgIHJldHVybiB0YWdOYW1lXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBFeHRlbmQgYW55IG9iamVjdCB3aXRoIG90aGVyIHByb3BlcnRpZXNcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBzcmMgLSBzb3VyY2Ugb2JqZWN0XG5cdCAqIEByZXR1cm5zIHsgT2JqZWN0IH0gdGhlIHJlc3VsdGluZyBleHRlbmRlZCBvYmplY3Rcblx0ICpcblx0ICogdmFyIG9iaiA9IHsgZm9vOiAnYmF6JyB9XG5cdCAqIGV4dGVuZChvYmosIHtiYXI6ICdiYXInLCBmb286ICdiYXInfSlcblx0ICogY29uc29sZS5sb2cob2JqKSA9PiB7YmFyOiAnYmFyJywgZm9vOiAnYmFyJ31cblx0ICpcblx0ICovXG5cdGZ1bmN0aW9uIGV4dGVuZChzcmMpIHtcblx0ICB2YXIgb2JqLCBhcmdzID0gYXJndW1lbnRzXG5cdCAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmdzLmxlbmd0aDsgKytpKSB7XG5cdCAgICBpZiAob2JqID0gYXJnc1tpXSkge1xuXHQgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG5cdCAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBwcm9wZXJ0eSBvZiB0aGUgc291cmNlIG9iamVjdCBjb3VsZCBiZSBvdmVycmlkZGVuXG5cdCAgICAgICAgaWYgKGlzV3JpdGFibGUoc3JjLCBrZXkpKVxuXHQgICAgICAgICAgc3JjW2tleV0gPSBvYmpba2V5XVxuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfVxuXHQgIHJldHVybiBzcmNcblx0fVxuXHRcblx0LyoqXG5cdCAqIENoZWNrIHdoZXRoZXIgYW4gYXJyYXkgY29udGFpbnMgYW4gaXRlbVxuXHQgKiBAcGFyYW0gICB7IEFycmF5IH0gYXJyIC0gdGFyZ2V0IGFycmF5XG5cdCAqIEBwYXJhbSAgIHsgKiB9IGl0ZW0gLSBpdGVtIHRvIHRlc3Rcblx0ICogQHJldHVybnMgeyBCb29sZWFuIH0gRG9lcyAnYXJyJyBjb250YWluICdpdGVtJz9cblx0ICovXG5cdGZ1bmN0aW9uIGNvbnRhaW5zKGFyciwgaXRlbSkge1xuXHQgIHJldHVybiB+YXJyLmluZGV4T2YoaXRlbSlcblx0fVxuXHRcblx0LyoqXG5cdCAqIENoZWNrIHdoZXRoZXIgYW4gb2JqZWN0IGlzIGEga2luZCBvZiBhcnJheVxuXHQgKiBAcGFyYW0gICB7ICogfSBhIC0gYW55dGhpbmdcblx0ICogQHJldHVybnMge0Jvb2xlYW59IGlzICdhJyBhbiBhcnJheT9cblx0ICovXG5cdGZ1bmN0aW9uIGlzQXJyYXkoYSkgeyByZXR1cm4gQXJyYXkuaXNBcnJheShhKSB8fCBhIGluc3RhbmNlb2YgQXJyYXkgfVxuXHRcblx0LyoqXG5cdCAqIERldGVjdCB3aGV0aGVyIGEgcHJvcGVydHkgb2YgYW4gb2JqZWN0IGNvdWxkIGJlIG92ZXJyaWRkZW5cblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSAgb2JqIC0gc291cmNlIG9iamVjdFxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9ICBrZXkgLSBvYmplY3QgcHJvcGVydHlcblx0ICogQHJldHVybnMgeyBCb29sZWFuIH0gaXMgdGhpcyBwcm9wZXJ0eSB3cml0YWJsZT9cblx0ICovXG5cdGZ1bmN0aW9uIGlzV3JpdGFibGUob2JqLCBrZXkpIHtcblx0ICB2YXIgcHJvcHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KVxuXHQgIHJldHVybiB0eXBlb2Ygb2JqW2tleV0gPT09IFRfVU5ERUYgfHwgcHJvcHMgJiYgcHJvcHMud3JpdGFibGVcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBXaXRoIHRoaXMgZnVuY3Rpb24gd2UgYXZvaWQgdGhhdCB0aGUgaW50ZXJuYWwgVGFnIG1ldGhvZHMgZ2V0IG92ZXJyaWRkZW5cblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBkYXRhIC0gb3B0aW9ucyB3ZSB3YW50IHRvIHVzZSB0byBleHRlbmQgdGhlIHRhZyBpbnN0YW5jZVxuXHQgKiBAcmV0dXJucyB7IE9iamVjdCB9IGNsZWFuIG9iamVjdCB3aXRob3V0IGNvbnRhaW5pbmcgdGhlIHJpb3QgaW50ZXJuYWwgcmVzZXJ2ZWQgd29yZHNcblx0ICovXG5cdGZ1bmN0aW9uIGNsZWFuVXBEYXRhKGRhdGEpIHtcblx0ICBpZiAoIShkYXRhIGluc3RhbmNlb2YgVGFnKSAmJiAhKGRhdGEgJiYgdHlwZW9mIGRhdGEudHJpZ2dlciA9PSBUX0ZVTkNUSU9OKSlcblx0ICAgIHJldHVybiBkYXRhXG5cdFxuXHQgIHZhciBvID0ge31cblx0ICBmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xuXHQgICAgaWYgKCFSRVNFUlZFRF9XT1JEU19CTEFDS0xJU1QudGVzdChrZXkpKSBvW2tleV0gPSBkYXRhW2tleV1cblx0ICB9XG5cdCAgcmV0dXJuIG9cblx0fVxuXHRcblx0LyoqXG5cdCAqIFdhbGsgZG93biByZWN1cnNpdmVseSBhbGwgdGhlIGNoaWxkcmVuIHRhZ3Mgc3RhcnRpbmcgZG9tIG5vZGVcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSAgIGRvbSAtIHN0YXJ0aW5nIG5vZGUgd2hlcmUgd2Ugd2lsbCBzdGFydCB0aGUgcmVjdXJzaW9uXG5cdCAqIEBwYXJhbSAgIHsgRnVuY3Rpb24gfSBmbiAtIGNhbGxiYWNrIHRvIHRyYW5zZm9ybSB0aGUgY2hpbGQgbm9kZSBqdXN0IGZvdW5kXG5cdCAqL1xuXHRmdW5jdGlvbiB3YWxrKGRvbSwgZm4pIHtcblx0ICBpZiAoZG9tKSB7XG5cdCAgICAvLyBzdG9wIHRoZSByZWN1cnNpb25cblx0ICAgIGlmIChmbihkb20pID09PSBmYWxzZSkgcmV0dXJuXG5cdCAgICBlbHNlIHtcblx0ICAgICAgZG9tID0gZG9tLmZpcnN0Q2hpbGRcblx0XG5cdCAgICAgIHdoaWxlIChkb20pIHtcblx0ICAgICAgICB3YWxrKGRvbSwgZm4pXG5cdCAgICAgICAgZG9tID0gZG9tLm5leHRTaWJsaW5nXG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBNaW5pbWl6ZSByaXNrOiBvbmx5IHplcm8gb3Igb25lIF9zcGFjZV8gYmV0d2VlbiBhdHRyICYgdmFsdWVcblx0ICogQHBhcmFtICAgeyBTdHJpbmcgfSAgIGh0bWwgLSBodG1sIHN0cmluZyB3ZSB3YW50IHRvIHBhcnNlXG5cdCAqIEBwYXJhbSAgIHsgRnVuY3Rpb24gfSBmbiAtIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGFwcGx5IG9uIGFueSBhdHRyaWJ1dGUgZm91bmRcblx0ICovXG5cdGZ1bmN0aW9uIHdhbGtBdHRyaWJ1dGVzKGh0bWwsIGZuKSB7XG5cdCAgdmFyIG0sXG5cdCAgICByZSA9IC8oWy1cXHddKykgPz0gPyg/OlwiKFteXCJdKil8JyhbXiddKil8KHtbXn1dKn0pKS9nXG5cdFxuXHQgIHdoaWxlIChtID0gcmUuZXhlYyhodG1sKSkge1xuXHQgICAgZm4obVsxXS50b0xvd2VyQ2FzZSgpLCBtWzJdIHx8IG1bM10gfHwgbVs0XSlcblx0ICB9XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDaGVjayB3aGV0aGVyIGEgRE9NIG5vZGUgaXMgaW4gc3R1YiBtb2RlLCB1c2VmdWwgZm9yIHRoZSByaW90ICdpZicgZGlyZWN0aXZlXG5cdCAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gIGRvbSAtIERPTSBub2RlIHdlIHdhbnQgdG8gcGFyc2Vcblx0ICogQHJldHVybnMgeyBCb29sZWFuIH0gLVxuXHQgKi9cblx0ZnVuY3Rpb24gaXNJblN0dWIoZG9tKSB7XG5cdCAgd2hpbGUgKGRvbSkge1xuXHQgICAgaWYgKGRvbS5pblN0dWIpIHJldHVybiB0cnVlXG5cdCAgICBkb20gPSBkb20ucGFyZW50Tm9kZVxuXHQgIH1cblx0ICByZXR1cm4gZmFsc2Vcblx0fVxuXHRcblx0LyoqXG5cdCAqIENyZWF0ZSBhIGdlbmVyaWMgRE9NIG5vZGVcblx0ICogQHBhcmFtICAgeyBTdHJpbmcgfSBuYW1lIC0gbmFtZSBvZiB0aGUgRE9NIG5vZGUgd2Ugd2FudCB0byBjcmVhdGVcblx0ICogQHBhcmFtICAgeyBCb29sZWFuIH0gaXNTdmcgLSBzaG91bGQgd2UgdXNlIGEgU1ZHIGFzIHBhcmVudCBub2RlP1xuXHQgKiBAcmV0dXJucyB7IE9iamVjdCB9IERPTSBub2RlIGp1c3QgY3JlYXRlZFxuXHQgKi9cblx0ZnVuY3Rpb24gbWtFbChuYW1lLCBpc1N2Zykge1xuXHQgIHJldHVybiBpc1N2ZyA/XG5cdCAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpIDpcblx0ICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSlcblx0fVxuXHRcblx0LyoqXG5cdCAqIFNob3J0ZXIgYW5kIGZhc3Qgd2F5IHRvIHNlbGVjdCBtdWx0aXBsZSBub2RlcyBpbiB0aGUgRE9NXG5cdCAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gc2VsZWN0b3IgLSBET00gc2VsZWN0b3Jcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBjdHggLSBET00gbm9kZSB3aGVyZSB0aGUgdGFyZ2V0cyBvZiBvdXIgc2VhcmNoIHdpbGwgaXMgbG9jYXRlZFxuXHQgKiBAcmV0dXJucyB7IE9iamVjdCB9IGRvbSBub2RlcyBmb3VuZFxuXHQgKi9cblx0ZnVuY3Rpb24gJCQoc2VsZWN0b3IsIGN0eCkge1xuXHQgIHJldHVybiAoY3R4IHx8IGRvY3VtZW50KS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKVxuXHR9XG5cdFxuXHQvKipcblx0ICogU2hvcnRlciBhbmQgZmFzdCB3YXkgdG8gc2VsZWN0IGEgc2luZ2xlIG5vZGUgaW4gdGhlIERPTVxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9IHNlbGVjdG9yIC0gdW5pcXVlIGRvbSBzZWxlY3RvclxuXHQgKiBAcGFyYW0gICB7IE9iamVjdCB9IGN0eCAtIERPTSBub2RlIHdoZXJlIHRoZSB0YXJnZXQgb2Ygb3VyIHNlYXJjaCB3aWxsIGlzIGxvY2F0ZWRcblx0ICogQHJldHVybnMgeyBPYmplY3QgfSBkb20gbm9kZSBmb3VuZFxuXHQgKi9cblx0ZnVuY3Rpb24gJChzZWxlY3RvciwgY3R4KSB7XG5cdCAgcmV0dXJuIChjdHggfHwgZG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBTaW1wbGUgb2JqZWN0IHByb3RvdHlwYWwgaW5oZXJpdGFuY2Vcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBwYXJlbnQgLSBwYXJlbnQgb2JqZWN0XG5cdCAqIEByZXR1cm5zIHsgT2JqZWN0IH0gY2hpbGQgaW5zdGFuY2Vcblx0ICovXG5cdGZ1bmN0aW9uIGluaGVyaXQocGFyZW50KSB7XG5cdCAgZnVuY3Rpb24gQ2hpbGQoKSB7fVxuXHQgIENoaWxkLnByb3RvdHlwZSA9IHBhcmVudFxuXHQgIHJldHVybiBuZXcgQ2hpbGQoKVxuXHR9XG5cdFxuXHQvKipcblx0ICogR2V0IHRoZSBuYW1lIHByb3BlcnR5IG5lZWRlZCB0byBpZGVudGlmeSBhIERPTSBub2RlIGluIHJpb3Rcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSBkb20gLSBET00gbm9kZSB3ZSBuZWVkIHRvIHBhcnNlXG5cdCAqIEByZXR1cm5zIHsgU3RyaW5nIHwgdW5kZWZpbmVkIH0gZ2l2ZSB1cyBiYWNrIGEgc3RyaW5nIHRvIGlkZW50aWZ5IHRoaXMgZG9tIG5vZGVcblx0ICovXG5cdGZ1bmN0aW9uIGdldE5hbWVkS2V5KGRvbSkge1xuXHQgIHJldHVybiBnZXRBdHRyKGRvbSwgJ2lkJykgfHwgZ2V0QXR0cihkb20sICduYW1lJylcblx0fVxuXHRcblx0LyoqXG5cdCAqIFNldCB0aGUgbmFtZWQgcHJvcGVydGllcyBvZiBhIHRhZyBlbGVtZW50XG5cdCAqIEBwYXJhbSB7IE9iamVjdCB9IGRvbSAtIERPTSBub2RlIHdlIG5lZWQgdG8gcGFyc2Vcblx0ICogQHBhcmFtIHsgT2JqZWN0IH0gcGFyZW50IC0gdGFnIGluc3RhbmNlIHdoZXJlIHRoZSBuYW1lZCBkb20gZWxlbWVudCB3aWxsIGJlIGV2ZW50dWFsbHkgYWRkZWRcblx0ICogQHBhcmFtIHsgQXJyYXkgfSBrZXlzIC0gbGlzdCBvZiBhbGwgdGhlIHRhZyBpbnN0YW5jZSBwcm9wZXJ0aWVzXG5cdCAqL1xuXHRmdW5jdGlvbiBzZXROYW1lZChkb20sIHBhcmVudCwga2V5cykge1xuXHQgIC8vIGdldCB0aGUga2V5IHZhbHVlIHdlIHdhbnQgdG8gYWRkIHRvIHRoZSB0YWcgaW5zdGFuY2Vcblx0ICB2YXIga2V5ID0gZ2V0TmFtZWRLZXkoZG9tKSxcblx0ICAgIGlzQXJyLFxuXHQgICAgLy8gYWRkIHRoZSBub2RlIGRldGVjdGVkIHRvIGEgdGFnIGluc3RhbmNlIHVzaW5nIHRoZSBuYW1lZCBwcm9wZXJ0eVxuXHQgICAgYWRkID0gZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgLy8gYXZvaWQgdG8gb3ZlcnJpZGUgdGhlIHRhZyBwcm9wZXJ0aWVzIGFscmVhZHkgc2V0XG5cdCAgICAgIGlmIChjb250YWlucyhrZXlzLCBrZXkpKSByZXR1cm5cblx0ICAgICAgLy8gY2hlY2sgd2hldGhlciB0aGlzIHZhbHVlIGlzIGFuIGFycmF5XG5cdCAgICAgIGlzQXJyID0gaXNBcnJheSh2YWx1ZSlcblx0ICAgICAgLy8gaWYgdGhlIGtleSB3YXMgbmV2ZXIgc2V0XG5cdCAgICAgIGlmICghdmFsdWUpXG5cdCAgICAgICAgLy8gc2V0IGl0IG9uY2Ugb24gdGhlIHRhZyBpbnN0YW5jZVxuXHQgICAgICAgIHBhcmVudFtrZXldID0gZG9tXG5cdCAgICAgIC8vIGlmIGl0IHdhcyBhbiBhcnJheSBhbmQgbm90IHlldCBzZXRcblx0ICAgICAgZWxzZSBpZiAoIWlzQXJyIHx8IGlzQXJyICYmICFjb250YWlucyh2YWx1ZSwgZG9tKSkge1xuXHQgICAgICAgIC8vIGFkZCB0aGUgZG9tIG5vZGUgaW50byB0aGUgYXJyYXlcblx0ICAgICAgICBpZiAoaXNBcnIpXG5cdCAgICAgICAgICB2YWx1ZS5wdXNoKGRvbSlcblx0ICAgICAgICBlbHNlXG5cdCAgICAgICAgICBwYXJlbnRba2V5XSA9IFt2YWx1ZSwgZG9tXVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgIC8vIHNraXAgdGhlIGVsZW1lbnRzIHdpdGggbm8gbmFtZWQgcHJvcGVydGllc1xuXHQgIGlmICgha2V5KSByZXR1cm5cblx0XG5cdCAgLy8gY2hlY2sgd2hldGhlciB0aGlzIGtleSBoYXMgYmVlbiBhbHJlYWR5IGV2YWx1YXRlZFxuXHQgIGlmICh0bXBsLmhhc0V4cHIoa2V5KSlcblx0ICAgIC8vIHdhaXQgdGhlIGZpcnN0IHVwZGF0ZWQgZXZlbnQgb25seSBvbmNlXG5cdCAgICBwYXJlbnQub25lKCdtb3VudCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICBrZXkgPSBnZXROYW1lZEtleShkb20pXG5cdCAgICAgIGFkZChwYXJlbnRba2V5XSlcblx0ICAgIH0pXG5cdCAgZWxzZVxuXHQgICAgYWRkKHBhcmVudFtrZXldKVxuXHRcblx0fVxuXHRcblx0LyoqXG5cdCAqIEZhc3RlciBTdHJpbmcgc3RhcnRzV2l0aCBhbHRlcm5hdGl2ZVxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9IHNyYyAtIHNvdXJjZSBzdHJpbmdcblx0ICogQHBhcmFtICAgeyBTdHJpbmcgfSBzdHIgLSB0ZXN0IHN0cmluZ1xuXHQgKiBAcmV0dXJucyB7IEJvb2xlYW4gfSAtXG5cdCAqL1xuXHRmdW5jdGlvbiBzdGFydHNXaXRoKHNyYywgc3RyKSB7XG5cdCAgcmV0dXJuIHNyYy5zbGljZSgwLCBzdHIubGVuZ3RoKSA9PT0gc3RyXG5cdH1cblx0XG5cdC8qKlxuXHQgKiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgZnVuY3Rpb25cblx0ICogQWRhcHRlZCBmcm9tIGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL3BhdWxpcmlzaC8xNTc5NjcxLCBsaWNlbnNlIE1JVFxuXHQgKi9cblx0dmFyIHJBRiA9IChmdW5jdGlvbiAodykge1xuXHQgIHZhciByYWYgPSB3LnJlcXVlc3RBbmltYXRpb25GcmFtZSAgICB8fFxuXHQgICAgICAgICAgICB3Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZVxuXHRcblx0ICBpZiAoIXJhZiB8fCAvaVAoYWR8aG9uZXxvZCkuKk9TIDYvLnRlc3Qody5uYXZpZ2F0b3IudXNlckFnZW50KSkgeyAgLy8gYnVnZ3kgaU9TNlxuXHQgICAgdmFyIGxhc3RUaW1lID0gMFxuXHRcblx0ICAgIHJhZiA9IGZ1bmN0aW9uIChjYikge1xuXHQgICAgICB2YXIgbm93dGltZSA9IERhdGUubm93KCksIHRpbWVvdXQgPSBNYXRoLm1heCgxNiAtIChub3d0aW1lIC0gbGFzdFRpbWUpLCAwKVxuXHQgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgY2IobGFzdFRpbWUgPSBub3d0aW1lICsgdGltZW91dCkgfSwgdGltZW91dClcblx0ICAgIH1cblx0ICB9XG5cdCAgcmV0dXJuIHJhZlxuXHRcblx0fSkod2luZG93IHx8IHt9KVxuXHRcblx0LyoqXG5cdCAqIE1vdW50IGEgdGFnIGNyZWF0aW5nIG5ldyBUYWcgaW5zdGFuY2Vcblx0ICogQHBhcmFtICAgeyBPYmplY3QgfSByb290IC0gZG9tIG5vZGUgd2hlcmUgdGhlIHRhZyB3aWxsIGJlIG1vdW50ZWRcblx0ICogQHBhcmFtICAgeyBTdHJpbmcgfSB0YWdOYW1lIC0gbmFtZSBvZiB0aGUgcmlvdCB0YWcgd2Ugd2FudCB0byBtb3VudFxuXHQgKiBAcGFyYW0gICB7IE9iamVjdCB9IG9wdHMgLSBvcHRpb25zIHRvIHBhc3MgdG8gdGhlIFRhZyBpbnN0YW5jZVxuXHQgKiBAcmV0dXJucyB7IFRhZyB9IGEgbmV3IFRhZyBpbnN0YW5jZVxuXHQgKi9cblx0ZnVuY3Rpb24gbW91bnRUbyhyb290LCB0YWdOYW1lLCBvcHRzKSB7XG5cdCAgdmFyIHRhZyA9IF9fdGFnSW1wbFt0YWdOYW1lXSxcblx0ICAgIC8vIGNhY2hlIHRoZSBpbm5lciBIVE1MIHRvIGZpeCAjODU1XG5cdCAgICBpbm5lckhUTUwgPSByb290Ll9pbm5lckhUTUwgPSByb290Ll9pbm5lckhUTUwgfHwgcm9vdC5pbm5lckhUTUxcblx0XG5cdCAgLy8gY2xlYXIgdGhlIGlubmVyIGh0bWxcblx0ICByb290LmlubmVySFRNTCA9ICcnXG5cdFxuXHQgIGlmICh0YWcgJiYgcm9vdCkgdGFnID0gbmV3IFRhZyh0YWcsIHsgcm9vdDogcm9vdCwgb3B0czogb3B0cyB9LCBpbm5lckhUTUwpXG5cdFxuXHQgIGlmICh0YWcgJiYgdGFnLm1vdW50KSB7XG5cdCAgICB0YWcubW91bnQoKVxuXHQgICAgLy8gYWRkIHRoaXMgdGFnIHRvIHRoZSB2aXJ0dWFsRG9tIHZhcmlhYmxlXG5cdCAgICBpZiAoIWNvbnRhaW5zKF9fdmlydHVhbERvbSwgdGFnKSkgX192aXJ0dWFsRG9tLnB1c2godGFnKVxuXHQgIH1cblx0XG5cdCAgcmV0dXJuIHRhZ1xuXHR9XG5cdC8qKlxuXHQgKiBSaW90IHB1YmxpYyBhcGlcblx0ICovXG5cdFxuXHQvLyBzaGFyZSBtZXRob2RzIGZvciBvdGhlciByaW90IHBhcnRzLCBlLmcuIGNvbXBpbGVyXG5cdHJpb3QudXRpbCA9IHsgYnJhY2tldHM6IGJyYWNrZXRzLCB0bXBsOiB0bXBsIH1cblx0XG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBtaXhpbiB0aGF0IGNvdWxkIGJlIGdsb2JhbGx5IHNoYXJlZCBhY3Jvc3MgYWxsIHRoZSB0YWdzXG5cdCAqL1xuXHRyaW90Lm1peGluID0gKGZ1bmN0aW9uKCkge1xuXHQgIHZhciBtaXhpbnMgPSB7fSxcblx0ICAgIGdsb2JhbHMgPSBtaXhpbnNbR0xPQkFMX01JWElOXSA9IHt9LFxuXHQgICAgX2lkID0gMFxuXHRcblx0ICAvKipcblx0ICAgKiBDcmVhdGUvUmV0dXJuIGEgbWl4aW4gYnkgaXRzIG5hbWVcblx0ICAgKiBAcGFyYW0gICB7IFN0cmluZyB9ICBuYW1lIC0gbWl4aW4gbmFtZSAoZ2xvYmFsIG1peGluIGlmIG9iamVjdClcblx0ICAgKiBAcGFyYW0gICB7IE9iamVjdCB9ICBtaXhpbiAtIG1peGluIGxvZ2ljXG5cdCAgICogQHBhcmFtICAgeyBCb29sZWFuIH0gZyAtIGlzIGdsb2JhbD9cblx0ICAgKiBAcmV0dXJucyB7IE9iamVjdCB9ICB0aGUgbWl4aW4gbG9naWNcblx0ICAgKi9cblx0ICByZXR1cm4gZnVuY3Rpb24obmFtZSwgbWl4aW4sIGcpIHtcblx0ICAgIC8vIFVubmFtZWQgZ2xvYmFsXG5cdCAgICBpZiAoaXNPYmplY3QobmFtZSkpIHtcblx0ICAgICAgcmlvdC5taXhpbignX191bm5hbWVkXycrX2lkKyssIG5hbWUsIHRydWUpXG5cdCAgICAgIHJldHVyblxuXHQgICAgfVxuXHRcblx0ICAgIHZhciBzdG9yZSA9IGcgPyBnbG9iYWxzIDogbWl4aW5zXG5cdFxuXHQgICAgLy8gR2V0dGVyXG5cdCAgICBpZiAoIW1peGluKSB7XG5cdCAgICAgIGlmICh0eXBlb2Ygc3RvcmVbbmFtZV0gPT09IFRfVU5ERUYpIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VucmVnaXN0ZXJlZCBtaXhpbjogJyArIG5hbWUpXG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIHN0b3JlW25hbWVdXG5cdCAgICB9XG5cdCAgICAvLyBTZXR0ZXJcblx0ICAgIGlmIChpc0Z1bmN0aW9uKG1peGluKSkge1xuXHQgICAgICBleHRlbmQobWl4aW4ucHJvdG90eXBlLCBzdG9yZVtuYW1lXSB8fCB7fSlcblx0ICAgICAgc3RvcmVbbmFtZV0gPSBtaXhpblxuXHQgICAgfVxuXHQgICAgZWxzZSB7XG5cdCAgICAgIHN0b3JlW25hbWVdID0gZXh0ZW5kKHN0b3JlW25hbWVdIHx8IHt9LCBtaXhpbilcblx0ICAgIH1cblx0ICB9XG5cdFxuXHR9KSgpXG5cdFxuXHQvKipcblx0ICogQ3JlYXRlIGEgbmV3IHJpb3QgdGFnIGltcGxlbWVudGF0aW9uXG5cdCAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gICBuYW1lIC0gbmFtZS9pZCBvZiB0aGUgbmV3IHJpb3QgdGFnXG5cdCAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gICBodG1sIC0gdGFnIHRlbXBsYXRlXG5cdCAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gICBjc3MgLSBjdXN0b20gdGFnIGNzc1xuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9ICAgYXR0cnMgLSByb290IHRhZyBhdHRyaWJ1dGVzXG5cdCAqIEBwYXJhbSAgIHsgRnVuY3Rpb24gfSBmbiAtIHVzZXIgZnVuY3Rpb25cblx0ICogQHJldHVybnMgeyBTdHJpbmcgfSBuYW1lL2lkIG9mIHRoZSB0YWcganVzdCBjcmVhdGVkXG5cdCAqL1xuXHRyaW90LnRhZyA9IGZ1bmN0aW9uKG5hbWUsIGh0bWwsIGNzcywgYXR0cnMsIGZuKSB7XG5cdCAgaWYgKGlzRnVuY3Rpb24oYXR0cnMpKSB7XG5cdCAgICBmbiA9IGF0dHJzXG5cdCAgICBpZiAoL15bXFx3XFwtXStcXHM/PS8udGVzdChjc3MpKSB7XG5cdCAgICAgIGF0dHJzID0gY3NzXG5cdCAgICAgIGNzcyA9ICcnXG5cdCAgICB9IGVsc2UgYXR0cnMgPSAnJ1xuXHQgIH1cblx0ICBpZiAoY3NzKSB7XG5cdCAgICBpZiAoaXNGdW5jdGlvbihjc3MpKSBmbiA9IGNzc1xuXHQgICAgZWxzZSBzdHlsZU1hbmFnZXIuYWRkKGNzcylcblx0ICB9XG5cdCAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKVxuXHQgIF9fdGFnSW1wbFtuYW1lXSA9IHsgbmFtZTogbmFtZSwgdG1wbDogaHRtbCwgYXR0cnM6IGF0dHJzLCBmbjogZm4gfVxuXHQgIHJldHVybiBuYW1lXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBuZXcgcmlvdCB0YWcgaW1wbGVtZW50YXRpb24gKGZvciB1c2UgYnkgdGhlIGNvbXBpbGVyKVxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9ICAgbmFtZSAtIG5hbWUvaWQgb2YgdGhlIG5ldyByaW90IHRhZ1xuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9ICAgaHRtbCAtIHRhZyB0ZW1wbGF0ZVxuXHQgKiBAcGFyYW0gICB7IFN0cmluZyB9ICAgY3NzIC0gY3VzdG9tIHRhZyBjc3Ncblx0ICogQHBhcmFtICAgeyBTdHJpbmcgfSAgIGF0dHJzIC0gcm9vdCB0YWcgYXR0cmlidXRlc1xuXHQgKiBAcGFyYW0gICB7IEZ1bmN0aW9uIH0gZm4gLSB1c2VyIGZ1bmN0aW9uXG5cdCAqIEByZXR1cm5zIHsgU3RyaW5nIH0gbmFtZS9pZCBvZiB0aGUgdGFnIGp1c3QgY3JlYXRlZFxuXHQgKi9cblx0cmlvdC50YWcyID0gZnVuY3Rpb24obmFtZSwgaHRtbCwgY3NzLCBhdHRycywgZm4pIHtcblx0ICBpZiAoY3NzKSBzdHlsZU1hbmFnZXIuYWRkKGNzcylcblx0ICAvL2lmIChicGFpcikgcmlvdC5zZXR0aW5ncy5icmFja2V0cyA9IGJwYWlyXG5cdCAgX190YWdJbXBsW25hbWVdID0geyBuYW1lOiBuYW1lLCB0bXBsOiBodG1sLCBhdHRyczogYXR0cnMsIGZuOiBmbiB9XG5cdCAgcmV0dXJuIG5hbWVcblx0fVxuXHRcblx0LyoqXG5cdCAqIE1vdW50IGEgdGFnIHVzaW5nIGEgc3BlY2lmaWMgdGFnIGltcGxlbWVudGF0aW9uXG5cdCAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gc2VsZWN0b3IgLSB0YWcgRE9NIHNlbGVjdG9yXG5cdCAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gdGFnTmFtZSAtIHRhZyBpbXBsZW1lbnRhdGlvbiBuYW1lXG5cdCAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gb3B0cyAtIHRhZyBsb2dpY1xuXHQgKiBAcmV0dXJucyB7IEFycmF5IH0gbmV3IHRhZ3MgaW5zdGFuY2VzXG5cdCAqL1xuXHRyaW90Lm1vdW50ID0gZnVuY3Rpb24oc2VsZWN0b3IsIHRhZ05hbWUsIG9wdHMpIHtcblx0XG5cdCAgdmFyIGVscyxcblx0ICAgIGFsbFRhZ3MsXG5cdCAgICB0YWdzID0gW11cblx0XG5cdCAgLy8gaGVscGVyIGZ1bmN0aW9uc1xuXHRcblx0ICBmdW5jdGlvbiBhZGRSaW90VGFncyhhcnIpIHtcblx0ICAgIHZhciBsaXN0ID0gJydcblx0ICAgIGVhY2goYXJyLCBmdW5jdGlvbiAoZSkge1xuXHQgICAgICBpZiAoIS9bXi1cXHddLy50ZXN0KGUpKSB7XG5cdCAgICAgICAgZSA9IGUudHJpbSgpLnRvTG93ZXJDYXNlKClcblx0ICAgICAgICBsaXN0ICs9ICcsWycgKyBSSU9UX1RBR19JUyArICc9XCInICsgZSArICdcIl0sWycgKyBSSU9UX1RBRyArICc9XCInICsgZSArICdcIl0nXG5cdCAgICAgIH1cblx0ICAgIH0pXG5cdCAgICByZXR1cm4gbGlzdFxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gc2VsZWN0QWxsVGFncygpIHtcblx0ICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoX190YWdJbXBsKVxuXHQgICAgcmV0dXJuIGtleXMgKyBhZGRSaW90VGFncyhrZXlzKVxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gcHVzaFRhZ3Mocm9vdCkge1xuXHQgICAgaWYgKHJvb3QudGFnTmFtZSkge1xuXHQgICAgICB2YXIgcmlvdFRhZyA9IGdldEF0dHIocm9vdCwgUklPVF9UQUdfSVMpIHx8IGdldEF0dHIocm9vdCwgUklPVF9UQUcpXG5cdFxuXHQgICAgICAvLyBoYXZlIHRhZ05hbWU/IGZvcmNlIHJpb3QtdGFnIHRvIGJlIHRoZSBzYW1lXG5cdCAgICAgIGlmICh0YWdOYW1lICYmIHJpb3RUYWcgIT09IHRhZ05hbWUpIHtcblx0ICAgICAgICByaW90VGFnID0gdGFnTmFtZVxuXHQgICAgICAgIHNldEF0dHIocm9vdCwgUklPVF9UQUdfSVMsIHRhZ05hbWUpXG5cdCAgICAgICAgc2V0QXR0cihyb290LCBSSU9UX1RBRywgdGFnTmFtZSkgLy8gdGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gcmlvdCAzLjAuMFxuXHQgICAgICB9XG5cdCAgICAgIHZhciB0YWcgPSBtb3VudFRvKHJvb3QsIHJpb3RUYWcgfHwgcm9vdC50YWdOYW1lLnRvTG93ZXJDYXNlKCksIG9wdHMpXG5cdFxuXHQgICAgICBpZiAodGFnKSB0YWdzLnB1c2godGFnKVxuXHQgICAgfSBlbHNlIGlmIChyb290Lmxlbmd0aCkge1xuXHQgICAgICBlYWNoKHJvb3QsIHB1c2hUYWdzKSAgIC8vIGFzc3VtZSBub2RlTGlzdFxuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgLy8gLS0tLS0gbW91bnQgY29kZSAtLS0tLVxuXHRcblx0ICAvLyBpbmplY3Qgc3R5bGVzIGludG8gRE9NXG5cdCAgc3R5bGVNYW5hZ2VyLmluamVjdCgpXG5cdFxuXHQgIGlmIChpc09iamVjdCh0YWdOYW1lKSkge1xuXHQgICAgb3B0cyA9IHRhZ05hbWVcblx0ICAgIHRhZ05hbWUgPSAwXG5cdCAgfVxuXHRcblx0ICAvLyBjcmF3bCB0aGUgRE9NIHRvIGZpbmQgdGhlIHRhZ1xuXHQgIGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09IFRfU1RSSU5HKSB7XG5cdCAgICBpZiAoc2VsZWN0b3IgPT09ICcqJylcblx0ICAgICAgLy8gc2VsZWN0IGFsbCB0aGUgdGFncyByZWdpc3RlcmVkXG5cdCAgICAgIC8vIGFuZCBhbHNvIHRoZSB0YWdzIGZvdW5kIHdpdGggdGhlIHJpb3QtdGFnIGF0dHJpYnV0ZSBzZXRcblx0ICAgICAgc2VsZWN0b3IgPSBhbGxUYWdzID0gc2VsZWN0QWxsVGFncygpXG5cdCAgICBlbHNlXG5cdCAgICAgIC8vIG9yIGp1c3QgdGhlIG9uZXMgbmFtZWQgbGlrZSB0aGUgc2VsZWN0b3Jcblx0ICAgICAgc2VsZWN0b3IgKz0gYWRkUmlvdFRhZ3Moc2VsZWN0b3Iuc3BsaXQoLywgKi8pKVxuXHRcblx0ICAgIC8vIG1ha2Ugc3VyZSB0byBwYXNzIGFsd2F5cyBhIHNlbGVjdG9yXG5cdCAgICAvLyB0byB0aGUgcXVlcnlTZWxlY3RvckFsbCBmdW5jdGlvblxuXHQgICAgZWxzID0gc2VsZWN0b3IgPyAkJChzZWxlY3RvcikgOiBbXVxuXHQgIH1cblx0ICBlbHNlXG5cdCAgICAvLyBwcm9iYWJseSB5b3UgaGF2ZSBwYXNzZWQgYWxyZWFkeSBhIHRhZyBvciBhIE5vZGVMaXN0XG5cdCAgICBlbHMgPSBzZWxlY3RvclxuXHRcblx0ICAvLyBzZWxlY3QgYWxsIHRoZSByZWdpc3RlcmVkIGFuZCBtb3VudCB0aGVtIGluc2lkZSB0aGVpciByb290IGVsZW1lbnRzXG5cdCAgaWYgKHRhZ05hbWUgPT09ICcqJykge1xuXHQgICAgLy8gZ2V0IGFsbCBjdXN0b20gdGFnc1xuXHQgICAgdGFnTmFtZSA9IGFsbFRhZ3MgfHwgc2VsZWN0QWxsVGFncygpXG5cdCAgICAvLyBpZiB0aGUgcm9vdCBlbHMgaXQncyBqdXN0IGEgc2luZ2xlIHRhZ1xuXHQgICAgaWYgKGVscy50YWdOYW1lKVxuXHQgICAgICBlbHMgPSAkJCh0YWdOYW1lLCBlbHMpXG5cdCAgICBlbHNlIHtcblx0ICAgICAgLy8gc2VsZWN0IGFsbCB0aGUgY2hpbGRyZW4gZm9yIGFsbCB0aGUgZGlmZmVyZW50IHJvb3QgZWxlbWVudHNcblx0ICAgICAgdmFyIG5vZGVMaXN0ID0gW11cblx0ICAgICAgZWFjaChlbHMsIGZ1bmN0aW9uIChfZWwpIHtcblx0ICAgICAgICBub2RlTGlzdC5wdXNoKCQkKHRhZ05hbWUsIF9lbCkpXG5cdCAgICAgIH0pXG5cdCAgICAgIGVscyA9IG5vZGVMaXN0XG5cdCAgICB9XG5cdCAgICAvLyBnZXQgcmlkIG9mIHRoZSB0YWdOYW1lXG5cdCAgICB0YWdOYW1lID0gMFxuXHQgIH1cblx0XG5cdCAgcHVzaFRhZ3MoZWxzKVxuXHRcblx0ICByZXR1cm4gdGFnc1xuXHR9XG5cdFxuXHQvKipcblx0ICogVXBkYXRlIGFsbCB0aGUgdGFncyBpbnN0YW5jZXMgY3JlYXRlZFxuXHQgKiBAcmV0dXJucyB7IEFycmF5IH0gYWxsIHRoZSB0YWdzIGluc3RhbmNlc1xuXHQgKi9cblx0cmlvdC51cGRhdGUgPSBmdW5jdGlvbigpIHtcblx0ICByZXR1cm4gZWFjaChfX3ZpcnR1YWxEb20sIGZ1bmN0aW9uKHRhZykge1xuXHQgICAgdGFnLnVwZGF0ZSgpXG5cdCAgfSlcblx0fVxuXHRcblx0LyoqXG5cdCAqIEV4cG9ydCB0aGUgVmlydHVhbCBET01cblx0ICovXG5cdHJpb3QudmRvbSA9IF9fdmlydHVhbERvbVxuXHRcblx0LyoqXG5cdCAqIEV4cG9ydCB0aGUgVGFnIGNvbnN0cnVjdG9yXG5cdCAqL1xuXHRyaW90LlRhZyA9IFRhZ1xuXHQgIC8vIHN1cHBvcnQgQ29tbW9uSlMsIEFNRCAmIGJyb3dzZXJcblx0ICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuXHQgIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gVF9PQkpFQ1QpXG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IHJpb3Rcblx0ICBlbHNlIGlmIChcImZ1bmN0aW9uXCIgPT09IFRfRlVOQ1RJT04gJiYgdHlwZW9mIF9fd2VicGFja19yZXF1aXJlX18oMykgIT09IFRfVU5ERUYpXG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oKSB7IHJldHVybiByaW90IH0uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fLCBleHBvcnRzLCBtb2R1bGUpLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSlcblx0ICBlbHNlXG5cdCAgICB3aW5kb3cucmlvdCA9IHJpb3Rcblx0XG5cdH0pKHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB2b2lkIDApO1xuXG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oX193ZWJwYWNrX2FtZF9vcHRpb25zX18pIHttb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19hbWRfb3B0aW9uc19fO1xyXG5cdFxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywge30pKVxuXG4vKioqLyB9LFxuLyogNCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKHJpb3QpIHsndXNlIHN0cmljdCc7XG5cdFxuXHR2YXIgX21vZHVsZSA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG5cdFxuXHRyaW90LnRhZzIoJ25hbWUnLCAnPGgxPk5hbWUge25hbWV9IHtvcHRzLmxhc3R9LCB7b3B0cy5maXJzdH0gOiB7Y291bnR9PC9oMT4gPGZvbz4gPGJ1dHRvbiBvbmNsaWNrPVwie2NsaWNrfVwiPkNvdW50PC9idXR0b24+JywgJycsICcnLCBmdW5jdGlvbiAob3B0cykge1xuXHQgICAgdmFyIF90aGlzID0gdGhpcztcblx0XG5cdCAgICB0aGlzLm5hbWUgPSBfbW9kdWxlLm5hbWU7XG5cdFxuXHQgICAgdGhpcy5jb3VudCA9IDA7XG5cdFxuXHQgICAgdGhpcy5jbGljayA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBfdGhpcy5jb3VudCsrO1xuXHQgICAgfTtcblx0fSk7XG5cdFxuXHRyaW90LnRhZzIoJ2ZvbycsICc8aDI+cmVxdWlyZWQge25hbWV9PC9oMj4nLCAnJywgJycsIGZ1bmN0aW9uIChvcHRzKSB7XG5cdCAgICB2YXIgbW9kdWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblx0XG5cdCAgICB0aGlzLm5hbWUgPSBtb2R1bGUubmFtZTtcblx0fSk7XG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKSlcblxuLyoqKi8gfSxcbi8qIDUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdG1vZHVsZS5leHBvcnRzID0ge1xuXHQgIG5hbWU6ICd0aGlzIGlzIGFuIGltcG9ydGVkIG1vZHVsZSdcblx0fTtcblxuLyoqKi8gfSxcbi8qIDYgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihyaW90KSB7J3VzZSBzdHJpY3QnO1xuXHRcblx0cmlvdC50YWcyKCdsb2FuJywgJzxoMz5Mb2FuIHtuYW1lfTwvaDM+IDxpbnB1dCB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiTmFtZVwiIHZhbHVlPVwie2xvYW4udGl0bGV9XCIgb25jaGFuZ2U9XCJ7cmVmcmVzaH1cIj4gPGlucHV0IHZhbHVlPVwie2xvYW4uYW1vdW50fVwiIG9uY2hhbmdlPVwie3JlZnJlc2h9XCIgdHlwZT1cIntcXCdudW1iZXJcXCd9XCI+JywgJycsICcnLCBmdW5jdGlvbiAob3B0cykge1xuXHQgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgIHRoaXMubG9hbiA9IHRoaXMub3B0cy5sb2FuO1xuXHRcblx0ICB0aGlzLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBfdGhpcy51cGRhdGUoKTtcblx0ICB9O1xuXHR9KTtcblx0XG5cdHJpb3QudGFnMignbG9hbnMnLCAnPGgyPnt0aXRsZX08L2gyPiA8YnV0dG9uIG9uY2xpY2s9XCJ7YWRkfVwiPkFkZDwvYnV0dG9uPiA8bG9hbiBlYWNoPVwie2xvYW4gaW4gbG9hbnN9XCIgbG9hbj1cIntsb2FufVwiPjwvbG9hbj4nLCAnJywgJycsIGZ1bmN0aW9uIChvcHRzKSB7XG5cdCAgdmFyIF90aGlzMiA9IHRoaXM7XG5cdFxuXHQgIHRoaXMuYWRkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgX3RoaXMyLmxvYW5zLnVuc2hpZnQoe30pO1xuXHQgIH07XG5cdCAgdGhpcy5sb2FucyA9IFtdO1xuXHQgIHRoaXMudGl0bGUgPSAnTG9hbnMnO1xuXHR9KTtcblx0XG5cdHJpb3QudGFnMignYXBwbGljYXRpb24nLCAnPGgxPnt0aXRsZX08L2gxPiA8bG9hbnM+PC9sb2Fucz4gPGgxPntmb28oKX08L2gxPicsICcnLCAnJywgZnVuY3Rpb24gKG9wdHMpIHtcblx0ICB0aGlzLnRpdGxlID0gJ0NvbnNvbGlkYXRlJztcblx0XG5cdCAgdGhpcy5mb28gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gJ2Jhcic7XG5cdCAgfTtcblx0fSk7XG5cdFxuXHRyaW90LnRhZzIoJ2RlYnQtbGlzdCcsICc8aDE+RGVidHM8L2gxPiA8ZGl2IGVhY2g9XCJ7ZGVidCBpbiBkZWJ0c31cIj4gPGNhcmQgaGVhZGluZz1cIntkZWJ0Lm5hbWV9XCI+IDxoMz5BbW91bnQ6ICR7ZGVidC5yZW1haW5pbmd9PC9oMz4gPGlucHV0IG9ua2V5dXA9XCJ7dXBkYXRlTmFtZS5iaW5kKGRlYnQpfVwiIHZhbHVlPVwie2RlYnQubmFtZX1cIiBwbGFjZWhvbGRlcj1cIk5hbWVcIiB0eXBlPVwidGV4dFwiPiA8L2lucHV0PiA8aW5wdXQgb25rZXl1cD1cInt1cGRhdGVPdXRzYW5kaW5nLmJpbmQoZGVidCl9XCIgdmFsdWU9XCJ7ZGVidC5yZW1haW5pbmd9XCIgcGxhY2Vob2xkZXI9XCJvdXRzdGFuZGluZyBkZWJ0IChpbiBkb2xsYXJzKVwiIHN0ZXA9XCIwLjAxXCIgbWluPVwiMC4wMVwiIHR5cGU9XCJ7XFwnbnVtYmVyXFwnfVwiPiA8ZGl2IHByZWZpeD4kJm5ic3A7PC9kaXY+IDwvaW5wdXQ+IDxkaXY+VXNlIHJlcGF5bWVudHM/IHtkZWJ0LnVzZVJlcGF5bWVudHN9PC9kaXY+IDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBvbmNoYW5nZT1cInt0b2dnbGVSZXBheW1lbnRzLmJpbmQobnVsbCwgZGVidCl9XCI+VXNlIFJlcGF5bWVudHM8L2lucHV0PiA8bGlzdGJveD4gPGRpdiBlYWNoPVwie3JlcGF5bWVudCBpbiBkZWJ0LnJlcGF5bWVudHN9XCI+IDxpdGVtPntyZXBheW1lbnR9PC9pdGVtPiA8L2Rpdj4gPC9saXN0Ym94PiA8YnV0dG9uIG9uY2xpY2s9XCJ7YWRkUmVwYXltZW50fVwiPkFkZCBSZXBheW1lbnQ8L2J1dHRvbj4gPGJ1dHRvbiBvbmNsaWNrPVwie3JlbW92ZX1cIj5SZW1vdmUgRGVidDwvYnV0dG9uPiA8L2NhcmQ+IDwvdGVtcGxhdGU+IDxkaXY+IDxidXR0b24gb25jbGljaz1cInthZGR9XCI+QWRkIE5ldyBEZWJ0PC9idXR0b24+IDwvZGl2PicsICc6aG9zdCB7IGRpc3BsYXk6IGJsb2NrOyBwYWRkaW5nOiAxNnB4OyB9JywgJycsIGZ1bmN0aW9uIChvcHRzKSB7XG5cdCAgdmFyIF90aGlzMyA9IHRoaXM7XG5cdFxuXHQgIC8vVE9ETzogdXNlIGZsdXggKHJpb3QtY29udHJvbC9mbHV4KSBpbnN0ZWFkXG5cdCAgdGhpcy51cGRhdGVPdXRzYW5kaW5nID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgIF90aGlzMy5yZW1haW5pbmcgPSBwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKTtcblx0ICAgIF90aGlzMy51cGRhdGUoKTtcblx0ICB9O1xuXHQgIHRoaXMudXBkYXRlTmFtZSA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICBfdGhpczMubmFtZSA9IGUudGFyZ2V0LnZhbHVlO1xuXHQgICAgX3RoaXMzLnVwZGF0ZSgpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBpbml0aWFsRGVidCA9IDA7XG5cdCAgdmFyIGluaXRpYWxUb3RhbERlYnQgPSAwO1xuXHRcblx0ICB0aGlzLnRvdGFsID0gaW5pdGlhbFRvdGFsRGVidDtcblx0ICB0aGlzLmRlYnRzID0gW3tcblx0ICAgIG5hbWU6ICdGYWtlIERlYnQnLFxuXHQgICAgcmVtYWluaW5nOiBpbml0aWFsRGVidCxcblx0ICAgIHVzZVJlcGF5bWVudHM6IHRydWUsXG5cdCAgICByZXBheW1lbnRzOiBbXVxuXHQgIH1dO1xuXHRcblx0ICAvLyBvYnNlcnZlcnM6IFtcblx0ICAvLyAgICdkZWJ0c0NoYW5nZWQoZGVidHMuKiknXG5cdCAgLy8gXSxcblx0XG5cdCAgdGhpcy50b2dnbGVSZXBheW1lbnRzID0gZnVuY3Rpb24gKGRlYnQpIHtcblx0ICAgIGRlYnQudXNlUmVwYXltZW50cyA9ICFkZWJ0LnVzZVJlcGF5bWVudHM7XG5cdCAgICBfdGhpczMudXBkYXRlKCk7XG5cdCAgfTtcblx0XG5cdCAgLy8gYWRkUmVwYXltZW50OiBmdW5jdGlvbihlKSB7XG5cdCAgLy8gICAvL1RPRE86IGFkZCByZXBheW1lbnRcblx0ICAvLyB9LFxuXHRcblx0ICB0aGlzLmFkZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBfdGhpczMkZGVidHMkcHVzaDtcblx0XG5cdCAgICAvL1RPRE86IHJlZmFjdG9yIHRvICdmbHV4JyBtb2RlbFxuXHQgICAgLy8gICogZGVidHMgZ2V0IHBhc3NlZCB0byBjb21wb25lbnQgdmlhIG9wdHNcblx0ICAgIC8vICAqIGNvbXBvbmVudCBjb21tdW5pY2F0ZXMgZGVzaXJlIHRvIHVwZGF0ZSBtb2RlbCBieSBmaXJpbmcgZXZlbnRzIHRvIGFuIG9ic2VydmVyXG5cdCAgICAvLyAgKiBvYnNlcnZlciB1cGRhdGVzIHRoZSByb290IHN0YXRlIHdoaWNoIGlzIHVzZWQgYXMgb3B0cyBhbmQgdHJpZ2dlcnMgdXBkYXRlcyB3aGVyZSBuZWNlc3Nhcnlcblx0ICAgIC8vICAqIG5vIGZ1cnRoZXIgZXZlbnRzIGNhbiBiZSB0cmlnZ2VyZWQgaW4gYW4gJ3VwZGF0ZScgY3ljbGVcblx0ICAgIF90aGlzMy5kZWJ0cy5wdXNoKChfdGhpczMkZGVidHMkcHVzaCA9IHtcblx0ICAgICAgbmFtZTogJ0RlYnQnLFxuXHQgICAgICByZW1haW5pbmc6IDAuMDAsXG5cdCAgICAgIHJlcGF5bWVudHM6IFsnZm9vJywgJ2JhcicsICdiYXonXSxcblx0ICAgICAgdXNlUmVwYXltZW50czogdHJ1ZVxuXHQgICAgfSwgX3RoaXMzJGRlYnRzJHB1c2hbJ3JlbWFpbmluZyddID0gaW5pdGlhbERlYnQsIF90aGlzMyRkZWJ0cyRwdXNoKSk7XG5cdCAgICBfdGhpczMudXBkYXRlKCk7XG5cdCAgfTtcblx0XG5cdCAgdGhpcy5yZW1vdmUgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgX3RoaXMzLmRlYnRzLnNwbGljZShlLm1vZGVsLmluZGV4LCAxKTtcblx0ICAgIF90aGlzMy51cGRhdGUoKTtcblx0ICB9O1xuXHRcblx0ICB0aGlzLm9uKCd1cGRhdGUnLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAvL1RPRE86IHRoaXMgY291bGQgYmUgb3B0aW1pc2VkIGZ1cnJ0aGVyIGJ1dCBKUyBpcyBmYWlybHkgZmFzdCBhdCBtYXRoIChyZWxhdGl2ZSB0byBET00gbWFuaXB1bGF0aW9uKVxuXHQgICAgLy9zZWUgaHR0cHM6Ly93d3cucG9seW1lci1wcm9qZWN0Lm9yZy8xLjAvZG9jcy9kZXZndWlkZS9wcm9wZXJ0aWVzI2FycmF5LW9ic2VydmF0aW9uIGZvciBzdHVwaWQgZWZmaWNpZW50IChob3JyaWJseSB1bnJlYWRhYmxlKSB2ZXJzaW9uXG5cdCAgICBfdGhpczMudG90YWwgPSBfdGhpczMuZGVidHMucmVkdWNlKGZ1bmN0aW9uICh0b3RhbCwgY3VycmVudCkge1xuXHQgICAgICByZXR1cm4gdG90YWwgKyAocGFyc2VJbnQoY3VycmVudC5yZW1haW5pbmcsIDEwKSB8fCBpbml0aWFsRGVidCk7XG5cdCAgICB9LCBpbml0aWFsVG90YWxEZWJ0KTtcblx0ICB9KTtcblx0fSk7XG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKSlcblxuLyoqKi8gfVxuLyoqKioqKi8gXSk7XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogbWFpbi5idW5kbGUubWluLmpzXG4gKiovIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiB3ZWJwYWNrL2Jvb3RzdHJhcCBlMGQxN2VlOTUxZjYyODQzNGI5OFxuICoqLyIsImltcG9ydCAnLi9uYW1lLnRhZydcbmltcG9ydCAnLi9hcHBsaWNhdGlvbi50YWcnXG5cbnJpb3QubW91bnQoJyonKVxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc291cmNlL2NsaWVudC9pbmRleC5qc1xuICoqLyIsIi8qIFJpb3QgdjIuNS4wLCBAbGljZW5zZSBNSVQgKi9cblxuOyhmdW5jdGlvbih3aW5kb3csIHVuZGVmaW5lZCkge1xuICAndXNlIHN0cmljdCc7XG52YXIgcmlvdCA9IHsgdmVyc2lvbjogJ3YyLjUuMCcsIHNldHRpbmdzOiB7fSB9LFxuICAvLyBiZSBhd2FyZSwgaW50ZXJuYWwgdXNhZ2VcbiAgLy8gQVRURU5USU9OOiBwcmVmaXggdGhlIGdsb2JhbCBkeW5hbWljIHZhcmlhYmxlcyB3aXRoIGBfX2BcblxuICAvLyBjb3VudGVyIHRvIGdpdmUgYSB1bmlxdWUgaWQgdG8gYWxsIHRoZSBUYWcgaW5zdGFuY2VzXG4gIF9fdWlkID0gMCxcbiAgLy8gdGFncyBpbnN0YW5jZXMgY2FjaGVcbiAgX192aXJ0dWFsRG9tID0gW10sXG4gIC8vIHRhZ3MgaW1wbGVtZW50YXRpb24gY2FjaGVcbiAgX190YWdJbXBsID0ge30sXG5cbiAgLyoqXG4gICAqIENvbnN0XG4gICAqL1xuICBHTE9CQUxfTUlYSU4gPSAnX19nbG9iYWxfbWl4aW4nLFxuXG4gIC8vIHJpb3Qgc3BlY2lmaWMgcHJlZml4ZXNcbiAgUklPVF9QUkVGSVggPSAncmlvdC0nLFxuICBSSU9UX1RBRyA9IFJJT1RfUFJFRklYICsgJ3RhZycsXG4gIFJJT1RfVEFHX0lTID0gJ2RhdGEtaXMnLFxuXG4gIC8vIGZvciB0eXBlb2YgPT0gJycgY29tcGFyaXNvbnNcbiAgVF9TVFJJTkcgPSAnc3RyaW5nJyxcbiAgVF9PQkpFQ1QgPSAnb2JqZWN0JyxcbiAgVF9VTkRFRiAgPSAndW5kZWZpbmVkJyxcbiAgVF9GVU5DVElPTiA9ICdmdW5jdGlvbicsXG4gIC8vIHNwZWNpYWwgbmF0aXZlIHRhZ3MgdGhhdCBjYW5ub3QgYmUgdHJlYXRlZCBsaWtlIHRoZSBvdGhlcnNcbiAgU1BFQ0lBTF9UQUdTX1JFR0VYID0gL14oPzp0KD86Ym9keXxoZWFkfGZvb3R8W3JoZF0pfGNhcHRpb258Y29sKD86Z3JvdXApP3xvcHQoPzppb258Z3JvdXApKSQvLFxuICBSRVNFUlZFRF9XT1JEU19CTEFDS0xJU1QgPSAvXig/Ol8oPzppdGVtfGlkfHBhcmVudCl8dXBkYXRlfHJvb3R8KD86dW4pP21vdW50fG1peGlufGlzKD86TW91bnRlZHxMb29wKXx0YWdzfHBhcmVudHxvcHRzfHRyaWdnZXJ8byg/Om58ZmZ8bmUpKSQvLFxuICAvLyBTVkcgdGFncyBsaXN0IGh0dHBzOi8vd3d3LnczLm9yZy9UUi9TVkcvYXR0aW5kZXguaHRtbCNQcmVzZW50YXRpb25BdHRyaWJ1dGVzXG4gIFNWR19UQUdTX0xJU1QgPSBbJ2FsdEdseXBoJywgJ2FuaW1hdGUnLCAnYW5pbWF0ZUNvbG9yJywgJ2NpcmNsZScsICdjbGlwUGF0aCcsICdkZWZzJywgJ2VsbGlwc2UnLCAnZmVCbGVuZCcsICdmZUNvbG9yTWF0cml4JywgJ2ZlQ29tcG9uZW50VHJhbnNmZXInLCAnZmVDb21wb3NpdGUnLCAnZmVDb252b2x2ZU1hdHJpeCcsICdmZURpZmZ1c2VMaWdodGluZycsICdmZURpc3BsYWNlbWVudE1hcCcsICdmZUZsb29kJywgJ2ZlR2F1c3NpYW5CbHVyJywgJ2ZlSW1hZ2UnLCAnZmVNZXJnZScsICdmZU1vcnBob2xvZ3knLCAnZmVPZmZzZXQnLCAnZmVTcGVjdWxhckxpZ2h0aW5nJywgJ2ZlVGlsZScsICdmZVR1cmJ1bGVuY2UnLCAnZmlsdGVyJywgJ2ZvbnQnLCAnZm9yZWlnbk9iamVjdCcsICdnJywgJ2dseXBoJywgJ2dseXBoUmVmJywgJ2ltYWdlJywgJ2xpbmUnLCAnbGluZWFyR3JhZGllbnQnLCAnbWFya2VyJywgJ21hc2snLCAnbWlzc2luZy1nbHlwaCcsICdwYXRoJywgJ3BhdHRlcm4nLCAncG9seWdvbicsICdwb2x5bGluZScsICdyYWRpYWxHcmFkaWVudCcsICdyZWN0JywgJ3N0b3AnLCAnc3ZnJywgJ3N3aXRjaCcsICdzeW1ib2wnLCAndGV4dCcsICd0ZXh0UGF0aCcsICd0cmVmJywgJ3RzcGFuJywgJ3VzZSddLFxuXG4gIC8vIHZlcnNpb24jIGZvciBJRSA4LTExLCAwIGZvciBvdGhlcnNcbiAgSUVfVkVSU0lPTiA9ICh3aW5kb3cgJiYgd2luZG93LmRvY3VtZW50IHx8IHt9KS5kb2N1bWVudE1vZGUgfCAwLFxuXG4gIC8vIGRldGVjdCBmaXJlZm94IHRvIGZpeCAjMTM3NFxuICBGSVJFRk9YID0gd2luZG93ICYmICEhd2luZG93Lkluc3RhbGxUcmlnZ2VyXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xucmlvdC5vYnNlcnZhYmxlID0gZnVuY3Rpb24oZWwpIHtcblxuICAvKipcbiAgICogRXh0ZW5kIHRoZSBvcmlnaW5hbCBvYmplY3Qgb3IgY3JlYXRlIGEgbmV3IGVtcHR5IG9uZVxuICAgKiBAdHlwZSB7IE9iamVjdCB9XG4gICAqL1xuXG4gIGVsID0gZWwgfHwge31cblxuICAvKipcbiAgICogUHJpdmF0ZSB2YXJpYWJsZXNcbiAgICovXG4gIHZhciBjYWxsYmFja3MgPSB7fSxcbiAgICBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZVxuXG4gIC8qKlxuICAgKiBQcml2YXRlIE1ldGhvZHNcbiAgICovXG5cbiAgLyoqXG4gICAqIEhlbHBlciBmdW5jdGlvbiBuZWVkZWQgdG8gZ2V0IGFuZCBsb29wIGFsbCB0aGUgZXZlbnRzIGluIGEgc3RyaW5nXG4gICAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gICBlIC0gZXZlbnQgc3RyaW5nXG4gICAqIEBwYXJhbSAgIHtGdW5jdGlvbn0gICBmbiAtIGNhbGxiYWNrXG4gICAqL1xuICBmdW5jdGlvbiBvbkVhY2hFdmVudChlLCBmbikge1xuICAgIHZhciBlcyA9IGUuc3BsaXQoJyAnKSwgbCA9IGVzLmxlbmd0aCwgaSA9IDAsIG5hbWUsIGluZHhcbiAgICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgICAgbmFtZSA9IGVzW2ldXG4gICAgICBpbmR4ID0gbmFtZS5pbmRleE9mKCcuJylcbiAgICAgIGlmIChuYW1lKSBmbiggfmluZHggPyBuYW1lLnN1YnN0cmluZygwLCBpbmR4KSA6IG5hbWUsIGksIH5pbmR4ID8gbmFtZS5zbGljZShpbmR4ICsgMSkgOiBudWxsKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQdWJsaWMgQXBpXG4gICAqL1xuXG4gIC8vIGV4dGVuZCB0aGUgZWwgb2JqZWN0IGFkZGluZyB0aGUgb2JzZXJ2YWJsZSBtZXRob2RzXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGVsLCB7XG4gICAgLyoqXG4gICAgICogTGlzdGVuIHRvIHRoZSBnaXZlbiBzcGFjZSBzZXBhcmF0ZWQgbGlzdCBvZiBgZXZlbnRzYCBhbmRcbiAgICAgKiBleGVjdXRlIHRoZSBgY2FsbGJhY2tgIGVhY2ggdGltZSBhbiBldmVudCBpcyB0cmlnZ2VyZWQuXG4gICAgICogQHBhcmFtICB7IFN0cmluZyB9IGV2ZW50cyAtIGV2ZW50cyBpZHNcbiAgICAgKiBAcGFyYW0gIHsgRnVuY3Rpb24gfSBmbiAtIGNhbGxiYWNrIGZ1bmN0aW9uXG4gICAgICogQHJldHVybnMgeyBPYmplY3QgfSBlbFxuICAgICAqL1xuICAgIG9uOiB7XG4gICAgICB2YWx1ZTogZnVuY3Rpb24oZXZlbnRzLCBmbikge1xuICAgICAgICBpZiAodHlwZW9mIGZuICE9ICdmdW5jdGlvbicpICByZXR1cm4gZWxcblxuICAgICAgICBvbkVhY2hFdmVudChldmVudHMsIGZ1bmN0aW9uKG5hbWUsIHBvcywgbnMpIHtcbiAgICAgICAgICAoY2FsbGJhY2tzW25hbWVdID0gY2FsbGJhY2tzW25hbWVdIHx8IFtdKS5wdXNoKGZuKVxuICAgICAgICAgIGZuLnR5cGVkID0gcG9zID4gMFxuICAgICAgICAgIGZuLm5zID0gbnNcbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gZWxcbiAgICAgIH0sXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2VcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gc3BhY2Ugc2VwYXJhdGVkIGxpc3Qgb2YgYGV2ZW50c2AgbGlzdGVuZXJzXG4gICAgICogQHBhcmFtICAgeyBTdHJpbmcgfSBldmVudHMgLSBldmVudHMgaWRzXG4gICAgICogQHBhcmFtICAgeyBGdW5jdGlvbiB9IGZuIC0gY2FsbGJhY2sgZnVuY3Rpb25cbiAgICAgKiBAcmV0dXJucyB7IE9iamVjdCB9IGVsXG4gICAgICovXG4gICAgb2ZmOiB7XG4gICAgICB2YWx1ZTogZnVuY3Rpb24oZXZlbnRzLCBmbikge1xuICAgICAgICBpZiAoZXZlbnRzID09ICcqJyAmJiAhZm4pIGNhbGxiYWNrcyA9IHt9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIG9uRWFjaEV2ZW50KGV2ZW50cywgZnVuY3Rpb24obmFtZSwgcG9zLCBucykge1xuICAgICAgICAgICAgaWYgKGZuIHx8IG5zKSB7XG4gICAgICAgICAgICAgIHZhciBhcnIgPSBjYWxsYmFja3NbbmFtZV1cbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNiOyBjYiA9IGFyciAmJiBhcnJbaV07ICsraSkge1xuICAgICAgICAgICAgICAgIGlmIChjYiA9PSBmbiB8fCBucyAmJiBjYi5ucyA9PSBucykgYXJyLnNwbGljZShpLS0sIDEpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBkZWxldGUgY2FsbGJhY2tzW25hbWVdXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZWxcbiAgICAgIH0sXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2VcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogTGlzdGVuIHRvIHRoZSBnaXZlbiBzcGFjZSBzZXBhcmF0ZWQgbGlzdCBvZiBgZXZlbnRzYCBhbmRcbiAgICAgKiBleGVjdXRlIHRoZSBgY2FsbGJhY2tgIGF0IG1vc3Qgb25jZVxuICAgICAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gZXZlbnRzIC0gZXZlbnRzIGlkc1xuICAgICAqIEBwYXJhbSAgIHsgRnVuY3Rpb24gfSBmbiAtIGNhbGxiYWNrIGZ1bmN0aW9uXG4gICAgICogQHJldHVybnMgeyBPYmplY3QgfSBlbFxuICAgICAqL1xuICAgIG9uZToge1xuICAgICAgdmFsdWU6IGZ1bmN0aW9uKGV2ZW50cywgZm4pIHtcbiAgICAgICAgZnVuY3Rpb24gb24oKSB7XG4gICAgICAgICAgZWwub2ZmKGV2ZW50cywgb24pXG4gICAgICAgICAgZm4uYXBwbHkoZWwsIGFyZ3VtZW50cylcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZWwub24oZXZlbnRzLCBvbilcbiAgICAgIH0sXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2VcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhbGwgY2FsbGJhY2sgZnVuY3Rpb25zIHRoYXQgbGlzdGVuIHRvXG4gICAgICogdGhlIGdpdmVuIHNwYWNlIHNlcGFyYXRlZCBsaXN0IG9mIGBldmVudHNgXG4gICAgICogQHBhcmFtICAgeyBTdHJpbmcgfSBldmVudHMgLSBldmVudHMgaWRzXG4gICAgICogQHJldHVybnMgeyBPYmplY3QgfSBlbFxuICAgICAqL1xuICAgIHRyaWdnZXI6IHtcbiAgICAgIHZhbHVlOiBmdW5jdGlvbihldmVudHMpIHtcblxuICAgICAgICAvLyBnZXR0aW5nIHRoZSBhcmd1bWVudHNcbiAgICAgICAgdmFyIGFyZ2xlbiA9IGFyZ3VtZW50cy5sZW5ndGggLSAxLFxuICAgICAgICAgIGFyZ3MgPSBuZXcgQXJyYXkoYXJnbGVuKSxcbiAgICAgICAgICBmbnNcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ2xlbjsgaSsrKSB7XG4gICAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpICsgMV0gLy8gc2tpcCBmaXJzdCBhcmd1bWVudFxuICAgICAgICB9XG5cbiAgICAgICAgb25FYWNoRXZlbnQoZXZlbnRzLCBmdW5jdGlvbihuYW1lLCBwb3MsIG5zKSB7XG5cbiAgICAgICAgICBmbnMgPSBzbGljZS5jYWxsKGNhbGxiYWNrc1tuYW1lXSB8fCBbXSwgMClcblxuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBmbjsgZm4gPSBmbnNbaV07ICsraSkge1xuICAgICAgICAgICAgaWYgKGZuLmJ1c3kpIGNvbnRpbnVlXG4gICAgICAgICAgICBmbi5idXN5ID0gMVxuICAgICAgICAgICAgaWYgKCFucyB8fCBmbi5ucyA9PSBucykgZm4uYXBwbHkoZWwsIGZuLnR5cGVkID8gW25hbWVdLmNvbmNhdChhcmdzKSA6IGFyZ3MpXG4gICAgICAgICAgICBpZiAoZm5zW2ldICE9PSBmbikgeyBpLS0gfVxuICAgICAgICAgICAgZm4uYnVzeSA9IDBcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoY2FsbGJhY2tzWycqJ10gJiYgbmFtZSAhPSAnKicpXG4gICAgICAgICAgICBlbC50cmlnZ2VyLmFwcGx5KGVsLCBbJyonLCBuYW1lXS5jb25jYXQoYXJncykpXG5cbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gZWxcbiAgICAgIH0sXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2VcbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIGVsXG5cbn1cbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG47KGZ1bmN0aW9uKHJpb3QpIHtcblxuLyoqXG4gKiBTaW1wbGUgY2xpZW50LXNpZGUgcm91dGVyXG4gKiBAbW9kdWxlIHJpb3Qtcm91dGVcbiAqL1xuXG5cbnZhciBSRV9PUklHSU4gPSAvXi4rP1xcL1xcLytbXlxcL10rLyxcbiAgRVZFTlRfTElTVEVORVIgPSAnRXZlbnRMaXN0ZW5lcicsXG4gIFJFTU9WRV9FVkVOVF9MSVNURU5FUiA9ICdyZW1vdmUnICsgRVZFTlRfTElTVEVORVIsXG4gIEFERF9FVkVOVF9MSVNURU5FUiA9ICdhZGQnICsgRVZFTlRfTElTVEVORVIsXG4gIEhBU19BVFRSSUJVVEUgPSAnaGFzQXR0cmlidXRlJyxcbiAgUkVQTEFDRSA9ICdyZXBsYWNlJyxcbiAgUE9QU1RBVEUgPSAncG9wc3RhdGUnLFxuICBIQVNIQ0hBTkdFID0gJ2hhc2hjaGFuZ2UnLFxuICBUUklHR0VSID0gJ3RyaWdnZXInLFxuICBNQVhfRU1JVF9TVEFDS19MRVZFTCA9IDMsXG4gIHdpbiA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LFxuICBkb2MgPSB0eXBlb2YgZG9jdW1lbnQgIT0gJ3VuZGVmaW5lZCcgJiYgZG9jdW1lbnQsXG4gIGhpc3QgPSB3aW4gJiYgaGlzdG9yeSxcbiAgbG9jID0gd2luICYmIChoaXN0LmxvY2F0aW9uIHx8IHdpbi5sb2NhdGlvbiksIC8vIHNlZSBodG1sNS1oaXN0b3J5LWFwaVxuICBwcm90ID0gUm91dGVyLnByb3RvdHlwZSwgLy8gdG8gbWluaWZ5IG1vcmVcbiAgY2xpY2tFdmVudCA9IGRvYyAmJiBkb2Mub250b3VjaHN0YXJ0ID8gJ3RvdWNoc3RhcnQnIDogJ2NsaWNrJyxcbiAgc3RhcnRlZCA9IGZhbHNlLFxuICBjZW50cmFsID0gcmlvdC5vYnNlcnZhYmxlKCksXG4gIHJvdXRlRm91bmQgPSBmYWxzZSxcbiAgZGVib3VuY2VkRW1pdCxcbiAgYmFzZSwgY3VycmVudCwgcGFyc2VyLCBzZWNvbmRQYXJzZXIsIGVtaXRTdGFjayA9IFtdLCBlbWl0U3RhY2tMZXZlbCA9IDBcblxuLyoqXG4gKiBEZWZhdWx0IHBhcnNlci4gWW91IGNhbiByZXBsYWNlIGl0IHZpYSByb3V0ZXIucGFyc2VyIG1ldGhvZC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIC0gY3VycmVudCBwYXRoIChub3JtYWxpemVkKVxuICogQHJldHVybnMge2FycmF5fSBhcnJheVxuICovXG5mdW5jdGlvbiBERUZBVUxUX1BBUlNFUihwYXRoKSB7XG4gIHJldHVybiBwYXRoLnNwbGl0KC9bLz8jXS8pXG59XG5cbi8qKlxuICogRGVmYXVsdCBwYXJzZXIgKHNlY29uZCkuIFlvdSBjYW4gcmVwbGFjZSBpdCB2aWEgcm91dGVyLnBhcnNlciBtZXRob2QuXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aCAtIGN1cnJlbnQgcGF0aCAobm9ybWFsaXplZClcbiAqIEBwYXJhbSB7c3RyaW5nfSBmaWx0ZXIgLSBmaWx0ZXIgc3RyaW5nIChub3JtYWxpemVkKVxuICogQHJldHVybnMge2FycmF5fSBhcnJheVxuICovXG5mdW5jdGlvbiBERUZBVUxUX1NFQ09ORF9QQVJTRVIocGF0aCwgZmlsdGVyKSB7XG4gIHZhciByZSA9IG5ldyBSZWdFeHAoJ14nICsgZmlsdGVyW1JFUExBQ0VdKC9cXCovZywgJyhbXi8/I10rPyknKVtSRVBMQUNFXSgvXFwuXFwuLywgJy4qJykgKyAnJCcpLFxuICAgIGFyZ3MgPSBwYXRoLm1hdGNoKHJlKVxuXG4gIGlmIChhcmdzKSByZXR1cm4gYXJncy5zbGljZSgxKVxufVxuXG4vKipcbiAqIFNpbXBsZS9jaGVhcCBkZWJvdW5jZSBpbXBsZW1lbnRhdGlvblxuICogQHBhcmFtICAge2Z1bmN0aW9ufSBmbiAtIGNhbGxiYWNrXG4gKiBAcGFyYW0gICB7bnVtYmVyfSBkZWxheSAtIGRlbGF5IGluIHNlY29uZHNcbiAqIEByZXR1cm5zIHtmdW5jdGlvbn0gZGVib3VuY2VkIGZ1bmN0aW9uXG4gKi9cbmZ1bmN0aW9uIGRlYm91bmNlKGZuLCBkZWxheSkge1xuICB2YXIgdFxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGNsZWFyVGltZW91dCh0KVxuICAgIHQgPSBzZXRUaW1lb3V0KGZuLCBkZWxheSlcbiAgfVxufVxuXG4vKipcbiAqIFNldCB0aGUgd2luZG93IGxpc3RlbmVycyB0byB0cmlnZ2VyIHRoZSByb3V0ZXNcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gYXV0b0V4ZWMgLSBzZWUgcm91dGUuc3RhcnRcbiAqL1xuZnVuY3Rpb24gc3RhcnQoYXV0b0V4ZWMpIHtcbiAgZGVib3VuY2VkRW1pdCA9IGRlYm91bmNlKGVtaXQsIDEpXG4gIHdpbltBRERfRVZFTlRfTElTVEVORVJdKFBPUFNUQVRFLCBkZWJvdW5jZWRFbWl0KVxuICB3aW5bQUREX0VWRU5UX0xJU1RFTkVSXShIQVNIQ0hBTkdFLCBkZWJvdW5jZWRFbWl0KVxuICBkb2NbQUREX0VWRU5UX0xJU1RFTkVSXShjbGlja0V2ZW50LCBjbGljaylcbiAgaWYgKGF1dG9FeGVjKSBlbWl0KHRydWUpXG59XG5cbi8qKlxuICogUm91dGVyIGNsYXNzXG4gKi9cbmZ1bmN0aW9uIFJvdXRlcigpIHtcbiAgdGhpcy4kID0gW11cbiAgcmlvdC5vYnNlcnZhYmxlKHRoaXMpIC8vIG1ha2UgaXQgb2JzZXJ2YWJsZVxuICBjZW50cmFsLm9uKCdzdG9wJywgdGhpcy5zLmJpbmQodGhpcykpXG4gIGNlbnRyYWwub24oJ2VtaXQnLCB0aGlzLmUuYmluZCh0aGlzKSlcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplKHBhdGgpIHtcbiAgcmV0dXJuIHBhdGhbUkVQTEFDRV0oL15cXC98XFwvJC8sICcnKVxufVxuXG5mdW5jdGlvbiBpc1N0cmluZyhzdHIpIHtcbiAgcmV0dXJuIHR5cGVvZiBzdHIgPT0gJ3N0cmluZydcbn1cblxuLyoqXG4gKiBHZXQgdGhlIHBhcnQgYWZ0ZXIgZG9tYWluIG5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSBocmVmIC0gZnVsbHBhdGhcbiAqIEByZXR1cm5zIHtzdHJpbmd9IHBhdGggZnJvbSByb290XG4gKi9cbmZ1bmN0aW9uIGdldFBhdGhGcm9tUm9vdChocmVmKSB7XG4gIHJldHVybiAoaHJlZiB8fCBsb2MuaHJlZilbUkVQTEFDRV0oUkVfT1JJR0lOLCAnJylcbn1cblxuLyoqXG4gKiBHZXQgdGhlIHBhcnQgYWZ0ZXIgYmFzZVxuICogQHBhcmFtIHtzdHJpbmd9IGhyZWYgLSBmdWxscGF0aFxuICogQHJldHVybnMge3N0cmluZ30gcGF0aCBmcm9tIGJhc2VcbiAqL1xuZnVuY3Rpb24gZ2V0UGF0aEZyb21CYXNlKGhyZWYpIHtcbiAgcmV0dXJuIGJhc2VbMF0gPT0gJyMnXG4gICAgPyAoaHJlZiB8fCBsb2MuaHJlZiB8fCAnJykuc3BsaXQoYmFzZSlbMV0gfHwgJydcbiAgICA6IChsb2MgPyBnZXRQYXRoRnJvbVJvb3QoaHJlZikgOiBocmVmIHx8ICcnKVtSRVBMQUNFXShiYXNlLCAnJylcbn1cblxuZnVuY3Rpb24gZW1pdChmb3JjZSkge1xuICAvLyB0aGUgc3RhY2sgaXMgbmVlZGVkIGZvciByZWRpcmVjdGlvbnNcbiAgdmFyIGlzUm9vdCA9IGVtaXRTdGFja0xldmVsID09IDBcbiAgaWYgKE1BWF9FTUlUX1NUQUNLX0xFVkVMIDw9IGVtaXRTdGFja0xldmVsKSByZXR1cm5cblxuICBlbWl0U3RhY2tMZXZlbCsrXG4gIGVtaXRTdGFjay5wdXNoKGZ1bmN0aW9uKCkge1xuICAgIHZhciBwYXRoID0gZ2V0UGF0aEZyb21CYXNlKClcbiAgICBpZiAoZm9yY2UgfHwgcGF0aCAhPSBjdXJyZW50KSB7XG4gICAgICBjZW50cmFsW1RSSUdHRVJdKCdlbWl0JywgcGF0aClcbiAgICAgIGN1cnJlbnQgPSBwYXRoXG4gICAgfVxuICB9KVxuICBpZiAoaXNSb290KSB7XG4gICAgd2hpbGUgKGVtaXRTdGFjay5sZW5ndGgpIHtcbiAgICAgIGVtaXRTdGFja1swXSgpXG4gICAgICBlbWl0U3RhY2suc2hpZnQoKVxuICAgIH1cbiAgICBlbWl0U3RhY2tMZXZlbCA9IDBcbiAgfVxufVxuXG5mdW5jdGlvbiBjbGljayhlKSB7XG4gIGlmIChcbiAgICBlLndoaWNoICE9IDEgLy8gbm90IGxlZnQgY2xpY2tcbiAgICB8fCBlLm1ldGFLZXkgfHwgZS5jdHJsS2V5IHx8IGUuc2hpZnRLZXkgLy8gb3IgbWV0YSBrZXlzXG4gICAgfHwgZS5kZWZhdWx0UHJldmVudGVkIC8vIG9yIGRlZmF1bHQgcHJldmVudGVkXG4gICkgcmV0dXJuXG5cbiAgdmFyIGVsID0gZS50YXJnZXRcbiAgd2hpbGUgKGVsICYmIGVsLm5vZGVOYW1lICE9ICdBJykgZWwgPSBlbC5wYXJlbnROb2RlXG5cbiAgaWYgKFxuICAgICFlbCB8fCBlbC5ub2RlTmFtZSAhPSAnQScgLy8gbm90IEEgdGFnXG4gICAgfHwgZWxbSEFTX0FUVFJJQlVURV0oJ2Rvd25sb2FkJykgLy8gaGFzIGRvd25sb2FkIGF0dHJcbiAgICB8fCAhZWxbSEFTX0FUVFJJQlVURV0oJ2hyZWYnKSAvLyBoYXMgbm8gaHJlZiBhdHRyXG4gICAgfHwgZWwudGFyZ2V0ICYmIGVsLnRhcmdldCAhPSAnX3NlbGYnIC8vIGFub3RoZXIgd2luZG93IG9yIGZyYW1lXG4gICAgfHwgZWwuaHJlZi5pbmRleE9mKGxvYy5ocmVmLm1hdGNoKFJFX09SSUdJTilbMF0pID09IC0xIC8vIGNyb3NzIG9yaWdpblxuICApIHJldHVyblxuXG4gIGlmIChlbC5ocmVmICE9IGxvYy5ocmVmKSB7XG4gICAgaWYgKFxuICAgICAgZWwuaHJlZi5zcGxpdCgnIycpWzBdID09IGxvYy5ocmVmLnNwbGl0KCcjJylbMF0gLy8gaW50ZXJuYWwganVtcFxuICAgICAgfHwgYmFzZSAhPSAnIycgJiYgZ2V0UGF0aEZyb21Sb290KGVsLmhyZWYpLmluZGV4T2YoYmFzZSkgIT09IDAgLy8gb3V0c2lkZSBvZiBiYXNlXG4gICAgICB8fCAhZ28oZ2V0UGF0aEZyb21CYXNlKGVsLmhyZWYpLCBlbC50aXRsZSB8fCBkb2MudGl0bGUpIC8vIHJvdXRlIG5vdCBmb3VuZFxuICAgICkgcmV0dXJuXG4gIH1cblxuICBlLnByZXZlbnREZWZhdWx0KClcbn1cblxuLyoqXG4gKiBHbyB0byB0aGUgcGF0aFxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGggLSBkZXN0aW5hdGlvbiBwYXRoXG4gKiBAcGFyYW0ge3N0cmluZ30gdGl0bGUgLSBwYWdlIHRpdGxlXG4gKiBAcGFyYW0ge2Jvb2xlYW59IHNob3VsZFJlcGxhY2UgLSB1c2UgcmVwbGFjZVN0YXRlIG9yIHB1c2hTdGF0ZVxuICogQHJldHVybnMge2Jvb2xlYW59IC0gcm91dGUgbm90IGZvdW5kIGZsYWdcbiAqL1xuZnVuY3Rpb24gZ28ocGF0aCwgdGl0bGUsIHNob3VsZFJlcGxhY2UpIHtcbiAgaWYgKGhpc3QpIHsgLy8gaWYgYSBicm93c2VyXG4gICAgcGF0aCA9IGJhc2UgKyBub3JtYWxpemUocGF0aClcbiAgICB0aXRsZSA9IHRpdGxlIHx8IGRvYy50aXRsZVxuICAgIC8vIGJyb3dzZXJzIGlnbm9yZXMgdGhlIHNlY29uZCBwYXJhbWV0ZXIgYHRpdGxlYFxuICAgIHNob3VsZFJlcGxhY2VcbiAgICAgID8gaGlzdC5yZXBsYWNlU3RhdGUobnVsbCwgdGl0bGUsIHBhdGgpXG4gICAgICA6IGhpc3QucHVzaFN0YXRlKG51bGwsIHRpdGxlLCBwYXRoKVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gc2V0IGl0IG1hbnVhbGx5XG4gICAgZG9jLnRpdGxlID0gdGl0bGVcbiAgICByb3V0ZUZvdW5kID0gZmFsc2VcbiAgICBlbWl0KClcbiAgICByZXR1cm4gcm91dGVGb3VuZFxuICB9XG5cbiAgLy8gU2VydmVyLXNpZGUgdXNhZ2U6IGRpcmVjdGx5IGV4ZWN1dGUgaGFuZGxlcnMgZm9yIHRoZSBwYXRoXG4gIHJldHVybiBjZW50cmFsW1RSSUdHRVJdKCdlbWl0JywgZ2V0UGF0aEZyb21CYXNlKHBhdGgpKVxufVxuXG4vKipcbiAqIEdvIHRvIHBhdGggb3Igc2V0IGFjdGlvblxuICogYSBzaW5nbGUgc3RyaW5nOiAgICAgICAgICAgICAgICBnbyB0aGVyZVxuICogdHdvIHN0cmluZ3M6ICAgICAgICAgICAgICAgICAgICBnbyB0aGVyZSB3aXRoIHNldHRpbmcgYSB0aXRsZVxuICogdHdvIHN0cmluZ3MgYW5kIGJvb2xlYW46ICAgICAgICByZXBsYWNlIGhpc3Rvcnkgd2l0aCBzZXR0aW5nIGEgdGl0bGVcbiAqIGEgc2luZ2xlIGZ1bmN0aW9uOiAgICAgICAgICAgICAgc2V0IGFuIGFjdGlvbiBvbiB0aGUgZGVmYXVsdCByb3V0ZVxuICogYSBzdHJpbmcvUmVnRXhwIGFuZCBhIGZ1bmN0aW9uOiBzZXQgYW4gYWN0aW9uIG9uIHRoZSByb3V0ZVxuICogQHBhcmFtIHsoc3RyaW5nfGZ1bmN0aW9uKX0gZmlyc3QgLSBwYXRoIC8gYWN0aW9uIC8gZmlsdGVyXG4gKiBAcGFyYW0geyhzdHJpbmd8UmVnRXhwfGZ1bmN0aW9uKX0gc2Vjb25kIC0gdGl0bGUgLyBhY3Rpb25cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdGhpcmQgLSByZXBsYWNlIGZsYWdcbiAqL1xucHJvdC5tID0gZnVuY3Rpb24oZmlyc3QsIHNlY29uZCwgdGhpcmQpIHtcbiAgaWYgKGlzU3RyaW5nKGZpcnN0KSAmJiAoIXNlY29uZCB8fCBpc1N0cmluZyhzZWNvbmQpKSkgZ28oZmlyc3QsIHNlY29uZCwgdGhpcmQgfHwgZmFsc2UpXG4gIGVsc2UgaWYgKHNlY29uZCkgdGhpcy5yKGZpcnN0LCBzZWNvbmQpXG4gIGVsc2UgdGhpcy5yKCdAJywgZmlyc3QpXG59XG5cbi8qKlxuICogU3RvcCByb3V0aW5nXG4gKi9cbnByb3QucyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm9mZignKicpXG4gIHRoaXMuJCA9IFtdXG59XG5cbi8qKlxuICogRW1pdFxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGggLSBwYXRoXG4gKi9cbnByb3QuZSA9IGZ1bmN0aW9uKHBhdGgpIHtcbiAgdGhpcy4kLmNvbmNhdCgnQCcpLnNvbWUoZnVuY3Rpb24oZmlsdGVyKSB7XG4gICAgdmFyIGFyZ3MgPSAoZmlsdGVyID09ICdAJyA/IHBhcnNlciA6IHNlY29uZFBhcnNlcikobm9ybWFsaXplKHBhdGgpLCBub3JtYWxpemUoZmlsdGVyKSlcbiAgICBpZiAodHlwZW9mIGFyZ3MgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRoaXNbVFJJR0dFUl0uYXBwbHkobnVsbCwgW2ZpbHRlcl0uY29uY2F0KGFyZ3MpKVxuICAgICAgcmV0dXJuIHJvdXRlRm91bmQgPSB0cnVlIC8vIGV4aXQgZnJvbSBsb29wXG4gICAgfVxuICB9LCB0aGlzKVxufVxuXG4vKipcbiAqIFJlZ2lzdGVyIHJvdXRlXG4gKiBAcGFyYW0ge3N0cmluZ30gZmlsdGVyIC0gZmlsdGVyIGZvciBtYXRjaGluZyB0byB1cmxcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGFjdGlvbiAtIGFjdGlvbiB0byByZWdpc3RlclxuICovXG5wcm90LnIgPSBmdW5jdGlvbihmaWx0ZXIsIGFjdGlvbikge1xuICBpZiAoZmlsdGVyICE9ICdAJykge1xuICAgIGZpbHRlciA9ICcvJyArIG5vcm1hbGl6ZShmaWx0ZXIpXG4gICAgdGhpcy4kLnB1c2goZmlsdGVyKVxuICB9XG4gIHRoaXMub24oZmlsdGVyLCBhY3Rpb24pXG59XG5cbnZhciBtYWluUm91dGVyID0gbmV3IFJvdXRlcigpXG52YXIgcm91dGUgPSBtYWluUm91dGVyLm0uYmluZChtYWluUm91dGVyKVxuXG4vKipcbiAqIENyZWF0ZSBhIHN1YiByb3V0ZXJcbiAqIEByZXR1cm5zIHtmdW5jdGlvbn0gdGhlIG1ldGhvZCBvZiBhIG5ldyBSb3V0ZXIgb2JqZWN0XG4gKi9cbnJvdXRlLmNyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgbmV3U3ViUm91dGVyID0gbmV3IFJvdXRlcigpXG4gIC8vIGFzc2lnbiBzdWItcm91dGVyJ3MgbWFpbiBtZXRob2RcbiAgdmFyIHJvdXRlciA9IG5ld1N1YlJvdXRlci5tLmJpbmQobmV3U3ViUm91dGVyKVxuICAvLyBzdG9wIG9ubHkgdGhpcyBzdWItcm91dGVyXG4gIHJvdXRlci5zdG9wID0gbmV3U3ViUm91dGVyLnMuYmluZChuZXdTdWJSb3V0ZXIpXG4gIHJldHVybiByb3V0ZXJcbn1cblxuLyoqXG4gKiBTZXQgdGhlIGJhc2Ugb2YgdXJsXG4gKiBAcGFyYW0geyhzdHJ8UmVnRXhwKX0gYXJnIC0gYSBuZXcgYmFzZSBvciAnIycgb3IgJyMhJ1xuICovXG5yb3V0ZS5iYXNlID0gZnVuY3Rpb24oYXJnKSB7XG4gIGJhc2UgPSBhcmcgfHwgJyMnXG4gIGN1cnJlbnQgPSBnZXRQYXRoRnJvbUJhc2UoKSAvLyByZWNhbGN1bGF0ZSBjdXJyZW50IHBhdGhcbn1cblxuLyoqIEV4ZWMgcm91dGluZyByaWdodCBub3cgKiovXG5yb3V0ZS5leGVjID0gZnVuY3Rpb24oKSB7XG4gIGVtaXQodHJ1ZSlcbn1cblxuLyoqXG4gKiBSZXBsYWNlIHRoZSBkZWZhdWx0IHJvdXRlciB0byB5b3Vyc1xuICogQHBhcmFtIHtmdW5jdGlvbn0gZm4gLSB5b3VyIHBhcnNlciBmdW5jdGlvblxuICogQHBhcmFtIHtmdW5jdGlvbn0gZm4yIC0geW91ciBzZWNvbmRQYXJzZXIgZnVuY3Rpb25cbiAqL1xucm91dGUucGFyc2VyID0gZnVuY3Rpb24oZm4sIGZuMikge1xuICBpZiAoIWZuICYmICFmbjIpIHtcbiAgICAvLyByZXNldCBwYXJzZXIgZm9yIHRlc3RpbmcuLi5cbiAgICBwYXJzZXIgPSBERUZBVUxUX1BBUlNFUlxuICAgIHNlY29uZFBhcnNlciA9IERFRkFVTFRfU0VDT05EX1BBUlNFUlxuICB9XG4gIGlmIChmbikgcGFyc2VyID0gZm5cbiAgaWYgKGZuMikgc2Vjb25kUGFyc2VyID0gZm4yXG59XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGdldCB1cmwgcXVlcnkgYXMgYW4gb2JqZWN0XG4gKiBAcmV0dXJucyB7b2JqZWN0fSBwYXJzZWQgcXVlcnlcbiAqL1xucm91dGUucXVlcnkgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHEgPSB7fVxuICB2YXIgaHJlZiA9IGxvYy5ocmVmIHx8IGN1cnJlbnRcbiAgaHJlZltSRVBMQUNFXSgvWz8mXSguKz8pPShbXiZdKikvZywgZnVuY3Rpb24oXywgaywgdikgeyBxW2tdID0gdiB9KVxuICByZXR1cm4gcVxufVxuXG4vKiogU3RvcCByb3V0aW5nICoqL1xucm91dGUuc3RvcCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHN0YXJ0ZWQpIHtcbiAgICBpZiAod2luKSB7XG4gICAgICB3aW5bUkVNT1ZFX0VWRU5UX0xJU1RFTkVSXShQT1BTVEFURSwgZGVib3VuY2VkRW1pdClcbiAgICAgIHdpbltSRU1PVkVfRVZFTlRfTElTVEVORVJdKEhBU0hDSEFOR0UsIGRlYm91bmNlZEVtaXQpXG4gICAgICBkb2NbUkVNT1ZFX0VWRU5UX0xJU1RFTkVSXShjbGlja0V2ZW50LCBjbGljaylcbiAgICB9XG4gICAgY2VudHJhbFtUUklHR0VSXSgnc3RvcCcpXG4gICAgc3RhcnRlZCA9IGZhbHNlXG4gIH1cbn1cblxuLyoqXG4gKiBTdGFydCByb3V0aW5nXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGF1dG9FeGVjIC0gYXV0b21hdGljYWxseSBleGVjIGFmdGVyIHN0YXJ0aW5nIGlmIHRydWVcbiAqL1xucm91dGUuc3RhcnQgPSBmdW5jdGlvbiAoYXV0b0V4ZWMpIHtcbiAgaWYgKCFzdGFydGVkKSB7XG4gICAgaWYgKHdpbikge1xuICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT0gJ2NvbXBsZXRlJykgc3RhcnQoYXV0b0V4ZWMpXG4gICAgICAvLyB0aGUgdGltZW91dCBpcyBuZWVkZWQgdG8gc29sdmVcbiAgICAgIC8vIGEgd2VpcmQgc2FmYXJpIGJ1ZyBodHRwczovL2dpdGh1Yi5jb20vcmlvdC9yb3V0ZS9pc3N1ZXMvMzNcbiAgICAgIGVsc2Ugd2luW0FERF9FVkVOVF9MSVNURU5FUl0oJ2xvYWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgc3RhcnQoYXV0b0V4ZWMpIH0sIDEpXG4gICAgICB9KVxuICAgIH1cbiAgICBzdGFydGVkID0gdHJ1ZVxuICB9XG59XG5cbi8qKiBQcmVwYXJlIHRoZSByb3V0ZXIgKiovXG5yb3V0ZS5iYXNlKClcbnJvdXRlLnBhcnNlcigpXG5cbnJpb3Qucm91dGUgPSByb3V0ZVxufSkocmlvdClcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG5cbi8qKlxuICogVGhlIHJpb3QgdGVtcGxhdGUgZW5naW5lXG4gKiBAdmVyc2lvbiB2Mi40LjBcbiAqL1xuLyoqXG4gKiByaW90LnV0aWwuYnJhY2tldHNcbiAqXG4gKiAtIGBicmFja2V0cyAgICBgIC0gUmV0dXJucyBhIHN0cmluZyBvciByZWdleCBiYXNlZCBvbiBpdHMgcGFyYW1ldGVyXG4gKiAtIGBicmFja2V0cy5zZXRgIC0gQ2hhbmdlIHRoZSBjdXJyZW50IHJpb3QgYnJhY2tldHNcbiAqXG4gKiBAbW9kdWxlXG4gKi9cblxudmFyIGJyYWNrZXRzID0gKGZ1bmN0aW9uIChVTkRFRikge1xuXG4gIHZhclxuICAgIFJFR0xPQiA9ICdnJyxcblxuICAgIFJfTUxDT01NUyA9IC9cXC9cXCpbXipdKlxcKisoPzpbXipcXC9dW14qXSpcXCorKSpcXC8vZyxcblxuICAgIFJfU1RSSU5HUyA9IC9cIlteXCJcXFxcXSooPzpcXFxcW1xcU1xcc11bXlwiXFxcXF0qKSpcInwnW14nXFxcXF0qKD86XFxcXFtcXFNcXHNdW14nXFxcXF0qKSonL2csXG5cbiAgICBTX1FCTE9DS1MgPSBSX1NUUklOR1Muc291cmNlICsgJ3wnICtcbiAgICAgIC8oPzpcXGJyZXR1cm5cXHMrfCg/OlskXFx3XFwpXFxdXXxcXCtcXCt8LS0pXFxzKihcXC8pKD8hWypcXC9dKSkvLnNvdXJjZSArICd8JyArXG4gICAgICAvXFwvKD89W14qXFwvXSlbXltcXC9cXFxcXSooPzooPzpcXFsoPzpcXFxcLnxbXlxcXVxcXFxdKikqXFxdfFxcXFwuKVteW1xcL1xcXFxdKikqPyhcXC8pW2dpbV0qLy5zb3VyY2UsXG5cbiAgICBGSU5EQlJBQ0VTID0ge1xuICAgICAgJygnOiBSZWdFeHAoJyhbKCldKXwnICAgKyBTX1FCTE9DS1MsIFJFR0xPQiksXG4gICAgICAnWyc6IFJlZ0V4cCgnKFtbXFxcXF1dKXwnICsgU19RQkxPQ0tTLCBSRUdMT0IpLFxuICAgICAgJ3snOiBSZWdFeHAoJyhbe31dKXwnICAgKyBTX1FCTE9DS1MsIFJFR0xPQilcbiAgICB9LFxuXG4gICAgREVGQVVMVCA9ICd7IH0nXG5cbiAgdmFyIF9wYWlycyA9IFtcbiAgICAneycsICd9JyxcbiAgICAneycsICd9JyxcbiAgICAve1tefV0qfS8sXG4gICAgL1xcXFwoW3t9XSkvZyxcbiAgICAvXFxcXCh7KXx7L2csXG4gICAgUmVnRXhwKCdcXFxcXFxcXCh9KXwoW1soe10pfCh9KXwnICsgU19RQkxPQ0tTLCBSRUdMT0IpLFxuICAgIERFRkFVTFQsXG4gICAgL15cXHMqe1xcXj9cXHMqKFskXFx3XSspKD86XFxzKixcXHMqKFxcUyspKT9cXHMraW5cXHMrKFxcUy4qKVxccyp9LyxcbiAgICAvKF58W15cXFxcXSl7PVtcXFNcXHNdKj99L1xuICBdXG5cbiAgdmFyXG4gICAgY2FjaGVkQnJhY2tldHMgPSBVTkRFRixcbiAgICBfcmVnZXgsXG4gICAgX2NhY2hlID0gW10sXG4gICAgX3NldHRpbmdzXG5cbiAgZnVuY3Rpb24gX2xvb3BiYWNrIChyZSkgeyByZXR1cm4gcmUgfVxuXG4gIGZ1bmN0aW9uIF9yZXdyaXRlIChyZSwgYnApIHtcbiAgICBpZiAoIWJwKSBicCA9IF9jYWNoZVxuICAgIHJldHVybiBuZXcgUmVnRXhwKFxuICAgICAgcmUuc291cmNlLnJlcGxhY2UoL3svZywgYnBbMl0pLnJlcGxhY2UoL30vZywgYnBbM10pLCByZS5nbG9iYWwgPyBSRUdMT0IgOiAnJ1xuICAgIClcbiAgfVxuXG4gIGZ1bmN0aW9uIF9jcmVhdGUgKHBhaXIpIHtcbiAgICBpZiAocGFpciA9PT0gREVGQVVMVCkgcmV0dXJuIF9wYWlyc1xuXG4gICAgdmFyIGFyciA9IHBhaXIuc3BsaXQoJyAnKVxuXG4gICAgaWYgKGFyci5sZW5ndGggIT09IDIgfHwgL1tcXHgwMC1cXHgxRjw+YS16QS1aMC05J1wiLDtcXFxcXS8udGVzdChwYWlyKSkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vuc3VwcG9ydGVkIGJyYWNrZXRzIFwiJyArIHBhaXIgKyAnXCInKVxuICAgIH1cbiAgICBhcnIgPSBhcnIuY29uY2F0KHBhaXIucmVwbGFjZSgvKD89W1tcXF0oKSorPy5eJHxdKS9nLCAnXFxcXCcpLnNwbGl0KCcgJykpXG5cbiAgICBhcnJbNF0gPSBfcmV3cml0ZShhcnJbMV0ubGVuZ3RoID4gMSA/IC97W1xcU1xcc10qP30vIDogX3BhaXJzWzRdLCBhcnIpXG4gICAgYXJyWzVdID0gX3Jld3JpdGUocGFpci5sZW5ndGggPiAzID8gL1xcXFwoe3x9KS9nIDogX3BhaXJzWzVdLCBhcnIpXG4gICAgYXJyWzZdID0gX3Jld3JpdGUoX3BhaXJzWzZdLCBhcnIpXG4gICAgYXJyWzddID0gUmVnRXhwKCdcXFxcXFxcXCgnICsgYXJyWzNdICsgJyl8KFtbKHtdKXwoJyArIGFyclszXSArICcpfCcgKyBTX1FCTE9DS1MsIFJFR0xPQilcbiAgICBhcnJbOF0gPSBwYWlyXG4gICAgcmV0dXJuIGFyclxuICB9XG5cbiAgZnVuY3Rpb24gX2JyYWNrZXRzIChyZU9ySWR4KSB7XG4gICAgcmV0dXJuIHJlT3JJZHggaW5zdGFuY2VvZiBSZWdFeHAgPyBfcmVnZXgocmVPcklkeCkgOiBfY2FjaGVbcmVPcklkeF1cbiAgfVxuXG4gIF9icmFja2V0cy5zcGxpdCA9IGZ1bmN0aW9uIHNwbGl0IChzdHIsIHRtcGwsIF9icCkge1xuICAgIC8vIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBfYnAgaXMgZm9yIHRoZSBjb21waWxlclxuICAgIGlmICghX2JwKSBfYnAgPSBfY2FjaGVcblxuICAgIHZhclxuICAgICAgcGFydHMgPSBbXSxcbiAgICAgIG1hdGNoLFxuICAgICAgaXNleHByLFxuICAgICAgc3RhcnQsXG4gICAgICBwb3MsXG4gICAgICByZSA9IF9icFs2XVxuXG4gICAgaXNleHByID0gc3RhcnQgPSByZS5sYXN0SW5kZXggPSAwXG5cbiAgICB3aGlsZSAoKG1hdGNoID0gcmUuZXhlYyhzdHIpKSkge1xuXG4gICAgICBwb3MgPSBtYXRjaC5pbmRleFxuXG4gICAgICBpZiAoaXNleHByKSB7XG5cbiAgICAgICAgaWYgKG1hdGNoWzJdKSB7XG4gICAgICAgICAgcmUubGFzdEluZGV4ID0gc2tpcEJyYWNlcyhzdHIsIG1hdGNoWzJdLCByZS5sYXN0SW5kZXgpXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW1hdGNoWzNdKSB7XG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIW1hdGNoWzFdKSB7XG4gICAgICAgIHVuZXNjYXBlU3RyKHN0ci5zbGljZShzdGFydCwgcG9zKSlcbiAgICAgICAgc3RhcnQgPSByZS5sYXN0SW5kZXhcbiAgICAgICAgcmUgPSBfYnBbNiArIChpc2V4cHIgXj0gMSldXG4gICAgICAgIHJlLmxhc3RJbmRleCA9IHN0YXJ0XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHN0ciAmJiBzdGFydCA8IHN0ci5sZW5ndGgpIHtcbiAgICAgIHVuZXNjYXBlU3RyKHN0ci5zbGljZShzdGFydCkpXG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcnRzXG5cbiAgICBmdW5jdGlvbiB1bmVzY2FwZVN0ciAocykge1xuICAgICAgaWYgKHRtcGwgfHwgaXNleHByKSB7XG4gICAgICAgIHBhcnRzLnB1c2gocyAmJiBzLnJlcGxhY2UoX2JwWzVdLCAnJDEnKSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcnRzLnB1c2gocylcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBza2lwQnJhY2VzIChzLCBjaCwgaXgpIHtcbiAgICAgIHZhclxuICAgICAgICBtYXRjaCxcbiAgICAgICAgcmVjY2ggPSBGSU5EQlJBQ0VTW2NoXVxuXG4gICAgICByZWNjaC5sYXN0SW5kZXggPSBpeFxuICAgICAgaXggPSAxXG4gICAgICB3aGlsZSAoKG1hdGNoID0gcmVjY2guZXhlYyhzKSkpIHtcbiAgICAgICAgaWYgKG1hdGNoWzFdICYmXG4gICAgICAgICAgIShtYXRjaFsxXSA9PT0gY2ggPyArK2l4IDogLS1peCkpIGJyZWFrXG4gICAgICB9XG4gICAgICByZXR1cm4gaXggPyBzLmxlbmd0aCA6IHJlY2NoLmxhc3RJbmRleFxuICAgIH1cbiAgfVxuXG4gIF9icmFja2V0cy5oYXNFeHByID0gZnVuY3Rpb24gaGFzRXhwciAoc3RyKSB7XG4gICAgcmV0dXJuIF9jYWNoZVs0XS50ZXN0KHN0cilcbiAgfVxuXG4gIF9icmFja2V0cy5sb29wS2V5cyA9IGZ1bmN0aW9uIGxvb3BLZXlzIChleHByKSB7XG4gICAgdmFyIG0gPSBleHByLm1hdGNoKF9jYWNoZVs5XSlcblxuICAgIHJldHVybiBtXG4gICAgICA/IHsga2V5OiBtWzFdLCBwb3M6IG1bMl0sIHZhbDogX2NhY2hlWzBdICsgbVszXS50cmltKCkgKyBfY2FjaGVbMV0gfVxuICAgICAgOiB7IHZhbDogZXhwci50cmltKCkgfVxuICB9XG5cbiAgX2JyYWNrZXRzLmFycmF5ID0gZnVuY3Rpb24gYXJyYXkgKHBhaXIpIHtcbiAgICByZXR1cm4gcGFpciA/IF9jcmVhdGUocGFpcikgOiBfY2FjaGVcbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZXNldCAocGFpcikge1xuICAgIGlmICgocGFpciB8fCAocGFpciA9IERFRkFVTFQpKSAhPT0gX2NhY2hlWzhdKSB7XG4gICAgICBfY2FjaGUgPSBfY3JlYXRlKHBhaXIpXG4gICAgICBfcmVnZXggPSBwYWlyID09PSBERUZBVUxUID8gX2xvb3BiYWNrIDogX3Jld3JpdGVcbiAgICAgIF9jYWNoZVs5XSA9IF9yZWdleChfcGFpcnNbOV0pXG4gICAgfVxuICAgIGNhY2hlZEJyYWNrZXRzID0gcGFpclxuICB9XG5cbiAgZnVuY3Rpb24gX3NldFNldHRpbmdzIChvKSB7XG4gICAgdmFyIGJcblxuICAgIG8gPSBvIHx8IHt9XG4gICAgYiA9IG8uYnJhY2tldHNcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgJ2JyYWNrZXRzJywge1xuICAgICAgc2V0OiBfcmVzZXQsXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNhY2hlZEJyYWNrZXRzIH0sXG4gICAgICBlbnVtZXJhYmxlOiB0cnVlXG4gICAgfSlcbiAgICBfc2V0dGluZ3MgPSBvXG4gICAgX3Jlc2V0KGIpXG4gIH1cblxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoX2JyYWNrZXRzLCAnc2V0dGluZ3MnLCB7XG4gICAgc2V0OiBfc2V0U2V0dGluZ3MsXG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBfc2V0dGluZ3MgfVxuICB9KVxuXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBpbiB0aGUgYnJvd3NlciByaW90IGlzIGFsd2F5cyBpbiB0aGUgc2NvcGUgKi9cbiAgX2JyYWNrZXRzLnNldHRpbmdzID0gdHlwZW9mIHJpb3QgIT09ICd1bmRlZmluZWQnICYmIHJpb3Quc2V0dGluZ3MgfHwge31cbiAgX2JyYWNrZXRzLnNldCA9IF9yZXNldFxuXG4gIF9icmFja2V0cy5SX1NUUklOR1MgPSBSX1NUUklOR1NcbiAgX2JyYWNrZXRzLlJfTUxDT01NUyA9IFJfTUxDT01NU1xuICBfYnJhY2tldHMuU19RQkxPQ0tTID0gU19RQkxPQ0tTXG5cbiAgcmV0dXJuIF9icmFja2V0c1xuXG59KSgpXG5cbi8qKlxuICogQG1vZHVsZSB0bXBsXG4gKlxuICogdG1wbCAgICAgICAgICAtIFJvb3QgZnVuY3Rpb24sIHJldHVybnMgdGhlIHRlbXBsYXRlIHZhbHVlLCByZW5kZXIgd2l0aCBkYXRhXG4gKiB0bXBsLmhhc0V4cHIgIC0gVGVzdCB0aGUgZXhpc3RlbmNlIG9mIGEgZXhwcmVzc2lvbiBpbnNpZGUgYSBzdHJpbmdcbiAqIHRtcGwubG9vcEtleXMgLSBHZXQgdGhlIGtleXMgZm9yIGFuICdlYWNoJyBsb29wICh1c2VkIGJ5IGBfZWFjaGApXG4gKi9cblxudmFyIHRtcGwgPSAoZnVuY3Rpb24gKCkge1xuXG4gIHZhciBfY2FjaGUgPSB7fVxuXG4gIGZ1bmN0aW9uIF90bXBsIChzdHIsIGRhdGEpIHtcbiAgICBpZiAoIXN0cikgcmV0dXJuIHN0clxuXG4gICAgcmV0dXJuIChfY2FjaGVbc3RyXSB8fCAoX2NhY2hlW3N0cl0gPSBfY3JlYXRlKHN0cikpKS5jYWxsKGRhdGEsIF9sb2dFcnIpXG4gIH1cblxuICBfdG1wbC5oYXZlUmF3ID0gYnJhY2tldHMuaGFzUmF3XG5cbiAgX3RtcGwuaGFzRXhwciA9IGJyYWNrZXRzLmhhc0V4cHJcblxuICBfdG1wbC5sb29wS2V5cyA9IGJyYWNrZXRzLmxvb3BLZXlzXG5cbiAgX3RtcGwuZXJyb3JIYW5kbGVyID0gbnVsbFxuXG4gIGZ1bmN0aW9uIF9sb2dFcnIgKGVyciwgY3R4KSB7XG5cbiAgICBpZiAoX3RtcGwuZXJyb3JIYW5kbGVyKSB7XG5cbiAgICAgIGVyci5yaW90RGF0YSA9IHtcbiAgICAgICAgdGFnTmFtZTogY3R4ICYmIGN0eC5yb290ICYmIGN0eC5yb290LnRhZ05hbWUsXG4gICAgICAgIF9yaW90X2lkOiBjdHggJiYgY3R4Ll9yaW90X2lkICAvL2VzbGludC1kaXNhYmxlLWxpbmUgY2FtZWxjYXNlXG4gICAgICB9XG4gICAgICBfdG1wbC5lcnJvckhhbmRsZXIoZXJyKVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIF9jcmVhdGUgKHN0cikge1xuICAgIHZhciBleHByID0gX2dldFRtcGwoc3RyKVxuXG4gICAgaWYgKGV4cHIuc2xpY2UoMCwgMTEpICE9PSAndHJ5e3JldHVybiAnKSBleHByID0gJ3JldHVybiAnICsgZXhwclxuXG4vKiBlc2xpbnQtZGlzYWJsZSAqL1xuXG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbignRScsIGV4cHIgKyAnOycpXG4vKiBlc2xpbnQtZW5hYmxlICovXG4gIH1cblxuICB2YXJcbiAgICBDSF9JREVYUFIgPSAnXFx1MjA1NycsXG4gICAgUkVfQ1NOQU1FID0gL14oPzooLT9bX0EtWmEtelxceEEwLVxceEZGXVstXFx3XFx4QTAtXFx4RkZdKil8XFx1MjA1NyhcXGQrKX4pOi8sXG4gICAgUkVfUUJMT0NLID0gUmVnRXhwKGJyYWNrZXRzLlNfUUJMT0NLUywgJ2cnKSxcbiAgICBSRV9EUVVPVEUgPSAvXFx1MjA1Ny9nLFxuICAgIFJFX1FCTUFSSyA9IC9cXHUyMDU3KFxcZCspfi9nXG5cbiAgZnVuY3Rpb24gX2dldFRtcGwgKHN0cikge1xuICAgIHZhclxuICAgICAgcXN0ciA9IFtdLFxuICAgICAgZXhwcixcbiAgICAgIHBhcnRzID0gYnJhY2tldHMuc3BsaXQoc3RyLnJlcGxhY2UoUkVfRFFVT1RFLCAnXCInKSwgMSlcblxuICAgIGlmIChwYXJ0cy5sZW5ndGggPiAyIHx8IHBhcnRzWzBdKSB7XG4gICAgICB2YXIgaSwgaiwgbGlzdCA9IFtdXG5cbiAgICAgIGZvciAoaSA9IGogPSAwOyBpIDwgcGFydHMubGVuZ3RoOyArK2kpIHtcblxuICAgICAgICBleHByID0gcGFydHNbaV1cblxuICAgICAgICBpZiAoZXhwciAmJiAoZXhwciA9IGkgJiAxXG5cbiAgICAgICAgICAgID8gX3BhcnNlRXhwcihleHByLCAxLCBxc3RyKVxuXG4gICAgICAgICAgICA6ICdcIicgKyBleHByXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFwvZywgJ1xcXFxcXFxcJylcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxyXFxuP3xcXG4vZywgJ1xcXFxuJylcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpICtcbiAgICAgICAgICAgICAgJ1wiJ1xuXG4gICAgICAgICAgKSkgbGlzdFtqKytdID0gZXhwclxuXG4gICAgICB9XG5cbiAgICAgIGV4cHIgPSBqIDwgMiA/IGxpc3RbMF1cbiAgICAgICAgICAgOiAnWycgKyBsaXN0LmpvaW4oJywnKSArICddLmpvaW4oXCJcIiknXG5cbiAgICB9IGVsc2Uge1xuXG4gICAgICBleHByID0gX3BhcnNlRXhwcihwYXJ0c1sxXSwgMCwgcXN0cilcbiAgICB9XG5cbiAgICBpZiAocXN0clswXSkge1xuICAgICAgZXhwciA9IGV4cHIucmVwbGFjZShSRV9RQk1BUkssIGZ1bmN0aW9uIChfLCBwb3MpIHtcbiAgICAgICAgcmV0dXJuIHFzdHJbcG9zXVxuICAgICAgICAgIC5yZXBsYWNlKC9cXHIvZywgJ1xcXFxyJylcbiAgICAgICAgICAucmVwbGFjZSgvXFxuL2csICdcXFxcbicpXG4gICAgICB9KVxuICAgIH1cbiAgICByZXR1cm4gZXhwclxuICB9XG5cbiAgdmFyXG4gICAgUkVfQlJFTkQgPSB7XG4gICAgICAnKCc6IC9bKCldL2csXG4gICAgICAnWyc6IC9bW1xcXV0vZyxcbiAgICAgICd7JzogL1t7fV0vZ1xuICAgIH1cblxuICBmdW5jdGlvbiBfcGFyc2VFeHByIChleHByLCBhc1RleHQsIHFzdHIpIHtcblxuICAgIGV4cHIgPSBleHByXG4gICAgICAgICAgLnJlcGxhY2UoUkVfUUJMT0NLLCBmdW5jdGlvbiAocywgZGl2KSB7XG4gICAgICAgICAgICByZXR1cm4gcy5sZW5ndGggPiAyICYmICFkaXYgPyBDSF9JREVYUFIgKyAocXN0ci5wdXNoKHMpIC0gMSkgKyAnficgOiBzXG4gICAgICAgICAgfSlcbiAgICAgICAgICAucmVwbGFjZSgvXFxzKy9nLCAnICcpLnRyaW0oKVxuICAgICAgICAgIC5yZXBsYWNlKC9cXCA/KFtbXFwoe30sP1xcLjpdKVxcID8vZywgJyQxJylcblxuICAgIGlmIChleHByKSB7XG4gICAgICB2YXJcbiAgICAgICAgbGlzdCA9IFtdLFxuICAgICAgICBjbnQgPSAwLFxuICAgICAgICBtYXRjaFxuXG4gICAgICB3aGlsZSAoZXhwciAmJlxuICAgICAgICAgICAgKG1hdGNoID0gZXhwci5tYXRjaChSRV9DU05BTUUpKSAmJlxuICAgICAgICAgICAgIW1hdGNoLmluZGV4XG4gICAgICAgICkge1xuICAgICAgICB2YXJcbiAgICAgICAgICBrZXksXG4gICAgICAgICAganNiLFxuICAgICAgICAgIHJlID0gLyx8KFtbeyhdKXwkL2dcblxuICAgICAgICBleHByID0gUmVnRXhwLnJpZ2h0Q29udGV4dFxuICAgICAgICBrZXkgID0gbWF0Y2hbMl0gPyBxc3RyW21hdGNoWzJdXS5zbGljZSgxLCAtMSkudHJpbSgpLnJlcGxhY2UoL1xccysvZywgJyAnKSA6IG1hdGNoWzFdXG5cbiAgICAgICAgd2hpbGUgKGpzYiA9IChtYXRjaCA9IHJlLmV4ZWMoZXhwcikpWzFdKSBza2lwQnJhY2VzKGpzYiwgcmUpXG5cbiAgICAgICAganNiICA9IGV4cHIuc2xpY2UoMCwgbWF0Y2guaW5kZXgpXG4gICAgICAgIGV4cHIgPSBSZWdFeHAucmlnaHRDb250ZXh0XG5cbiAgICAgICAgbGlzdFtjbnQrK10gPSBfd3JhcEV4cHIoanNiLCAxLCBrZXkpXG4gICAgICB9XG5cbiAgICAgIGV4cHIgPSAhY250ID8gX3dyYXBFeHByKGV4cHIsIGFzVGV4dClcbiAgICAgICAgICAgOiBjbnQgPiAxID8gJ1snICsgbGlzdC5qb2luKCcsJykgKyAnXS5qb2luKFwiIFwiKS50cmltKCknIDogbGlzdFswXVxuICAgIH1cbiAgICByZXR1cm4gZXhwclxuXG4gICAgZnVuY3Rpb24gc2tpcEJyYWNlcyAoY2gsIHJlKSB7XG4gICAgICB2YXJcbiAgICAgICAgbW0sXG4gICAgICAgIGx2ID0gMSxcbiAgICAgICAgaXIgPSBSRV9CUkVORFtjaF1cblxuICAgICAgaXIubGFzdEluZGV4ID0gcmUubGFzdEluZGV4XG4gICAgICB3aGlsZSAobW0gPSBpci5leGVjKGV4cHIpKSB7XG4gICAgICAgIGlmIChtbVswXSA9PT0gY2gpICsrbHZcbiAgICAgICAgZWxzZSBpZiAoIS0tbHYpIGJyZWFrXG4gICAgICB9XG4gICAgICByZS5sYXN0SW5kZXggPSBsdiA/IGV4cHIubGVuZ3RoIDogaXIubGFzdEluZGV4XG4gICAgfVxuICB9XG5cbiAgLy8gaXN0YW5idWwgaWdub3JlIG5leHQ6IG5vdCBib3RoXG4gIHZhciAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxlblxuICAgIEpTX0NPTlRFWFQgPSAnXCJpbiB0aGlzP3RoaXM6JyArICh0eXBlb2Ygd2luZG93ICE9PSAnb2JqZWN0JyA/ICdnbG9iYWwnIDogJ3dpbmRvdycpICsgJykuJyxcbiAgICBKU19WQVJOQU1FID0gL1sse11bJFxcd10rOnwoXiAqfFteJFxcd1xcLl0pKD8hKD86dHlwZW9mfHRydWV8ZmFsc2V8bnVsbHx1bmRlZmluZWR8aW58aW5zdGFuY2VvZnxpcyg/OkZpbml0ZXxOYU4pfHZvaWR8TmFOfG5ld3xEYXRlfFJlZ0V4cHxNYXRoKSg/IVskXFx3XSkpKFskX0EtWmEtel1bJFxcd10qKS9nLFxuICAgIEpTX05PUFJPUFMgPSAvXig/PShcXC5bJFxcd10rKSlcXDEoPzpbXi5bKF18JCkvXG5cbiAgZnVuY3Rpb24gX3dyYXBFeHByIChleHByLCBhc1RleHQsIGtleSkge1xuICAgIHZhciB0YlxuXG4gICAgZXhwciA9IGV4cHIucmVwbGFjZShKU19WQVJOQU1FLCBmdW5jdGlvbiAobWF0Y2gsIHAsIG12YXIsIHBvcywgcykge1xuICAgICAgaWYgKG12YXIpIHtcbiAgICAgICAgcG9zID0gdGIgPyAwIDogcG9zICsgbWF0Y2gubGVuZ3RoXG5cbiAgICAgICAgaWYgKG12YXIgIT09ICd0aGlzJyAmJiBtdmFyICE9PSAnZ2xvYmFsJyAmJiBtdmFyICE9PSAnd2luZG93Jykge1xuICAgICAgICAgIG1hdGNoID0gcCArICcoXCInICsgbXZhciArIEpTX0NPTlRFWFQgKyBtdmFyXG4gICAgICAgICAgaWYgKHBvcykgdGIgPSAocyA9IHNbcG9zXSkgPT09ICcuJyB8fCBzID09PSAnKCcgfHwgcyA9PT0gJ1snXG4gICAgICAgIH0gZWxzZSBpZiAocG9zKSB7XG4gICAgICAgICAgdGIgPSAhSlNfTk9QUk9QUy50ZXN0KHMuc2xpY2UocG9zKSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG1hdGNoXG4gICAgfSlcblxuICAgIGlmICh0Yikge1xuICAgICAgZXhwciA9ICd0cnl7cmV0dXJuICcgKyBleHByICsgJ31jYXRjaChlKXtFKGUsdGhpcyl9J1xuICAgIH1cblxuICAgIGlmIChrZXkpIHtcblxuICAgICAgZXhwciA9ICh0YlxuICAgICAgICAgID8gJ2Z1bmN0aW9uKCl7JyArIGV4cHIgKyAnfS5jYWxsKHRoaXMpJyA6ICcoJyArIGV4cHIgKyAnKSdcbiAgICAgICAgKSArICc/XCInICsga2V5ICsgJ1wiOlwiXCInXG5cbiAgICB9IGVsc2UgaWYgKGFzVGV4dCkge1xuXG4gICAgICBleHByID0gJ2Z1bmN0aW9uKHYpeycgKyAodGJcbiAgICAgICAgICA/IGV4cHIucmVwbGFjZSgncmV0dXJuICcsICd2PScpIDogJ3Y9KCcgKyBleHByICsgJyknXG4gICAgICAgICkgKyAnO3JldHVybiB2fHx2PT09MD92OlwiXCJ9LmNhbGwodGhpcyknXG4gICAgfVxuXG4gICAgcmV0dXJuIGV4cHJcbiAgfVxuXG4gIC8vIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBjb21wYXRpYmlsaXR5IGZpeCBmb3IgYmV0YSB2ZXJzaW9uc1xuICBfdG1wbC5wYXJzZSA9IGZ1bmN0aW9uIChzKSB7IHJldHVybiBzIH1cblxuICBfdG1wbC52ZXJzaW9uID0gYnJhY2tldHMudmVyc2lvbiA9ICd2Mi40LjAnXG5cbiAgcmV0dXJuIF90bXBsXG5cbn0pKClcblxuLypcbiAgbGliL2Jyb3dzZXIvdGFnL21rZG9tLmpzXG5cbiAgSW5jbHVkZXMgaGFja3MgbmVlZGVkIGZvciB0aGUgSW50ZXJuZXQgRXhwbG9yZXIgdmVyc2lvbiA5IGFuZCBiZWxvd1xuICBTZWU6IGh0dHA6Ly9rYW5nYXguZ2l0aHViLmlvL2NvbXBhdC10YWJsZS9lczUvI2llOFxuICAgICAgIGh0dHA6Ly9jb2RlcGxhbmV0LmlvL2Ryb3BwaW5nLWllOC9cbiovXG52YXIgbWtkb20gPSAoZnVuY3Rpb24gX21rZG9tKCkge1xuICB2YXJcbiAgICByZUhhc1lpZWxkICA9IC88eWllbGRcXGIvaSxcbiAgICByZVlpZWxkQWxsICA9IC88eWllbGRcXHMqKD86XFwvPnw+KFtcXFNcXHNdKj8pPFxcL3lpZWxkXFxzKj58PikvaWcsXG4gICAgcmVZaWVsZFNyYyAgPSAvPHlpZWxkXFxzK3RvPVsnXCJdKFteJ1wiPl0qKVsnXCJdXFxzKj4oW1xcU1xcc10qPyk8XFwveWllbGRcXHMqPi9pZyxcbiAgICByZVlpZWxkRGVzdCA9IC88eWllbGRcXHMrZnJvbT1bJ1wiXT8oWy1cXHddKylbJ1wiXT9cXHMqKD86XFwvPnw+KFtcXFNcXHNdKj8pPFxcL3lpZWxkXFxzKj4pL2lnXG4gIHZhclxuICAgIHJvb3RFbHMgPSB7IHRyOiAndGJvZHknLCB0aDogJ3RyJywgdGQ6ICd0cicsIGNvbDogJ2NvbGdyb3VwJyB9LFxuICAgIHRibFRhZ3MgPSBJRV9WRVJTSU9OICYmIElFX1ZFUlNJT04gPCAxMFxuICAgICAgPyBTUEVDSUFMX1RBR1NfUkVHRVggOiAvXig/OnQoPzpib2R5fGhlYWR8Zm9vdHxbcmhkXSl8Y2FwdGlvbnxjb2woPzpncm91cCk/KSQvXG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBET00gZWxlbWVudCB0byB3cmFwIHRoZSBnaXZlbiBjb250ZW50LiBOb3JtYWxseSBhbiBgRElWYCwgYnV0IGNhbiBiZVxuICAgKiBhbHNvIGEgYFRBQkxFYCwgYFNFTEVDVGAsIGBUQk9EWWAsIGBUUmAsIG9yIGBDT0xHUk9VUGAgZWxlbWVudC5cbiAgICpcbiAgICogQHBhcmFtICAge3N0cmluZ30gdGVtcGwgIC0gVGhlIHRlbXBsYXRlIGNvbWluZyBmcm9tIHRoZSBjdXN0b20gdGFnIGRlZmluaXRpb25cbiAgICogQHBhcmFtICAge3N0cmluZ30gW2h0bWxdIC0gSFRNTCBjb250ZW50IHRoYXQgY29tZXMgZnJvbSB0aGUgRE9NIGVsZW1lbnQgd2hlcmUgeW91XG4gICAqICAgICAgICAgICB3aWxsIG1vdW50IHRoZSB0YWcsIG1vc3RseSB0aGUgb3JpZ2luYWwgdGFnIGluIHRoZSBwYWdlXG4gICAqIEByZXR1cm5zIHtIVE1MRWxlbWVudH0gRE9NIGVsZW1lbnQgd2l0aCBfdGVtcGxfIG1lcmdlZCB0aHJvdWdoIGBZSUVMRGAgd2l0aCB0aGUgX2h0bWxfLlxuICAgKi9cbiAgZnVuY3Rpb24gX21rZG9tKHRlbXBsLCBodG1sKSB7XG4gICAgdmFyXG4gICAgICBtYXRjaCAgID0gdGVtcGwgJiYgdGVtcGwubWF0Y2goL15cXHMqPChbLVxcd10rKS8pLFxuICAgICAgdGFnTmFtZSA9IG1hdGNoICYmIG1hdGNoWzFdLnRvTG93ZXJDYXNlKCksXG4gICAgICBlbCA9IG1rRWwoJ2RpdicsIGlzU1ZHVGFnKHRhZ05hbWUpKVxuXG4gICAgLy8gcmVwbGFjZSBhbGwgdGhlIHlpZWxkIHRhZ3Mgd2l0aCB0aGUgdGFnIGlubmVyIGh0bWxcbiAgICB0ZW1wbCA9IHJlcGxhY2VZaWVsZCh0ZW1wbCwgaHRtbClcblxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgaWYgKHRibFRhZ3MudGVzdCh0YWdOYW1lKSlcbiAgICAgIGVsID0gc3BlY2lhbFRhZ3MoZWwsIHRlbXBsLCB0YWdOYW1lKVxuICAgIGVsc2VcbiAgICAgIHNldElubmVySFRNTChlbCwgdGVtcGwpXG5cbiAgICBlbC5zdHViID0gdHJ1ZVxuXG4gICAgcmV0dXJuIGVsXG4gIH1cblxuICAvKlxuICAgIENyZWF0ZXMgdGhlIHJvb3QgZWxlbWVudCBmb3IgdGFibGUgb3Igc2VsZWN0IGNoaWxkIGVsZW1lbnRzOlxuICAgIHRyL3RoL3RkL3RoZWFkL3Rmb290L3Rib2R5L2NhcHRpb24vY29sL2NvbGdyb3VwL29wdGlvbi9vcHRncm91cFxuICAqL1xuICBmdW5jdGlvbiBzcGVjaWFsVGFncyhlbCwgdGVtcGwsIHRhZ05hbWUpIHtcbiAgICB2YXJcbiAgICAgIHNlbGVjdCA9IHRhZ05hbWVbMF0gPT09ICdvJyxcbiAgICAgIHBhcmVudCA9IHNlbGVjdCA/ICdzZWxlY3Q+JyA6ICd0YWJsZT4nXG5cbiAgICAvLyB0cmltKCkgaXMgaW1wb3J0YW50IGhlcmUsIHRoaXMgZW5zdXJlcyB3ZSBkb24ndCBoYXZlIGFydGlmYWN0cyxcbiAgICAvLyBzbyB3ZSBjYW4gY2hlY2sgaWYgd2UgaGF2ZSBvbmx5IG9uZSBlbGVtZW50IGluc2lkZSB0aGUgcGFyZW50XG4gICAgZWwuaW5uZXJIVE1MID0gJzwnICsgcGFyZW50ICsgdGVtcGwudHJpbSgpICsgJzwvJyArIHBhcmVudFxuICAgIHBhcmVudCA9IGVsLmZpcnN0Q2hpbGRcblxuICAgIC8vIHJldHVybnMgdGhlIGltbWVkaWF0ZSBwYXJlbnQgaWYgdHIvdGgvdGQvY29sIGlzIHRoZSBvbmx5IGVsZW1lbnQsIGlmIG5vdFxuICAgIC8vIHJldHVybnMgdGhlIHdob2xlIHRyZWUsIGFzIHRoaXMgY2FuIGluY2x1ZGUgYWRkaXRpb25hbCBlbGVtZW50c1xuICAgIGlmIChzZWxlY3QpIHtcbiAgICAgIHBhcmVudC5zZWxlY3RlZEluZGV4ID0gLTEgIC8vIGZvciBJRTksIGNvbXBhdGlibGUgdy9jdXJyZW50IHJpb3QgYmVoYXZpb3JcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gYXZvaWRzIGluc2VydGlvbiBvZiBjb2ludGFpbmVyIGluc2lkZSBjb250YWluZXIgKGV4OiB0Ym9keSBpbnNpZGUgdGJvZHkpXG4gICAgICB2YXIgdG5hbWUgPSByb290RWxzW3RhZ05hbWVdXG4gICAgICBpZiAodG5hbWUgJiYgcGFyZW50LmNoaWxkRWxlbWVudENvdW50ID09PSAxKSBwYXJlbnQgPSAkKHRuYW1lLCBwYXJlbnQpXG4gICAgfVxuICAgIHJldHVybiBwYXJlbnRcbiAgfVxuXG4gIC8qXG4gICAgUmVwbGFjZSB0aGUgeWllbGQgdGFnIGZyb20gYW55IHRhZyB0ZW1wbGF0ZSB3aXRoIHRoZSBpbm5lckhUTUwgb2YgdGhlXG4gICAgb3JpZ2luYWwgdGFnIGluIHRoZSBwYWdlXG4gICovXG4gIGZ1bmN0aW9uIHJlcGxhY2VZaWVsZCh0ZW1wbCwgaHRtbCkge1xuICAgIC8vIGRvIG5vdGhpbmcgaWYgbm8geWllbGRcbiAgICBpZiAoIXJlSGFzWWllbGQudGVzdCh0ZW1wbCkpIHJldHVybiB0ZW1wbFxuXG4gICAgLy8gYmUgY2FyZWZ1bCB3aXRoICMxMzQzIC0gc3RyaW5nIG9uIHRoZSBzb3VyY2UgaGF2aW5nIGAkMWBcbiAgICB2YXIgc3JjID0ge31cblxuICAgIGh0bWwgPSBodG1sICYmIGh0bWwucmVwbGFjZShyZVlpZWxkU3JjLCBmdW5jdGlvbiAoXywgcmVmLCB0ZXh0KSB7XG4gICAgICBzcmNbcmVmXSA9IHNyY1tyZWZdIHx8IHRleHQgICAvLyBwcmVzZXJ2ZSBmaXJzdCBkZWZpbml0aW9uXG4gICAgICByZXR1cm4gJydcbiAgICB9KS50cmltKClcblxuICAgIHJldHVybiB0ZW1wbFxuICAgICAgLnJlcGxhY2UocmVZaWVsZERlc3QsIGZ1bmN0aW9uIChfLCByZWYsIGRlZikgeyAgLy8geWllbGQgd2l0aCBmcm9tIC0gdG8gYXR0cnNcbiAgICAgICAgcmV0dXJuIHNyY1tyZWZdIHx8IGRlZiB8fCAnJ1xuICAgICAgfSlcbiAgICAgIC5yZXBsYWNlKHJlWWllbGRBbGwsIGZ1bmN0aW9uIChfLCBkZWYpIHsgICAgICAgIC8vIHlpZWxkIHdpdGhvdXQgYW55IFwiZnJvbVwiXG4gICAgICAgIHJldHVybiBodG1sIHx8IGRlZiB8fCAnJ1xuICAgICAgfSlcbiAgfVxuXG4gIHJldHVybiBfbWtkb21cblxufSkoKVxuXG4vKipcbiAqIENvbnZlcnQgdGhlIGl0ZW0gbG9vcGVkIGludG8gYW4gb2JqZWN0IHVzZWQgdG8gZXh0ZW5kIHRoZSBjaGlsZCB0YWcgcHJvcGVydGllc1xuICogQHBhcmFtICAgeyBPYmplY3QgfSBleHByIC0gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIGtleXMgdXNlZCB0byBleHRlbmQgdGhlIGNoaWxkcmVuIHRhZ3NcbiAqIEBwYXJhbSAgIHsgKiB9IGtleSAtIHZhbHVlIHRvIGFzc2lnbiB0byB0aGUgbmV3IG9iamVjdCByZXR1cm5lZFxuICogQHBhcmFtICAgeyAqIH0gdmFsIC0gdmFsdWUgY29udGFpbmluZyB0aGUgcG9zaXRpb24gb2YgdGhlIGl0ZW0gaW4gdGhlIGFycmF5XG4gKiBAcmV0dXJucyB7IE9iamVjdCB9IC0gbmV3IG9iamVjdCBjb250YWluaW5nIHRoZSB2YWx1ZXMgb2YgdGhlIG9yaWdpbmFsIGl0ZW1cbiAqXG4gKiBUaGUgdmFyaWFibGVzICdrZXknIGFuZCAndmFsJyBhcmUgYXJiaXRyYXJ5LlxuICogVGhleSBkZXBlbmQgb24gdGhlIGNvbGxlY3Rpb24gdHlwZSBsb29wZWQgKEFycmF5LCBPYmplY3QpXG4gKiBhbmQgb24gdGhlIGV4cHJlc3Npb24gdXNlZCBvbiB0aGUgZWFjaCB0YWdcbiAqXG4gKi9cbmZ1bmN0aW9uIG1raXRlbShleHByLCBrZXksIHZhbCkge1xuICB2YXIgaXRlbSA9IHt9XG4gIGl0ZW1bZXhwci5rZXldID0ga2V5XG4gIGlmIChleHByLnBvcykgaXRlbVtleHByLnBvc10gPSB2YWxcbiAgcmV0dXJuIGl0ZW1cbn1cblxuLyoqXG4gKiBVbm1vdW50IHRoZSByZWR1bmRhbnQgdGFnc1xuICogQHBhcmFtICAgeyBBcnJheSB9IGl0ZW1zIC0gYXJyYXkgY29udGFpbmluZyB0aGUgY3VycmVudCBpdGVtcyB0byBsb29wXG4gKiBAcGFyYW0gICB7IEFycmF5IH0gdGFncyAtIGFycmF5IGNvbnRhaW5pbmcgYWxsIHRoZSBjaGlsZHJlbiB0YWdzXG4gKi9cbmZ1bmN0aW9uIHVubW91bnRSZWR1bmRhbnQoaXRlbXMsIHRhZ3MpIHtcblxuICB2YXIgaSA9IHRhZ3MubGVuZ3RoLFxuICAgIGogPSBpdGVtcy5sZW5ndGgsXG4gICAgdFxuXG4gIHdoaWxlIChpID4gaikge1xuICAgIHQgPSB0YWdzWy0taV1cbiAgICB0YWdzLnNwbGljZShpLCAxKVxuICAgIHQudW5tb3VudCgpXG4gIH1cbn1cblxuLyoqXG4gKiBNb3ZlIHRoZSBuZXN0ZWQgY3VzdG9tIHRhZ3MgaW4gbm9uIGN1c3RvbSBsb29wIHRhZ3NcbiAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gY2hpbGQgLSBub24gY3VzdG9tIGxvb3AgdGFnXG4gKiBAcGFyYW0gICB7IE51bWJlciB9IGkgLSBjdXJyZW50IHBvc2l0aW9uIG9mIHRoZSBsb29wIHRhZ1xuICovXG5mdW5jdGlvbiBtb3ZlTmVzdGVkVGFncyhjaGlsZCwgaSkge1xuICBPYmplY3Qua2V5cyhjaGlsZC50YWdzKS5mb3JFYWNoKGZ1bmN0aW9uKHRhZ05hbWUpIHtcbiAgICB2YXIgdGFnID0gY2hpbGQudGFnc1t0YWdOYW1lXVxuICAgIGlmIChpc0FycmF5KHRhZykpXG4gICAgICBlYWNoKHRhZywgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgbW92ZUNoaWxkVGFnKHQsIHRhZ05hbWUsIGkpXG4gICAgICB9KVxuICAgIGVsc2VcbiAgICAgIG1vdmVDaGlsZFRhZyh0YWcsIHRhZ05hbWUsIGkpXG4gIH0pXG59XG5cbi8qKlxuICogQWRkcyB0aGUgZWxlbWVudHMgZm9yIGEgdmlydHVhbCB0YWdcbiAqIEBwYXJhbSB7IFRhZyB9IHRhZyAtIHRoZSB0YWcgd2hvc2Ugcm9vdCdzIGNoaWxkcmVuIHdpbGwgYmUgaW5zZXJ0ZWQgb3IgYXBwZW5kZWRcbiAqIEBwYXJhbSB7IE5vZGUgfSBzcmMgLSB0aGUgbm9kZSB0aGF0IHdpbGwgZG8gdGhlIGluc2VydGluZyBvciBhcHBlbmRpbmdcbiAqIEBwYXJhbSB7IFRhZyB9IHRhcmdldCAtIG9ubHkgaWYgaW5zZXJ0aW5nLCBpbnNlcnQgYmVmb3JlIHRoaXMgdGFnJ3MgZmlyc3QgY2hpbGRcbiAqL1xuZnVuY3Rpb24gYWRkVmlydHVhbCh0YWcsIHNyYywgdGFyZ2V0KSB7XG4gIHZhciBlbCA9IHRhZy5fcm9vdCwgc2liXG4gIHRhZy5fdmlydHMgPSBbXVxuICB3aGlsZSAoZWwpIHtcbiAgICBzaWIgPSBlbC5uZXh0U2libGluZ1xuICAgIGlmICh0YXJnZXQpXG4gICAgICBzcmMuaW5zZXJ0QmVmb3JlKGVsLCB0YXJnZXQuX3Jvb3QpXG4gICAgZWxzZVxuICAgICAgc3JjLmFwcGVuZENoaWxkKGVsKVxuXG4gICAgdGFnLl92aXJ0cy5wdXNoKGVsKSAvLyBob2xkIGZvciB1bm1vdW50aW5nXG4gICAgZWwgPSBzaWJcbiAgfVxufVxuXG4vKipcbiAqIE1vdmUgdmlydHVhbCB0YWcgYW5kIGFsbCBjaGlsZCBub2Rlc1xuICogQHBhcmFtIHsgVGFnIH0gdGFnIC0gZmlyc3QgY2hpbGQgcmVmZXJlbmNlIHVzZWQgdG8gc3RhcnQgbW92ZVxuICogQHBhcmFtIHsgTm9kZSB9IHNyYyAgLSB0aGUgbm9kZSB0aGF0IHdpbGwgZG8gdGhlIGluc2VydGluZ1xuICogQHBhcmFtIHsgVGFnIH0gdGFyZ2V0IC0gaW5zZXJ0IGJlZm9yZSB0aGlzIHRhZydzIGZpcnN0IGNoaWxkXG4gKiBAcGFyYW0geyBOdW1iZXIgfSBsZW4gLSBob3cgbWFueSBjaGlsZCBub2RlcyB0byBtb3ZlXG4gKi9cbmZ1bmN0aW9uIG1vdmVWaXJ0dWFsKHRhZywgc3JjLCB0YXJnZXQsIGxlbikge1xuICB2YXIgZWwgPSB0YWcuX3Jvb3QsIHNpYiwgaSA9IDBcbiAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgIHNpYiA9IGVsLm5leHRTaWJsaW5nXG4gICAgc3JjLmluc2VydEJlZm9yZShlbCwgdGFyZ2V0Ll9yb290KVxuICAgIGVsID0gc2liXG4gIH1cbn1cblxuXG4vKipcbiAqIE1hbmFnZSB0YWdzIGhhdmluZyB0aGUgJ2VhY2gnXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IGRvbSAtIERPTSBub2RlIHdlIG5lZWQgdG8gbG9vcFxuICogQHBhcmFtICAgeyBUYWcgfSBwYXJlbnQgLSBwYXJlbnQgdGFnIGluc3RhbmNlIHdoZXJlIHRoZSBkb20gbm9kZSBpcyBjb250YWluZWRcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gZXhwciAtIHN0cmluZyBjb250YWluZWQgaW4gdGhlICdlYWNoJyBhdHRyaWJ1dGVcbiAqL1xuZnVuY3Rpb24gX2VhY2goZG9tLCBwYXJlbnQsIGV4cHIpIHtcblxuICAvLyByZW1vdmUgdGhlIGVhY2ggcHJvcGVydHkgZnJvbSB0aGUgb3JpZ2luYWwgdGFnXG4gIHJlbUF0dHIoZG9tLCAnZWFjaCcpXG5cbiAgdmFyIG11c3RSZW9yZGVyID0gdHlwZW9mIGdldEF0dHIoZG9tLCAnbm8tcmVvcmRlcicpICE9PSBUX1NUUklORyB8fCByZW1BdHRyKGRvbSwgJ25vLXJlb3JkZXInKSxcbiAgICB0YWdOYW1lID0gZ2V0VGFnTmFtZShkb20pLFxuICAgIGltcGwgPSBfX3RhZ0ltcGxbdGFnTmFtZV0gfHwgeyB0bXBsOiBnZXRPdXRlckhUTUwoZG9tKSB9LFxuICAgIHVzZVJvb3QgPSBTUEVDSUFMX1RBR1NfUkVHRVgudGVzdCh0YWdOYW1lKSxcbiAgICByb290ID0gZG9tLnBhcmVudE5vZGUsXG4gICAgcmVmID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpLFxuICAgIGNoaWxkID0gZ2V0VGFnKGRvbSksXG4gICAgaXNPcHRpb24gPSB0YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdvcHRpb24nLCAvLyB0aGUgb3B0aW9uIHRhZ3MgbXVzdCBiZSB0cmVhdGVkIGRpZmZlcmVudGx5XG4gICAgdGFncyA9IFtdLFxuICAgIG9sZEl0ZW1zID0gW10sXG4gICAgaGFzS2V5cyxcbiAgICBpc1ZpcnR1YWwgPSBkb20udGFnTmFtZSA9PSAnVklSVFVBTCdcblxuICAvLyBwYXJzZSB0aGUgZWFjaCBleHByZXNzaW9uXG4gIGV4cHIgPSB0bXBsLmxvb3BLZXlzKGV4cHIpXG5cbiAgLy8gaW5zZXJ0IGEgbWFya2VkIHdoZXJlIHRoZSBsb29wIHRhZ3Mgd2lsbCBiZSBpbmplY3RlZFxuICByb290Lmluc2VydEJlZm9yZShyZWYsIGRvbSlcblxuICAvLyBjbGVhbiB0ZW1wbGF0ZSBjb2RlXG4gIHBhcmVudC5vbmUoJ2JlZm9yZS1tb3VudCcsIGZ1bmN0aW9uICgpIHtcblxuICAgIC8vIHJlbW92ZSB0aGUgb3JpZ2luYWwgRE9NIG5vZGVcbiAgICBkb20ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkb20pXG4gICAgaWYgKHJvb3Quc3R1Yikgcm9vdCA9IHBhcmVudC5yb290XG5cbiAgfSkub24oJ3VwZGF0ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAvLyBnZXQgdGhlIG5ldyBpdGVtcyBjb2xsZWN0aW9uXG4gICAgdmFyIGl0ZW1zID0gdG1wbChleHByLnZhbCwgcGFyZW50KSxcbiAgICAgIC8vIGNyZWF0ZSBhIGZyYWdtZW50IHRvIGhvbGQgdGhlIG5ldyBET00gbm9kZXMgdG8gaW5qZWN0IGluIHRoZSBwYXJlbnQgdGFnXG4gICAgICBmcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpXG5cbiAgICAvLyBvYmplY3QgbG9vcC4gYW55IGNoYW5nZXMgY2F1c2UgZnVsbCByZWRyYXdcbiAgICBpZiAoIWlzQXJyYXkoaXRlbXMpKSB7XG4gICAgICBoYXNLZXlzID0gaXRlbXMgfHwgZmFsc2VcbiAgICAgIGl0ZW1zID0gaGFzS2V5cyA/XG4gICAgICAgIE9iamVjdC5rZXlzKGl0ZW1zKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIHJldHVybiBta2l0ZW0oZXhwciwga2V5LCBpdGVtc1trZXldKVxuICAgICAgICB9KSA6IFtdXG4gICAgfVxuXG4gICAgLy8gbG9vcCBhbGwgdGhlIG5ldyBpdGVtc1xuICAgIHZhciBpID0gMCxcbiAgICAgIGl0ZW1zTGVuZ3RoID0gaXRlbXMubGVuZ3RoXG5cbiAgICBmb3IgKDsgaSA8IGl0ZW1zTGVuZ3RoOyBpKyspIHtcbiAgICAgIC8vIHJlb3JkZXIgb25seSBpZiB0aGUgaXRlbXMgYXJlIG9iamVjdHNcbiAgICAgIHZhclxuICAgICAgICBpdGVtID0gaXRlbXNbaV0sXG4gICAgICAgIF9tdXN0UmVvcmRlciA9IG11c3RSZW9yZGVyICYmIHR5cGVvZiBpdGVtID09IFRfT0JKRUNUICYmICFoYXNLZXlzLFxuICAgICAgICBvbGRQb3MgPSBvbGRJdGVtcy5pbmRleE9mKGl0ZW0pLFxuICAgICAgICBwb3MgPSB+b2xkUG9zICYmIF9tdXN0UmVvcmRlciA/IG9sZFBvcyA6IGksXG4gICAgICAgIC8vIGRvZXMgYSB0YWcgZXhpc3QgaW4gdGhpcyBwb3NpdGlvbj9cbiAgICAgICAgdGFnID0gdGFnc1twb3NdXG5cbiAgICAgIGl0ZW0gPSAhaGFzS2V5cyAmJiBleHByLmtleSA/IG1raXRlbShleHByLCBpdGVtLCBpKSA6IGl0ZW1cblxuICAgICAgLy8gbmV3IHRhZ1xuICAgICAgaWYgKFxuICAgICAgICAhX211c3RSZW9yZGVyICYmICF0YWcgLy8gd2l0aCBuby1yZW9yZGVyIHdlIGp1c3QgdXBkYXRlIHRoZSBvbGQgdGFnc1xuICAgICAgICB8fFxuICAgICAgICBfbXVzdFJlb3JkZXIgJiYgIX5vbGRQb3MgfHwgIXRhZyAvLyBieSBkZWZhdWx0IHdlIGFsd2F5cyB0cnkgdG8gcmVvcmRlciB0aGUgRE9NIGVsZW1lbnRzXG4gICAgICApIHtcblxuICAgICAgICB0YWcgPSBuZXcgVGFnKGltcGwsIHtcbiAgICAgICAgICBwYXJlbnQ6IHBhcmVudCxcbiAgICAgICAgICBpc0xvb3A6IHRydWUsXG4gICAgICAgICAgaGFzSW1wbDogISFfX3RhZ0ltcGxbdGFnTmFtZV0sXG4gICAgICAgICAgcm9vdDogdXNlUm9vdCA/IHJvb3QgOiBkb20uY2xvbmVOb2RlKCksXG4gICAgICAgICAgaXRlbTogaXRlbVxuICAgICAgICB9LCBkb20uaW5uZXJIVE1MKVxuXG4gICAgICAgIHRhZy5tb3VudCgpXG5cbiAgICAgICAgaWYgKGlzVmlydHVhbCkgdGFnLl9yb290ID0gdGFnLnJvb3QuZmlyc3RDaGlsZCAvLyBzYXZlIHJlZmVyZW5jZSBmb3IgZnVydGhlciBtb3ZlcyBvciBpbnNlcnRzXG4gICAgICAgIC8vIHRoaXMgdGFnIG11c3QgYmUgYXBwZW5kZWRcbiAgICAgICAgaWYgKGkgPT0gdGFncy5sZW5ndGggfHwgIXRhZ3NbaV0pIHsgLy8gZml4IDE1ODFcbiAgICAgICAgICBpZiAoaXNWaXJ0dWFsKVxuICAgICAgICAgICAgYWRkVmlydHVhbCh0YWcsIGZyYWcpXG4gICAgICAgICAgZWxzZSBmcmFnLmFwcGVuZENoaWxkKHRhZy5yb290KVxuICAgICAgICB9XG4gICAgICAgIC8vIHRoaXMgdGFnIG11c3QgYmUgaW5zZXJ0XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGlmIChpc1ZpcnR1YWwpXG4gICAgICAgICAgICBhZGRWaXJ0dWFsKHRhZywgcm9vdCwgdGFnc1tpXSlcbiAgICAgICAgICBlbHNlIHJvb3QuaW5zZXJ0QmVmb3JlKHRhZy5yb290LCB0YWdzW2ldLnJvb3QpIC8vICMxMzc0IHNvbWUgYnJvd3NlcnMgcmVzZXQgc2VsZWN0ZWQgaGVyZVxuICAgICAgICAgIG9sZEl0ZW1zLnNwbGljZShpLCAwLCBpdGVtKVxuICAgICAgICB9XG5cbiAgICAgICAgdGFncy5zcGxpY2UoaSwgMCwgdGFnKVxuICAgICAgICBwb3MgPSBpIC8vIGhhbmRsZWQgaGVyZSBzbyBubyBtb3ZlXG4gICAgICB9IGVsc2UgdGFnLnVwZGF0ZShpdGVtLCB0cnVlKVxuXG4gICAgICAvLyByZW9yZGVyIHRoZSB0YWcgaWYgaXQncyBub3QgbG9jYXRlZCBpbiBpdHMgcHJldmlvdXMgcG9zaXRpb25cbiAgICAgIGlmIChcbiAgICAgICAgcG9zICE9PSBpICYmIF9tdXN0UmVvcmRlciAmJlxuICAgICAgICB0YWdzW2ldIC8vIGZpeCAxNTgxIHVuYWJsZSB0byByZXByb2R1Y2UgaXQgaW4gYSB0ZXN0IVxuICAgICAgKSB7XG4gICAgICAgIC8vIHVwZGF0ZSB0aGUgRE9NXG4gICAgICAgIGlmIChpc1ZpcnR1YWwpXG4gICAgICAgICAgbW92ZVZpcnR1YWwodGFnLCByb290LCB0YWdzW2ldLCBkb20uY2hpbGROb2Rlcy5sZW5ndGgpXG4gICAgICAgIGVsc2Ugcm9vdC5pbnNlcnRCZWZvcmUodGFnLnJvb3QsIHRhZ3NbaV0ucm9vdClcbiAgICAgICAgLy8gdXBkYXRlIHRoZSBwb3NpdGlvbiBhdHRyaWJ1dGUgaWYgaXQgZXhpc3RzXG4gICAgICAgIGlmIChleHByLnBvcylcbiAgICAgICAgICB0YWdbZXhwci5wb3NdID0gaVxuICAgICAgICAvLyBtb3ZlIHRoZSBvbGQgdGFnIGluc3RhbmNlXG4gICAgICAgIHRhZ3Muc3BsaWNlKGksIDAsIHRhZ3Muc3BsaWNlKHBvcywgMSlbMF0pXG4gICAgICAgIC8vIG1vdmUgdGhlIG9sZCBpdGVtXG4gICAgICAgIG9sZEl0ZW1zLnNwbGljZShpLCAwLCBvbGRJdGVtcy5zcGxpY2UocG9zLCAxKVswXSlcbiAgICAgICAgLy8gaWYgdGhlIGxvb3AgdGFncyBhcmUgbm90IGN1c3RvbVxuICAgICAgICAvLyB3ZSBuZWVkIHRvIG1vdmUgYWxsIHRoZWlyIGN1c3RvbSB0YWdzIGludG8gdGhlIHJpZ2h0IHBvc2l0aW9uXG4gICAgICAgIGlmICghY2hpbGQgJiYgdGFnLnRhZ3MpIG1vdmVOZXN0ZWRUYWdzKHRhZywgaSlcbiAgICAgIH1cblxuICAgICAgLy8gY2FjaGUgdGhlIG9yaWdpbmFsIGl0ZW0gdG8gdXNlIGl0IGluIHRoZSBldmVudHMgYm91bmQgdG8gdGhpcyBub2RlXG4gICAgICAvLyBhbmQgaXRzIGNoaWxkcmVuXG4gICAgICB0YWcuX2l0ZW0gPSBpdGVtXG4gICAgICAvLyBjYWNoZSB0aGUgcmVhbCBwYXJlbnQgdGFnIGludGVybmFsbHlcbiAgICAgIGRlZmluZVByb3BlcnR5KHRhZywgJ19wYXJlbnQnLCBwYXJlbnQpXG4gICAgfVxuXG4gICAgLy8gcmVtb3ZlIHRoZSByZWR1bmRhbnQgdGFnc1xuICAgIHVubW91bnRSZWR1bmRhbnQoaXRlbXMsIHRhZ3MpXG5cbiAgICAvLyBpbnNlcnQgdGhlIG5ldyBub2Rlc1xuICAgIHJvb3QuaW5zZXJ0QmVmb3JlKGZyYWcsIHJlZilcbiAgICBpZiAoaXNPcHRpb24pIHtcblxuICAgICAgLy8gIzEzNzQgRmlyZUZveCBidWcgaW4gPG9wdGlvbiBzZWxlY3RlZD17ZXhwcmVzc2lvbn0+XG4gICAgICBpZiAoRklSRUZPWCAmJiAhcm9vdC5tdWx0aXBsZSkge1xuICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IHJvb3QubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICBpZiAocm9vdFtuXS5fX3Jpb3QxMzc0KSB7XG4gICAgICAgICAgICByb290LnNlbGVjdGVkSW5kZXggPSBuICAvLyBjbGVhciBvdGhlciBvcHRpb25zXG4gICAgICAgICAgICBkZWxldGUgcm9vdFtuXS5fX3Jpb3QxMzc0XG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIHNldCB0aGUgJ3RhZ3MnIHByb3BlcnR5IG9mIHRoZSBwYXJlbnQgdGFnXG4gICAgLy8gaWYgY2hpbGQgaXMgJ3VuZGVmaW5lZCcgaXQgbWVhbnMgdGhhdCB3ZSBkb24ndCBuZWVkIHRvIHNldCB0aGlzIHByb3BlcnR5XG4gICAgLy8gZm9yIGV4YW1wbGU6XG4gICAgLy8gd2UgZG9uJ3QgbmVlZCBzdG9yZSB0aGUgYG15VGFnLnRhZ3NbJ2RpdiddYCBwcm9wZXJ0eSBpZiB3ZSBhcmUgbG9vcGluZyBhIGRpdiB0YWdcbiAgICAvLyBidXQgd2UgbmVlZCB0byB0cmFjayB0aGUgYG15VGFnLnRhZ3NbJ2NoaWxkJ11gIHByb3BlcnR5IGxvb3BpbmcgYSBjdXN0b20gY2hpbGQgbm9kZSBuYW1lZCBgY2hpbGRgXG4gICAgaWYgKGNoaWxkKSBwYXJlbnQudGFnc1t0YWdOYW1lXSA9IHRhZ3NcblxuICAgIC8vIGNsb25lIHRoZSBpdGVtcyBhcnJheVxuICAgIG9sZEl0ZW1zID0gaXRlbXMuc2xpY2UoKVxuXG4gIH0pXG5cbn1cbi8qKlxuICogT2JqZWN0IHRoYXQgd2lsbCBiZSB1c2VkIHRvIGluamVjdCBhbmQgbWFuYWdlIHRoZSBjc3Mgb2YgZXZlcnkgdGFnIGluc3RhbmNlXG4gKi9cbnZhciBzdHlsZU1hbmFnZXIgPSAoZnVuY3Rpb24oX3Jpb3QpIHtcblxuICBpZiAoIXdpbmRvdykgcmV0dXJuIHsgLy8gc2tpcCBpbmplY3Rpb24gb24gdGhlIHNlcnZlclxuICAgIGFkZDogZnVuY3Rpb24gKCkge30sXG4gICAgaW5qZWN0OiBmdW5jdGlvbiAoKSB7fVxuICB9XG5cbiAgdmFyIHN0eWxlTm9kZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgLy8gY3JlYXRlIGEgbmV3IHN0eWxlIGVsZW1lbnQgd2l0aCB0aGUgY29ycmVjdCB0eXBlXG4gICAgdmFyIG5ld05vZGUgPSBta0VsKCdzdHlsZScpXG4gICAgc2V0QXR0cihuZXdOb2RlLCAndHlwZScsICd0ZXh0L2NzcycpXG5cbiAgICAvLyByZXBsYWNlIGFueSB1c2VyIG5vZGUgb3IgaW5zZXJ0IHRoZSBuZXcgb25lIGludG8gdGhlIGhlYWRcbiAgICB2YXIgdXNlck5vZGUgPSAkKCdzdHlsZVt0eXBlPXJpb3RdJylcbiAgICBpZiAodXNlck5vZGUpIHtcbiAgICAgIGlmICh1c2VyTm9kZS5pZCkgbmV3Tm9kZS5pZCA9IHVzZXJOb2RlLmlkXG4gICAgICB1c2VyTm9kZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChuZXdOb2RlLCB1c2VyTm9kZSlcbiAgICB9XG4gICAgZWxzZSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdLmFwcGVuZENoaWxkKG5ld05vZGUpXG5cbiAgICByZXR1cm4gbmV3Tm9kZVxuICB9KSgpXG5cbiAgLy8gQ3JlYXRlIGNhY2hlIGFuZCBzaG9ydGN1dCB0byB0aGUgY29ycmVjdCBwcm9wZXJ0eVxuICB2YXIgY3NzVGV4dFByb3AgPSBzdHlsZU5vZGUuc3R5bGVTaGVldCxcbiAgICBzdHlsZXNUb0luamVjdCA9ICcnXG5cbiAgLy8gRXhwb3NlIHRoZSBzdHlsZSBub2RlIGluIGEgbm9uLW1vZGlmaWNhYmxlIHByb3BlcnR5XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfcmlvdCwgJ3N0eWxlTm9kZScsIHtcbiAgICB2YWx1ZTogc3R5bGVOb2RlLFxuICAgIHdyaXRhYmxlOiB0cnVlXG4gIH0pXG5cbiAgLyoqXG4gICAqIFB1YmxpYyBhcGlcbiAgICovXG4gIHJldHVybiB7XG4gICAgLyoqXG4gICAgICogU2F2ZSBhIHRhZyBzdHlsZSB0byBiZSBsYXRlciBpbmplY3RlZCBpbnRvIERPTVxuICAgICAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gY3NzIFtkZXNjcmlwdGlvbl1cbiAgICAgKi9cbiAgICBhZGQ6IGZ1bmN0aW9uKGNzcykge1xuICAgICAgc3R5bGVzVG9JbmplY3QgKz0gY3NzXG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBJbmplY3QgYWxsIHByZXZpb3VzbHkgc2F2ZWQgdGFnIHN0eWxlcyBpbnRvIERPTVxuICAgICAqIGlubmVySFRNTCBzZWVtcyBzbG93OiBodHRwOi8vanNwZXJmLmNvbS9yaW90LWluc2VydC1zdHlsZVxuICAgICAqL1xuICAgIGluamVjdDogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoc3R5bGVzVG9JbmplY3QpIHtcbiAgICAgICAgaWYgKGNzc1RleHRQcm9wKSBjc3NUZXh0UHJvcC5jc3NUZXh0ICs9IHN0eWxlc1RvSW5qZWN0XG4gICAgICAgIGVsc2Ugc3R5bGVOb2RlLmlubmVySFRNTCArPSBzdHlsZXNUb0luamVjdFxuICAgICAgICBzdHlsZXNUb0luamVjdCA9ICcnXG4gICAgICB9XG4gICAgfVxuICB9XG5cbn0pKHJpb3QpXG5cblxuZnVuY3Rpb24gcGFyc2VOYW1lZEVsZW1lbnRzKHJvb3QsIHRhZywgY2hpbGRUYWdzLCBmb3JjZVBhcnNpbmdOYW1lZCkge1xuXG4gIHdhbGsocm9vdCwgZnVuY3Rpb24oZG9tKSB7XG4gICAgaWYgKGRvbS5ub2RlVHlwZSA9PSAxKSB7XG4gICAgICBkb20uaXNMb29wID0gZG9tLmlzTG9vcCB8fFxuICAgICAgICAgICAgICAgICAgKGRvbS5wYXJlbnROb2RlICYmIGRvbS5wYXJlbnROb2RlLmlzTG9vcCB8fCBnZXRBdHRyKGRvbSwgJ2VhY2gnKSlcbiAgICAgICAgICAgICAgICAgICAgPyAxIDogMFxuXG4gICAgICAvLyBjdXN0b20gY2hpbGQgdGFnXG4gICAgICBpZiAoY2hpbGRUYWdzKSB7XG4gICAgICAgIHZhciBjaGlsZCA9IGdldFRhZyhkb20pXG5cbiAgICAgICAgaWYgKGNoaWxkICYmICFkb20uaXNMb29wKVxuICAgICAgICAgIGNoaWxkVGFncy5wdXNoKGluaXRDaGlsZFRhZyhjaGlsZCwge3Jvb3Q6IGRvbSwgcGFyZW50OiB0YWd9LCBkb20uaW5uZXJIVE1MLCB0YWcpKVxuICAgICAgfVxuXG4gICAgICBpZiAoIWRvbS5pc0xvb3AgfHwgZm9yY2VQYXJzaW5nTmFtZWQpXG4gICAgICAgIHNldE5hbWVkKGRvbSwgdGFnLCBbXSlcbiAgICB9XG5cbiAgfSlcblxufVxuXG5mdW5jdGlvbiBwYXJzZUV4cHJlc3Npb25zKHJvb3QsIHRhZywgZXhwcmVzc2lvbnMpIHtcblxuICBmdW5jdGlvbiBhZGRFeHByKGRvbSwgdmFsLCBleHRyYSkge1xuICAgIGlmICh0bXBsLmhhc0V4cHIodmFsKSkge1xuICAgICAgZXhwcmVzc2lvbnMucHVzaChleHRlbmQoeyBkb206IGRvbSwgZXhwcjogdmFsIH0sIGV4dHJhKSlcbiAgICB9XG4gIH1cblxuICB3YWxrKHJvb3QsIGZ1bmN0aW9uKGRvbSkge1xuICAgIHZhciB0eXBlID0gZG9tLm5vZGVUeXBlLFxuICAgICAgYXR0clxuXG4gICAgLy8gdGV4dCBub2RlXG4gICAgaWYgKHR5cGUgPT0gMyAmJiBkb20ucGFyZW50Tm9kZS50YWdOYW1lICE9ICdTVFlMRScpIGFkZEV4cHIoZG9tLCBkb20ubm9kZVZhbHVlKVxuICAgIGlmICh0eXBlICE9IDEpIHJldHVyblxuXG4gICAgLyogZWxlbWVudCAqL1xuXG4gICAgLy8gbG9vcFxuICAgIGF0dHIgPSBnZXRBdHRyKGRvbSwgJ2VhY2gnKVxuXG4gICAgaWYgKGF0dHIpIHsgX2VhY2goZG9tLCB0YWcsIGF0dHIpOyByZXR1cm4gZmFsc2UgfVxuXG4gICAgLy8gYXR0cmlidXRlIGV4cHJlc3Npb25zXG4gICAgZWFjaChkb20uYXR0cmlidXRlcywgZnVuY3Rpb24oYXR0cikge1xuICAgICAgdmFyIG5hbWUgPSBhdHRyLm5hbWUsXG4gICAgICAgIGJvb2wgPSBuYW1lLnNwbGl0KCdfXycpWzFdXG5cbiAgICAgIGFkZEV4cHIoZG9tLCBhdHRyLnZhbHVlLCB7IGF0dHI6IGJvb2wgfHwgbmFtZSwgYm9vbDogYm9vbCB9KVxuICAgICAgaWYgKGJvb2wpIHsgcmVtQXR0cihkb20sIG5hbWUpOyByZXR1cm4gZmFsc2UgfVxuXG4gICAgfSlcblxuICAgIC8vIHNraXAgY3VzdG9tIHRhZ3NcbiAgICBpZiAoZ2V0VGFnKGRvbSkpIHJldHVybiBmYWxzZVxuXG4gIH0pXG5cbn1cbmZ1bmN0aW9uIFRhZyhpbXBsLCBjb25mLCBpbm5lckhUTUwpIHtcblxuICB2YXIgc2VsZiA9IHJpb3Qub2JzZXJ2YWJsZSh0aGlzKSxcbiAgICBvcHRzID0gaW5oZXJpdChjb25mLm9wdHMpIHx8IHt9LFxuICAgIHBhcmVudCA9IGNvbmYucGFyZW50LFxuICAgIGlzTG9vcCA9IGNvbmYuaXNMb29wLFxuICAgIGhhc0ltcGwgPSBjb25mLmhhc0ltcGwsXG4gICAgaXRlbSA9IGNsZWFuVXBEYXRhKGNvbmYuaXRlbSksXG4gICAgZXhwcmVzc2lvbnMgPSBbXSxcbiAgICBjaGlsZFRhZ3MgPSBbXSxcbiAgICByb290ID0gY29uZi5yb290LFxuICAgIHRhZ05hbWUgPSByb290LnRhZ05hbWUudG9Mb3dlckNhc2UoKSxcbiAgICBhdHRyID0ge30sXG4gICAgcHJvcHNJblN5bmNXaXRoUGFyZW50ID0gW10sXG4gICAgZG9tXG5cbiAgLy8gb25seSBjYWxsIHVubW91bnQgaWYgd2UgaGF2ZSBhIHZhbGlkIF9fdGFnSW1wbCAoaGFzIG5hbWUgcHJvcGVydHkpXG4gIGlmIChpbXBsLm5hbWUgJiYgcm9vdC5fdGFnKSByb290Ll90YWcudW5tb3VudCh0cnVlKVxuXG4gIC8vIG5vdCB5ZXQgbW91bnRlZFxuICB0aGlzLmlzTW91bnRlZCA9IGZhbHNlXG4gIHJvb3QuaXNMb29wID0gaXNMb29wXG5cbiAgLy8ga2VlcCBhIHJlZmVyZW5jZSB0byB0aGUgdGFnIGp1c3QgY3JlYXRlZFxuICAvLyBzbyB3ZSB3aWxsIGJlIGFibGUgdG8gbW91bnQgdGhpcyB0YWcgbXVsdGlwbGUgdGltZXNcbiAgcm9vdC5fdGFnID0gdGhpc1xuXG4gIC8vIGNyZWF0ZSBhIHVuaXF1ZSBpZCB0byB0aGlzIHRhZ1xuICAvLyBpdCBjb3VsZCBiZSBoYW5keSB0byB1c2UgaXQgYWxzbyB0byBpbXByb3ZlIHRoZSB2aXJ0dWFsIGRvbSByZW5kZXJpbmcgc3BlZWRcbiAgZGVmaW5lUHJvcGVydHkodGhpcywgJ19yaW90X2lkJywgKytfX3VpZCkgLy8gYmFzZSAxIGFsbG93cyB0ZXN0ICF0Ll9yaW90X2lkXG5cbiAgZXh0ZW5kKHRoaXMsIHsgcGFyZW50OiBwYXJlbnQsIHJvb3Q6IHJvb3QsIG9wdHM6IG9wdHN9LCBpdGVtKVxuICAvLyBwcm90ZWN0IHRoZSBcInRhZ3NcIiBwcm9wZXJ0eSBmcm9tIGJlaW5nIG92ZXJyaWRkZW5cbiAgZGVmaW5lUHJvcGVydHkodGhpcywgJ3RhZ3MnLCB7fSlcblxuICAvLyBncmFiIGF0dHJpYnV0ZXNcbiAgZWFjaChyb290LmF0dHJpYnV0ZXMsIGZ1bmN0aW9uKGVsKSB7XG4gICAgdmFyIHZhbCA9IGVsLnZhbHVlXG4gICAgLy8gcmVtZW1iZXIgYXR0cmlidXRlcyB3aXRoIGV4cHJlc3Npb25zIG9ubHlcbiAgICBpZiAodG1wbC5oYXNFeHByKHZhbCkpIGF0dHJbZWwubmFtZV0gPSB2YWxcbiAgfSlcblxuICBkb20gPSBta2RvbShpbXBsLnRtcGwsIGlubmVySFRNTClcblxuICAvLyBvcHRpb25zXG4gIGZ1bmN0aW9uIHVwZGF0ZU9wdHMoKSB7XG4gICAgdmFyIGN0eCA9IGhhc0ltcGwgJiYgaXNMb29wID8gc2VsZiA6IHBhcmVudCB8fCBzZWxmXG5cbiAgICAvLyB1cGRhdGUgb3B0cyBmcm9tIGN1cnJlbnQgRE9NIGF0dHJpYnV0ZXNcbiAgICBlYWNoKHJvb3QuYXR0cmlidXRlcywgZnVuY3Rpb24oZWwpIHtcbiAgICAgIHZhciB2YWwgPSBlbC52YWx1ZVxuICAgICAgb3B0c1t0b0NhbWVsKGVsLm5hbWUpXSA9IHRtcGwuaGFzRXhwcih2YWwpID8gdG1wbCh2YWwsIGN0eCkgOiB2YWxcbiAgICB9KVxuICAgIC8vIHJlY292ZXIgdGhvc2Ugd2l0aCBleHByZXNzaW9uc1xuICAgIGVhY2goT2JqZWN0LmtleXMoYXR0ciksIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIG9wdHNbdG9DYW1lbChuYW1lKV0gPSB0bXBsKGF0dHJbbmFtZV0sIGN0eClcbiAgICB9KVxuICB9XG5cbiAgZnVuY3Rpb24gbm9ybWFsaXplRGF0YShkYXRhKSB7XG4gICAgZm9yICh2YXIga2V5IGluIGl0ZW0pIHtcbiAgICAgIGlmICh0eXBlb2Ygc2VsZltrZXldICE9PSBUX1VOREVGICYmIGlzV3JpdGFibGUoc2VsZiwga2V5KSlcbiAgICAgICAgc2VsZltrZXldID0gZGF0YVtrZXldXG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaW5oZXJpdEZyb21QYXJlbnQgKCkge1xuICAgIGlmICghc2VsZi5wYXJlbnQgfHwgIWlzTG9vcCkgcmV0dXJuXG4gICAgZWFjaChPYmplY3Qua2V5cyhzZWxmLnBhcmVudCksIGZ1bmN0aW9uKGspIHtcbiAgICAgIC8vIHNvbWUgcHJvcGVydGllcyBtdXN0IGJlIGFsd2F5cyBpbiBzeW5jIHdpdGggdGhlIHBhcmVudCB0YWdcbiAgICAgIHZhciBtdXN0U3luYyA9ICFSRVNFUlZFRF9XT1JEU19CTEFDS0xJU1QudGVzdChrKSAmJiBjb250YWlucyhwcm9wc0luU3luY1dpdGhQYXJlbnQsIGspXG4gICAgICBpZiAodHlwZW9mIHNlbGZba10gPT09IFRfVU5ERUYgfHwgbXVzdFN5bmMpIHtcbiAgICAgICAgLy8gdHJhY2sgdGhlIHByb3BlcnR5IHRvIGtlZXAgaW4gc3luY1xuICAgICAgICAvLyBzbyB3ZSBjYW4ga2VlcCBpdCB1cGRhdGVkXG4gICAgICAgIGlmICghbXVzdFN5bmMpIHByb3BzSW5TeW5jV2l0aFBhcmVudC5wdXNoKGspXG4gICAgICAgIHNlbGZba10gPSBzZWxmLnBhcmVudFtrXVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHRoZSB0YWcgZXhwcmVzc2lvbnMgYW5kIG9wdGlvbnNcbiAgICogQHBhcmFtICAgeyAqIH0gIGRhdGEgLSBkYXRhIHdlIHdhbnQgdG8gdXNlIHRvIGV4dGVuZCB0aGUgdGFnIHByb3BlcnRpZXNcbiAgICogQHBhcmFtICAgeyBCb29sZWFuIH0gaXNJbmhlcml0ZWQgLSBpcyB0aGlzIHVwZGF0ZSBjb21pbmcgZnJvbSBhIHBhcmVudCB0YWc/XG4gICAqIEByZXR1cm5zIHsgc2VsZiB9XG4gICAqL1xuICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCAndXBkYXRlJywgZnVuY3Rpb24oZGF0YSwgaXNJbmhlcml0ZWQpIHtcblxuICAgIC8vIG1ha2Ugc3VyZSB0aGUgZGF0YSBwYXNzZWQgd2lsbCBub3Qgb3ZlcnJpZGVcbiAgICAvLyB0aGUgY29tcG9uZW50IGNvcmUgbWV0aG9kc1xuICAgIGRhdGEgPSBjbGVhblVwRGF0YShkYXRhKVxuICAgIC8vIGluaGVyaXQgcHJvcGVydGllcyBmcm9tIHRoZSBwYXJlbnRcbiAgICBpbmhlcml0RnJvbVBhcmVudCgpXG4gICAgLy8gbm9ybWFsaXplIHRoZSB0YWcgcHJvcGVydGllcyBpbiBjYXNlIGFuIGl0ZW0gb2JqZWN0IHdhcyBpbml0aWFsbHkgcGFzc2VkXG4gICAgaWYgKGRhdGEgJiYgaXNPYmplY3QoaXRlbSkpIHtcbiAgICAgIG5vcm1hbGl6ZURhdGEoZGF0YSlcbiAgICAgIGl0ZW0gPSBkYXRhXG4gICAgfVxuICAgIGV4dGVuZChzZWxmLCBkYXRhKVxuICAgIHVwZGF0ZU9wdHMoKVxuICAgIHNlbGYudHJpZ2dlcigndXBkYXRlJywgZGF0YSlcbiAgICB1cGRhdGUoZXhwcmVzc2lvbnMsIHNlbGYpXG5cbiAgICAvLyB0aGUgdXBkYXRlZCBldmVudCB3aWxsIGJlIHRyaWdnZXJlZFxuICAgIC8vIG9uY2UgdGhlIERPTSB3aWxsIGJlIHJlYWR5IGFuZCBhbGwgdGhlIHJlLWZsb3dzIGFyZSBjb21wbGV0ZWRcbiAgICAvLyB0aGlzIGlzIHVzZWZ1bCBpZiB5b3Ugd2FudCB0byBnZXQgdGhlIFwicmVhbFwiIHJvb3QgcHJvcGVydGllc1xuICAgIC8vIDQgZXg6IHJvb3Qub2Zmc2V0V2lkdGggLi4uXG4gICAgaWYgKGlzSW5oZXJpdGVkICYmIHNlbGYucGFyZW50KVxuICAgICAgLy8gY2xvc2VzICMxNTk5XG4gICAgICBzZWxmLnBhcmVudC5vbmUoJ3VwZGF0ZWQnLCBmdW5jdGlvbigpIHsgc2VsZi50cmlnZ2VyKCd1cGRhdGVkJykgfSlcbiAgICBlbHNlIHJBRihmdW5jdGlvbigpIHsgc2VsZi50cmlnZ2VyKCd1cGRhdGVkJykgfSlcblxuICAgIHJldHVybiB0aGlzXG4gIH0pXG5cbiAgZGVmaW5lUHJvcGVydHkodGhpcywgJ21peGluJywgZnVuY3Rpb24oKSB7XG4gICAgZWFjaChhcmd1bWVudHMsIGZ1bmN0aW9uKG1peCkge1xuICAgICAgdmFyIGluc3RhbmNlLFxuICAgICAgICBwcm9wcyA9IFtdLFxuICAgICAgICBvYmpcblxuICAgICAgbWl4ID0gdHlwZW9mIG1peCA9PT0gVF9TVFJJTkcgPyByaW90Lm1peGluKG1peCkgOiBtaXhcblxuICAgICAgLy8gY2hlY2sgaWYgdGhlIG1peGluIGlzIGEgZnVuY3Rpb25cbiAgICAgIGlmIChpc0Z1bmN0aW9uKG1peCkpIHtcbiAgICAgICAgLy8gY3JlYXRlIHRoZSBuZXcgbWl4aW4gaW5zdGFuY2VcbiAgICAgICAgaW5zdGFuY2UgPSBuZXcgbWl4KClcbiAgICAgIH0gZWxzZSBpbnN0YW5jZSA9IG1peFxuXG4gICAgICAvLyBidWlsZCBtdWx0aWxldmVsIHByb3RvdHlwZSBpbmhlcml0YW5jZSBjaGFpbiBwcm9wZXJ0eSBsaXN0XG4gICAgICBkbyBwcm9wcyA9IHByb3BzLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmogfHwgaW5zdGFuY2UpKVxuICAgICAgd2hpbGUgKG9iaiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmogfHwgaW5zdGFuY2UpKVxuXG4gICAgICAvLyBsb29wIHRoZSBrZXlzIGluIHRoZSBmdW5jdGlvbiBwcm90b3R5cGUgb3IgdGhlIGFsbCBvYmplY3Qga2V5c1xuICAgICAgZWFjaChwcm9wcywgZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIC8vIGJpbmQgbWV0aG9kcyB0byBzZWxmXG4gICAgICAgIGlmIChrZXkgIT0gJ2luaXQnICYmICFzZWxmW2tleV0pXG4gICAgICAgICAgLy8gYXBwbHkgbWV0aG9kIG9ubHkgaWYgaXQgZG9lcyBub3QgYWxyZWFkeSBleGlzdCBvbiB0aGUgaW5zdGFuY2VcbiAgICAgICAgICBzZWxmW2tleV0gPSBpc0Z1bmN0aW9uKGluc3RhbmNlW2tleV0pID9cbiAgICAgICAgICAgIGluc3RhbmNlW2tleV0uYmluZChzZWxmKSA6XG4gICAgICAgICAgICBpbnN0YW5jZVtrZXldXG4gICAgICB9KVxuXG4gICAgICAvLyBpbml0IG1ldGhvZCB3aWxsIGJlIGNhbGxlZCBhdXRvbWF0aWNhbGx5XG4gICAgICBpZiAoaW5zdGFuY2UuaW5pdCkgaW5zdGFuY2UuaW5pdC5iaW5kKHNlbGYpKClcbiAgICB9KVxuICAgIHJldHVybiB0aGlzXG4gIH0pXG5cbiAgZGVmaW5lUHJvcGVydHkodGhpcywgJ21vdW50JywgZnVuY3Rpb24oKSB7XG5cbiAgICB1cGRhdGVPcHRzKClcblxuICAgIC8vIGFkZCBnbG9iYWwgbWl4aW5zXG4gICAgdmFyIGdsb2JhbE1peGluID0gcmlvdC5taXhpbihHTE9CQUxfTUlYSU4pXG4gICAgaWYgKGdsb2JhbE1peGluKVxuICAgICAgZm9yICh2YXIgaSBpbiBnbG9iYWxNaXhpbilcbiAgICAgICAgaWYgKGdsb2JhbE1peGluLmhhc093blByb3BlcnR5KGkpKVxuICAgICAgICAgIHNlbGYubWl4aW4oZ2xvYmFsTWl4aW5baV0pXG5cbiAgICAvLyBpbml0aWFsaWF0aW9uXG4gICAgaWYgKGltcGwuZm4pIGltcGwuZm4uY2FsbChzZWxmLCBvcHRzKVxuXG4gICAgLy8gcGFyc2UgbGF5b3V0IGFmdGVyIGluaXQuIGZuIG1heSBjYWxjdWxhdGUgYXJncyBmb3IgbmVzdGVkIGN1c3RvbSB0YWdzXG4gICAgcGFyc2VFeHByZXNzaW9ucyhkb20sIHNlbGYsIGV4cHJlc3Npb25zKVxuXG4gICAgLy8gbW91bnQgdGhlIGNoaWxkIHRhZ3NcbiAgICB0b2dnbGUodHJ1ZSlcblxuICAgIC8vIHVwZGF0ZSB0aGUgcm9vdCBhZGRpbmcgY3VzdG9tIGF0dHJpYnV0ZXMgY29taW5nIGZyb20gdGhlIGNvbXBpbGVyXG4gICAgLy8gaXQgZml4ZXMgYWxzbyAjMTA4N1xuICAgIGlmIChpbXBsLmF0dHJzKVxuICAgICAgd2Fsa0F0dHJpYnV0ZXMoaW1wbC5hdHRycywgZnVuY3Rpb24gKGssIHYpIHsgc2V0QXR0cihyb290LCBrLCB2KSB9KVxuICAgIGlmIChpbXBsLmF0dHJzIHx8IGhhc0ltcGwpXG4gICAgICBwYXJzZUV4cHJlc3Npb25zKHNlbGYucm9vdCwgc2VsZiwgZXhwcmVzc2lvbnMpXG5cbiAgICBpZiAoIXNlbGYucGFyZW50IHx8IGlzTG9vcCkgc2VsZi51cGRhdGUoaXRlbSlcblxuICAgIC8vIGludGVybmFsIHVzZSBvbmx5LCBmaXhlcyAjNDAzXG4gICAgc2VsZi50cmlnZ2VyKCdiZWZvcmUtbW91bnQnKVxuXG4gICAgaWYgKGlzTG9vcCAmJiAhaGFzSW1wbCkge1xuICAgICAgLy8gdXBkYXRlIHRoZSByb290IGF0dHJpYnV0ZSBmb3IgdGhlIGxvb3BlZCBlbGVtZW50c1xuICAgICAgcm9vdCA9IGRvbS5maXJzdENoaWxkXG4gICAgfSBlbHNlIHtcbiAgICAgIHdoaWxlIChkb20uZmlyc3RDaGlsZCkgcm9vdC5hcHBlbmRDaGlsZChkb20uZmlyc3RDaGlsZClcbiAgICAgIGlmIChyb290LnN0dWIpIHJvb3QgPSBwYXJlbnQucm9vdFxuICAgIH1cblxuICAgIGRlZmluZVByb3BlcnR5KHNlbGYsICdyb290Jywgcm9vdClcblxuICAgIC8vIHBhcnNlIHRoZSBuYW1lZCBkb20gbm9kZXMgaW4gdGhlIGxvb3BlZCBjaGlsZFxuICAgIC8vIGFkZGluZyB0aGVtIHRvIHRoZSBwYXJlbnQgYXMgd2VsbFxuICAgIGlmIChpc0xvb3ApXG4gICAgICBwYXJzZU5hbWVkRWxlbWVudHMoc2VsZi5yb290LCBzZWxmLnBhcmVudCwgbnVsbCwgdHJ1ZSlcblxuICAgIC8vIGlmIGl0J3Mgbm90IGEgY2hpbGQgdGFnIHdlIGNhbiB0cmlnZ2VyIGl0cyBtb3VudCBldmVudFxuICAgIGlmICghc2VsZi5wYXJlbnQgfHwgc2VsZi5wYXJlbnQuaXNNb3VudGVkKSB7XG4gICAgICBzZWxmLmlzTW91bnRlZCA9IHRydWVcbiAgICAgIHNlbGYudHJpZ2dlcignbW91bnQnKVxuICAgIH1cbiAgICAvLyBvdGhlcndpc2Ugd2UgbmVlZCB0byB3YWl0IHRoYXQgdGhlIHBhcmVudCBldmVudCBnZXRzIHRyaWdnZXJlZFxuICAgIGVsc2Ugc2VsZi5wYXJlbnQub25lKCdtb3VudCcsIGZ1bmN0aW9uKCkge1xuICAgICAgLy8gYXZvaWQgdG8gdHJpZ2dlciB0aGUgYG1vdW50YCBldmVudCBmb3IgdGhlIHRhZ3NcbiAgICAgIC8vIG5vdCB2aXNpYmxlIGluY2x1ZGVkIGluIGFuIGlmIHN0YXRlbWVudFxuICAgICAgaWYgKCFpc0luU3R1YihzZWxmLnJvb3QpKSB7XG4gICAgICAgIHNlbGYucGFyZW50LmlzTW91bnRlZCA9IHNlbGYuaXNNb3VudGVkID0gdHJ1ZVxuICAgICAgICBzZWxmLnRyaWdnZXIoJ21vdW50JylcbiAgICAgIH1cbiAgICB9KVxuICB9KVxuXG5cbiAgZGVmaW5lUHJvcGVydHkodGhpcywgJ3VubW91bnQnLCBmdW5jdGlvbihrZWVwUm9vdFRhZykge1xuICAgIHZhciBlbCA9IHJvb3QsXG4gICAgICBwID0gZWwucGFyZW50Tm9kZSxcbiAgICAgIHB0YWcsXG4gICAgICB0YWdJbmRleCA9IF9fdmlydHVhbERvbS5pbmRleE9mKHNlbGYpXG5cbiAgICBzZWxmLnRyaWdnZXIoJ2JlZm9yZS11bm1vdW50JylcblxuICAgIC8vIHJlbW92ZSB0aGlzIHRhZyBpbnN0YW5jZSBmcm9tIHRoZSBnbG9iYWwgdmlydHVhbERvbSB2YXJpYWJsZVxuICAgIGlmICh+dGFnSW5kZXgpXG4gICAgICBfX3ZpcnR1YWxEb20uc3BsaWNlKHRhZ0luZGV4LCAxKVxuXG4gICAgaWYgKHApIHtcblxuICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICBwdGFnID0gZ2V0SW1tZWRpYXRlQ3VzdG9tUGFyZW50VGFnKHBhcmVudClcbiAgICAgICAgLy8gcmVtb3ZlIHRoaXMgdGFnIGZyb20gdGhlIHBhcmVudCB0YWdzIG9iamVjdFxuICAgICAgICAvLyBpZiB0aGVyZSBhcmUgbXVsdGlwbGUgbmVzdGVkIHRhZ3Mgd2l0aCBzYW1lIG5hbWUuLlxuICAgICAgICAvLyByZW1vdmUgdGhpcyBlbGVtZW50IGZvcm0gdGhlIGFycmF5XG4gICAgICAgIGlmIChpc0FycmF5KHB0YWcudGFnc1t0YWdOYW1lXSkpXG4gICAgICAgICAgZWFjaChwdGFnLnRhZ3NbdGFnTmFtZV0sIGZ1bmN0aW9uKHRhZywgaSkge1xuICAgICAgICAgICAgaWYgKHRhZy5fcmlvdF9pZCA9PSBzZWxmLl9yaW90X2lkKVxuICAgICAgICAgICAgICBwdGFnLnRhZ3NbdGFnTmFtZV0uc3BsaWNlKGksIDEpXG4gICAgICAgICAgfSlcbiAgICAgICAgZWxzZVxuICAgICAgICAgIC8vIG90aGVyd2lzZSBqdXN0IGRlbGV0ZSB0aGUgdGFnIGluc3RhbmNlXG4gICAgICAgICAgcHRhZy50YWdzW3RhZ05hbWVdID0gdW5kZWZpbmVkXG4gICAgICB9XG5cbiAgICAgIGVsc2VcbiAgICAgICAgd2hpbGUgKGVsLmZpcnN0Q2hpbGQpIGVsLnJlbW92ZUNoaWxkKGVsLmZpcnN0Q2hpbGQpXG5cbiAgICAgIGlmICgha2VlcFJvb3RUYWcpXG4gICAgICAgIHAucmVtb3ZlQ2hpbGQoZWwpXG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gdGhlIHJpb3QtdGFnIGFuZCB0aGUgZGF0YS1pcyBhdHRyaWJ1dGVzIGFyZW4ndCBuZWVkZWQgYW55bW9yZSwgcmVtb3ZlIHRoZW1cbiAgICAgICAgcmVtQXR0cihwLCBSSU9UX1RBR19JUylcbiAgICAgICAgcmVtQXR0cihwLCBSSU9UX1RBRykgLy8gdGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gcmlvdCAzLjAuMFxuICAgICAgfVxuXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX3ZpcnRzKSB7XG4gICAgICBlYWNoKHRoaXMuX3ZpcnRzLCBmdW5jdGlvbih2KSB7XG4gICAgICAgIGlmICh2LnBhcmVudE5vZGUpIHYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh2KVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBzZWxmLnRyaWdnZXIoJ3VubW91bnQnKVxuICAgIHRvZ2dsZSgpXG4gICAgc2VsZi5vZmYoJyonKVxuICAgIHNlbGYuaXNNb3VudGVkID0gZmFsc2VcbiAgICBkZWxldGUgcm9vdC5fdGFnXG5cbiAgfSlcblxuICAvLyBwcm94eSBmdW5jdGlvbiB0byBiaW5kIHVwZGF0ZXNcbiAgLy8gZGlzcGF0Y2hlZCBmcm9tIGEgcGFyZW50IHRhZ1xuICBmdW5jdGlvbiBvbkNoaWxkVXBkYXRlKGRhdGEpIHsgc2VsZi51cGRhdGUoZGF0YSwgdHJ1ZSkgfVxuXG4gIGZ1bmN0aW9uIHRvZ2dsZShpc01vdW50KSB7XG5cbiAgICAvLyBtb3VudC91bm1vdW50IGNoaWxkcmVuXG4gICAgZWFjaChjaGlsZFRhZ3MsIGZ1bmN0aW9uKGNoaWxkKSB7IGNoaWxkW2lzTW91bnQgPyAnbW91bnQnIDogJ3VubW91bnQnXSgpIH0pXG5cbiAgICAvLyBsaXN0ZW4vdW5saXN0ZW4gcGFyZW50IChldmVudHMgZmxvdyBvbmUgd2F5IGZyb20gcGFyZW50IHRvIGNoaWxkcmVuKVxuICAgIGlmICghcGFyZW50KSByZXR1cm5cbiAgICB2YXIgZXZ0ID0gaXNNb3VudCA/ICdvbicgOiAnb2ZmJ1xuXG4gICAgLy8gdGhlIGxvb3AgdGFncyB3aWxsIGJlIGFsd2F5cyBpbiBzeW5jIHdpdGggdGhlIHBhcmVudCBhdXRvbWF0aWNhbGx5XG4gICAgaWYgKGlzTG9vcClcbiAgICAgIHBhcmVudFtldnRdKCd1bm1vdW50Jywgc2VsZi51bm1vdW50KVxuICAgIGVsc2Uge1xuICAgICAgcGFyZW50W2V2dF0oJ3VwZGF0ZScsIG9uQ2hpbGRVcGRhdGUpW2V2dF0oJ3VubW91bnQnLCBzZWxmLnVubW91bnQpXG4gICAgfVxuICB9XG5cblxuICAvLyBuYW1lZCBlbGVtZW50cyBhdmFpbGFibGUgZm9yIGZuXG4gIHBhcnNlTmFtZWRFbGVtZW50cyhkb20sIHRoaXMsIGNoaWxkVGFncylcblxufVxuLyoqXG4gKiBBdHRhY2ggYW4gZXZlbnQgdG8gYSBET00gbm9kZVxuICogQHBhcmFtIHsgU3RyaW5nIH0gbmFtZSAtIGV2ZW50IG5hbWVcbiAqIEBwYXJhbSB7IEZ1bmN0aW9uIH0gaGFuZGxlciAtIGV2ZW50IGNhbGxiYWNrXG4gKiBAcGFyYW0geyBPYmplY3QgfSBkb20gLSBkb20gbm9kZVxuICogQHBhcmFtIHsgVGFnIH0gdGFnIC0gdGFnIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIHNldEV2ZW50SGFuZGxlcihuYW1lLCBoYW5kbGVyLCBkb20sIHRhZykge1xuXG4gIGRvbVtuYW1lXSA9IGZ1bmN0aW9uKGUpIHtcblxuICAgIHZhciBwdGFnID0gdGFnLl9wYXJlbnQsXG4gICAgICBpdGVtID0gdGFnLl9pdGVtLFxuICAgICAgZWxcblxuICAgIGlmICghaXRlbSlcbiAgICAgIHdoaWxlIChwdGFnICYmICFpdGVtKSB7XG4gICAgICAgIGl0ZW0gPSBwdGFnLl9pdGVtXG4gICAgICAgIHB0YWcgPSBwdGFnLl9wYXJlbnRcbiAgICAgIH1cblxuICAgIC8vIGNyb3NzIGJyb3dzZXIgZXZlbnQgZml4XG4gICAgZSA9IGUgfHwgd2luZG93LmV2ZW50XG5cbiAgICAvLyBvdmVycmlkZSB0aGUgZXZlbnQgcHJvcGVydGllc1xuICAgIGlmIChpc1dyaXRhYmxlKGUsICdjdXJyZW50VGFyZ2V0JykpIGUuY3VycmVudFRhcmdldCA9IGRvbVxuICAgIGlmIChpc1dyaXRhYmxlKGUsICd0YXJnZXQnKSkgZS50YXJnZXQgPSBlLnNyY0VsZW1lbnRcbiAgICBpZiAoaXNXcml0YWJsZShlLCAnd2hpY2gnKSkgZS53aGljaCA9IGUuY2hhckNvZGUgfHwgZS5rZXlDb2RlXG5cbiAgICBlLml0ZW0gPSBpdGVtXG5cbiAgICAvLyBwcmV2ZW50IGRlZmF1bHQgYmVoYXZpb3VyIChieSBkZWZhdWx0KVxuICAgIGlmIChoYW5kbGVyLmNhbGwodGFnLCBlKSAhPT0gdHJ1ZSAmJiAhL3JhZGlvfGNoZWNrLy50ZXN0KGRvbS50eXBlKSkge1xuICAgICAgaWYgKGUucHJldmVudERlZmF1bHQpIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgZS5yZXR1cm5WYWx1ZSA9IGZhbHNlXG4gICAgfVxuXG4gICAgaWYgKCFlLnByZXZlbnRVcGRhdGUpIHtcbiAgICAgIGVsID0gaXRlbSA/IGdldEltbWVkaWF0ZUN1c3RvbVBhcmVudFRhZyhwdGFnKSA6IHRhZ1xuICAgICAgZWwudXBkYXRlKClcbiAgICB9XG5cbiAgfVxuXG59XG5cblxuLyoqXG4gKiBJbnNlcnQgYSBET00gbm9kZSByZXBsYWNpbmcgYW5vdGhlciBvbmUgKHVzZWQgYnkgaWYtIGF0dHJpYnV0ZSlcbiAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gcm9vdCAtIHBhcmVudCBub2RlXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IG5vZGUgLSBub2RlIHJlcGxhY2VkXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IGJlZm9yZSAtIG5vZGUgYWRkZWRcbiAqL1xuZnVuY3Rpb24gaW5zZXJ0VG8ocm9vdCwgbm9kZSwgYmVmb3JlKSB7XG4gIGlmICghcm9vdCkgcmV0dXJuXG4gIHJvb3QuaW5zZXJ0QmVmb3JlKGJlZm9yZSwgbm9kZSlcbiAgcm9vdC5yZW1vdmVDaGlsZChub2RlKVxufVxuXG4vKipcbiAqIFVwZGF0ZSB0aGUgZXhwcmVzc2lvbnMgaW4gYSBUYWcgaW5zdGFuY2VcbiAqIEBwYXJhbSAgIHsgQXJyYXkgfSBleHByZXNzaW9ucyAtIGV4cHJlc3Npb24gdGhhdCBtdXN0IGJlIHJlIGV2YWx1YXRlZFxuICogQHBhcmFtICAgeyBUYWcgfSB0YWcgLSB0YWcgaW5zdGFuY2VcbiAqL1xuZnVuY3Rpb24gdXBkYXRlKGV4cHJlc3Npb25zLCB0YWcpIHtcblxuICBlYWNoKGV4cHJlc3Npb25zLCBmdW5jdGlvbihleHByLCBpKSB7XG5cbiAgICB2YXIgZG9tID0gZXhwci5kb20sXG4gICAgICBhdHRyTmFtZSA9IGV4cHIuYXR0cixcbiAgICAgIHZhbHVlID0gdG1wbChleHByLmV4cHIsIHRhZyksXG4gICAgICBwYXJlbnQgPSBleHByLmRvbS5wYXJlbnROb2RlXG5cbiAgICBpZiAoZXhwci5ib29sKSB7XG4gICAgICB2YWx1ZSA9ICEhdmFsdWVcbiAgICB9IGVsc2UgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgIHZhbHVlID0gJydcbiAgICB9XG5cbiAgICAvLyAjMTYzODogcmVncmVzc2lvbiBvZiAjMTYxMiwgdXBkYXRlIHRoZSBkb20gb25seSBpZiB0aGUgdmFsdWUgb2YgdGhlXG4gICAgLy8gZXhwcmVzc2lvbiB3YXMgY2hhbmdlZFxuICAgIGlmIChleHByLnZhbHVlID09PSB2YWx1ZSkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGV4cHIudmFsdWUgPSB2YWx1ZVxuXG4gICAgLy8gdGV4dGFyZWEgYW5kIHRleHQgbm9kZXMgaGFzIG5vIGF0dHJpYnV0ZSBuYW1lXG4gICAgaWYgKCFhdHRyTmFtZSkge1xuICAgICAgLy8gYWJvdXQgIzgxNSB3L28gcmVwbGFjZTogdGhlIGJyb3dzZXIgY29udmVydHMgdGhlIHZhbHVlIHRvIGEgc3RyaW5nLFxuICAgICAgLy8gdGhlIGNvbXBhcmlzb24gYnkgXCI9PVwiIGRvZXMgdG9vLCBidXQgbm90IGluIHRoZSBzZXJ2ZXJcbiAgICAgIHZhbHVlICs9ICcnXG4gICAgICAvLyB0ZXN0IGZvciBwYXJlbnQgYXZvaWRzIGVycm9yIHdpdGggaW52YWxpZCBhc3NpZ25tZW50IHRvIG5vZGVWYWx1ZVxuICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICBpZiAocGFyZW50LnRhZ05hbWUgPT09ICdURVhUQVJFQScpIHtcbiAgICAgICAgICBwYXJlbnQudmFsdWUgPSB2YWx1ZSAgICAgICAgICAgICAgICAgICAgLy8gIzExMTNcbiAgICAgICAgICBpZiAoIUlFX1ZFUlNJT04pIGRvbS5ub2RlVmFsdWUgPSB2YWx1ZSAgLy8gIzE2MjUgSUUgdGhyb3dzIGhlcmUsIG5vZGVWYWx1ZVxuICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3aWxsIGJlIGF2YWlsYWJsZSBvbiAndXBkYXRlZCdcbiAgICAgICAgZWxzZSBkb20ubm9kZVZhbHVlID0gdmFsdWVcbiAgICAgIH1cbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIH5+IzE2MTI6IGxvb2sgZm9yIGNoYW5nZXMgaW4gZG9tLnZhbHVlIHdoZW4gdXBkYXRpbmcgdGhlIHZhbHVlfn5cbiAgICBpZiAoYXR0ck5hbWUgPT09ICd2YWx1ZScpIHtcbiAgICAgIGRvbS52YWx1ZSA9IHZhbHVlXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyByZW1vdmUgb3JpZ2luYWwgYXR0cmlidXRlXG4gICAgcmVtQXR0cihkb20sIGF0dHJOYW1lKVxuXG4gICAgLy8gZXZlbnQgaGFuZGxlclxuICAgIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgICAgc2V0RXZlbnRIYW5kbGVyKGF0dHJOYW1lLCB2YWx1ZSwgZG9tLCB0YWcpXG5cbiAgICAvLyBpZi0gY29uZGl0aW9uYWxcbiAgICB9IGVsc2UgaWYgKGF0dHJOYW1lID09ICdpZicpIHtcbiAgICAgIHZhciBzdHViID0gZXhwci5zdHViLFxuICAgICAgICBhZGQgPSBmdW5jdGlvbigpIHsgaW5zZXJ0VG8oc3R1Yi5wYXJlbnROb2RlLCBzdHViLCBkb20pIH0sXG4gICAgICAgIHJlbW92ZSA9IGZ1bmN0aW9uKCkgeyBpbnNlcnRUbyhkb20ucGFyZW50Tm9kZSwgZG9tLCBzdHViKSB9XG5cbiAgICAgIC8vIGFkZCB0byBET01cbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICBpZiAoc3R1Yikge1xuICAgICAgICAgIGFkZCgpXG4gICAgICAgICAgZG9tLmluU3R1YiA9IGZhbHNlXG4gICAgICAgICAgLy8gYXZvaWQgdG8gdHJpZ2dlciB0aGUgbW91bnQgZXZlbnQgaWYgdGhlIHRhZ3MgaXMgbm90IHZpc2libGUgeWV0XG4gICAgICAgICAgLy8gbWF5YmUgd2UgY2FuIG9wdGltaXplIHRoaXMgYXZvaWRpbmcgdG8gbW91bnQgdGhlIHRhZyBhdCBhbGxcbiAgICAgICAgICBpZiAoIWlzSW5TdHViKGRvbSkpIHtcbiAgICAgICAgICAgIHdhbGsoZG9tLCBmdW5jdGlvbihlbCkge1xuICAgICAgICAgICAgICBpZiAoZWwuX3RhZyAmJiAhZWwuX3RhZy5pc01vdW50ZWQpXG4gICAgICAgICAgICAgICAgZWwuX3RhZy5pc01vdW50ZWQgPSAhIWVsLl90YWcudHJpZ2dlcignbW91bnQnKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIC8vIHJlbW92ZSBmcm9tIERPTVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3R1YiA9IGV4cHIuc3R1YiA9IHN0dWIgfHwgZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpXG4gICAgICAgIC8vIGlmIHRoZSBwYXJlbnROb2RlIGlzIGRlZmluZWQgd2UgY2FuIGVhc2lseSByZXBsYWNlIHRoZSB0YWdcbiAgICAgICAgaWYgKGRvbS5wYXJlbnROb2RlKVxuICAgICAgICAgIHJlbW92ZSgpXG4gICAgICAgIC8vIG90aGVyd2lzZSB3ZSBuZWVkIHRvIHdhaXQgdGhlIHVwZGF0ZWQgZXZlbnRcbiAgICAgICAgZWxzZSAodGFnLnBhcmVudCB8fCB0YWcpLm9uZSgndXBkYXRlZCcsIHJlbW92ZSlcblxuICAgICAgICBkb20uaW5TdHViID0gdHJ1ZVxuICAgICAgfVxuICAgIC8vIHNob3cgLyBoaWRlXG4gICAgfSBlbHNlIGlmIChhdHRyTmFtZSA9PT0gJ3Nob3cnKSB7XG4gICAgICBkb20uc3R5bGUuZGlzcGxheSA9IHZhbHVlID8gJycgOiAnbm9uZSdcblxuICAgIH0gZWxzZSBpZiAoYXR0ck5hbWUgPT09ICdoaWRlJykge1xuICAgICAgZG9tLnN0eWxlLmRpc3BsYXkgPSB2YWx1ZSA/ICdub25lJyA6ICcnXG5cbiAgICB9IGVsc2UgaWYgKGV4cHIuYm9vbCkge1xuICAgICAgZG9tW2F0dHJOYW1lXSA9IHZhbHVlXG4gICAgICBpZiAodmFsdWUpIHNldEF0dHIoZG9tLCBhdHRyTmFtZSwgYXR0ck5hbWUpXG4gICAgICBpZiAoRklSRUZPWCAmJiBhdHRyTmFtZSA9PT0gJ3NlbGVjdGVkJyAmJiBkb20udGFnTmFtZSA9PT0gJ09QVElPTicpIHtcbiAgICAgICAgZG9tLl9fcmlvdDEzNzQgPSB2YWx1ZSAgIC8vICMxMzc0XG4gICAgICB9XG5cbiAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAwIHx8IHZhbHVlICYmIHR5cGVvZiB2YWx1ZSAhPT0gVF9PQkpFQ1QpIHtcbiAgICAgIC8vIDxpbWcgc3JjPVwieyBleHByIH1cIj5cbiAgICAgIGlmIChzdGFydHNXaXRoKGF0dHJOYW1lLCBSSU9UX1BSRUZJWCkgJiYgYXR0ck5hbWUgIT0gUklPVF9UQUcpIHtcbiAgICAgICAgYXR0ck5hbWUgPSBhdHRyTmFtZS5zbGljZShSSU9UX1BSRUZJWC5sZW5ndGgpXG4gICAgICB9XG4gICAgICBzZXRBdHRyKGRvbSwgYXR0ck5hbWUsIHZhbHVlKVxuICAgIH1cblxuICB9KVxuXG59XG4vKipcbiAqIFNwZWNpYWxpemVkIGZ1bmN0aW9uIGZvciBsb29waW5nIGFuIGFycmF5LWxpa2UgY29sbGVjdGlvbiB3aXRoIGBlYWNoPXt9YFxuICogQHBhcmFtICAgeyBBcnJheSB9IGVscyAtIGNvbGxlY3Rpb24gb2YgaXRlbXNcbiAqIEBwYXJhbSAgIHtGdW5jdGlvbn0gZm4gLSBjYWxsYmFjayBmdW5jdGlvblxuICogQHJldHVybnMgeyBBcnJheSB9IHRoZSBhcnJheSBsb29wZWRcbiAqL1xuZnVuY3Rpb24gZWFjaChlbHMsIGZuKSB7XG4gIHZhciBsZW4gPSBlbHMgPyBlbHMubGVuZ3RoIDogMFxuXG4gIGZvciAodmFyIGkgPSAwLCBlbDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgZWwgPSBlbHNbaV1cbiAgICAvLyByZXR1cm4gZmFsc2UgLT4gY3VycmVudCBpdGVtIHdhcyByZW1vdmVkIGJ5IGZuIGR1cmluZyB0aGUgbG9vcFxuICAgIGlmIChlbCAhPSBudWxsICYmIGZuKGVsLCBpKSA9PT0gZmFsc2UpIGktLVxuICB9XG4gIHJldHVybiBlbHNcbn1cblxuLyoqXG4gKiBEZXRlY3QgaWYgdGhlIGFyZ3VtZW50IHBhc3NlZCBpcyBhIGZ1bmN0aW9uXG4gKiBAcGFyYW0gICB7ICogfSB2IC0gd2hhdGV2ZXIgeW91IHdhbnQgdG8gcGFzcyB0byB0aGlzIGZ1bmN0aW9uXG4gKiBAcmV0dXJucyB7IEJvb2xlYW4gfSAtXG4gKi9cbmZ1bmN0aW9uIGlzRnVuY3Rpb24odikge1xuICByZXR1cm4gdHlwZW9mIHYgPT09IFRfRlVOQ1RJT04gfHwgZmFsc2UgICAvLyBhdm9pZCBJRSBwcm9ibGVtc1xufVxuXG4vKipcbiAqIEdldCB0aGUgb3V0ZXIgaHRtbCBvZiBhbnkgRE9NIG5vZGUgU1ZHcyBpbmNsdWRlZFxuICogQHBhcmFtICAgeyBPYmplY3QgfSBlbCAtIERPTSBub2RlIHRvIHBhcnNlXG4gKiBAcmV0dXJucyB7IFN0cmluZyB9IGVsLm91dGVySFRNTFxuICovXG5mdW5jdGlvbiBnZXRPdXRlckhUTUwoZWwpIHtcbiAgaWYgKGVsLm91dGVySFRNTCkgcmV0dXJuIGVsLm91dGVySFRNTFxuICAvLyBzb21lIGJyb3dzZXJzIGRvIG5vdCBzdXBwb3J0IG91dGVySFRNTCBvbiB0aGUgU1ZHcyB0YWdzXG4gIGVsc2Uge1xuICAgIHZhciBjb250YWluZXIgPSBta0VsKCdkaXYnKVxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChlbC5jbG9uZU5vZGUodHJ1ZSkpXG4gICAgcmV0dXJuIGNvbnRhaW5lci5pbm5lckhUTUxcbiAgfVxufVxuXG4vKipcbiAqIFNldCB0aGUgaW5uZXIgaHRtbCBvZiBhbnkgRE9NIG5vZGUgU1ZHcyBpbmNsdWRlZFxuICogQHBhcmFtIHsgT2JqZWN0IH0gY29udGFpbmVyIC0gRE9NIG5vZGUgd2hlcmUgd2Ugd2lsbCBpbmplY3QgdGhlIG5ldyBodG1sXG4gKiBAcGFyYW0geyBTdHJpbmcgfSBodG1sIC0gaHRtbCB0byBpbmplY3RcbiAqL1xuZnVuY3Rpb24gc2V0SW5uZXJIVE1MKGNvbnRhaW5lciwgaHRtbCkge1xuICBpZiAodHlwZW9mIGNvbnRhaW5lci5pbm5lckhUTUwgIT0gVF9VTkRFRikgY29udGFpbmVyLmlubmVySFRNTCA9IGh0bWxcbiAgLy8gc29tZSBicm93c2VycyBkbyBub3Qgc3VwcG9ydCBpbm5lckhUTUwgb24gdGhlIFNWR3MgdGFnc1xuICBlbHNlIHtcbiAgICB2YXIgZG9jID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhodG1sLCAnYXBwbGljYXRpb24veG1sJylcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoXG4gICAgICBjb250YWluZXIub3duZXJEb2N1bWVudC5pbXBvcnROb2RlKGRvYy5kb2N1bWVudEVsZW1lbnQsIHRydWUpXG4gICAgKVxuICB9XG59XG5cbi8qKlxuICogQ2hlY2tzIHdldGhlciBhIERPTSBub2RlIG11c3QgYmUgY29uc2lkZXJlZCBwYXJ0IG9mIGFuIHN2ZyBkb2N1bWVudFxuICogQHBhcmFtICAgeyBTdHJpbmcgfSAgbmFtZSAtIHRhZyBuYW1lXG4gKiBAcmV0dXJucyB7IEJvb2xlYW4gfSAtXG4gKi9cbmZ1bmN0aW9uIGlzU1ZHVGFnKG5hbWUpIHtcbiAgcmV0dXJuIH5TVkdfVEFHU19MSVNULmluZGV4T2YobmFtZSlcbn1cblxuLyoqXG4gKiBEZXRlY3QgaWYgdGhlIGFyZ3VtZW50IHBhc3NlZCBpcyBhbiBvYmplY3QsIGV4Y2x1ZGUgbnVsbC5cbiAqIE5PVEU6IFVzZSBpc09iamVjdCh4KSAmJiAhaXNBcnJheSh4KSB0byBleGNsdWRlcyBhcnJheXMuXG4gKiBAcGFyYW0gICB7ICogfSB2IC0gd2hhdGV2ZXIgeW91IHdhbnQgdG8gcGFzcyB0byB0aGlzIGZ1bmN0aW9uXG4gKiBAcmV0dXJucyB7IEJvb2xlYW4gfSAtXG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0KHYpIHtcbiAgcmV0dXJuIHYgJiYgdHlwZW9mIHYgPT09IFRfT0JKRUNUICAgICAgICAgLy8gdHlwZW9mIG51bGwgaXMgJ29iamVjdCdcbn1cblxuLyoqXG4gKiBSZW1vdmUgYW55IERPTSBhdHRyaWJ1dGUgZnJvbSBhIG5vZGVcbiAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gZG9tIC0gRE9NIG5vZGUgd2Ugd2FudCB0byB1cGRhdGVcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gbmFtZSAtIG5hbWUgb2YgdGhlIHByb3BlcnR5IHdlIHdhbnQgdG8gcmVtb3ZlXG4gKi9cbmZ1bmN0aW9uIHJlbUF0dHIoZG9tLCBuYW1lKSB7XG4gIGRvbS5yZW1vdmVBdHRyaWJ1dGUobmFtZSlcbn1cblxuLyoqXG4gKiBDb252ZXJ0IGEgc3RyaW5nIGNvbnRhaW5pbmcgZGFzaGVzIHRvIGNhbWVsIGNhc2VcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gc3RyaW5nIC0gaW5wdXQgc3RyaW5nXG4gKiBAcmV0dXJucyB7IFN0cmluZyB9IG15LXN0cmluZyAtPiBteVN0cmluZ1xuICovXG5mdW5jdGlvbiB0b0NhbWVsKHN0cmluZykge1xuICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoLy0oXFx3KS9nLCBmdW5jdGlvbihfLCBjKSB7XG4gICAgcmV0dXJuIGMudG9VcHBlckNhc2UoKVxuICB9KVxufVxuXG4vKipcbiAqIEdldCB0aGUgdmFsdWUgb2YgYW55IERPTSBhdHRyaWJ1dGUgb24gYSBub2RlXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IGRvbSAtIERPTSBub2RlIHdlIHdhbnQgdG8gcGFyc2VcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gbmFtZSAtIG5hbWUgb2YgdGhlIGF0dHJpYnV0ZSB3ZSB3YW50IHRvIGdldFxuICogQHJldHVybnMgeyBTdHJpbmcgfCB1bmRlZmluZWQgfSBuYW1lIG9mIHRoZSBub2RlIGF0dHJpYnV0ZSB3aGV0aGVyIGl0IGV4aXN0c1xuICovXG5mdW5jdGlvbiBnZXRBdHRyKGRvbSwgbmFtZSkge1xuICByZXR1cm4gZG9tLmdldEF0dHJpYnV0ZShuYW1lKVxufVxuXG4vKipcbiAqIFNldCBhbnkgRE9NIGF0dHJpYnV0ZVxuICogQHBhcmFtIHsgT2JqZWN0IH0gZG9tIC0gRE9NIG5vZGUgd2Ugd2FudCB0byB1cGRhdGVcbiAqIEBwYXJhbSB7IFN0cmluZyB9IG5hbWUgLSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB3ZSB3YW50IHRvIHNldFxuICogQHBhcmFtIHsgU3RyaW5nIH0gdmFsIC0gdmFsdWUgb2YgdGhlIHByb3BlcnR5IHdlIHdhbnQgdG8gc2V0XG4gKi9cbmZ1bmN0aW9uIHNldEF0dHIoZG9tLCBuYW1lLCB2YWwpIHtcbiAgZG9tLnNldEF0dHJpYnV0ZShuYW1lLCB2YWwpXG59XG5cbi8qKlxuICogRGV0ZWN0IHRoZSB0YWcgaW1wbGVtZW50YXRpb24gYnkgYSBET00gbm9kZVxuICogQHBhcmFtICAgeyBPYmplY3QgfSBkb20gLSBET00gbm9kZSB3ZSBuZWVkIHRvIHBhcnNlIHRvIGdldCBpdHMgdGFnIGltcGxlbWVudGF0aW9uXG4gKiBAcmV0dXJucyB7IE9iamVjdCB9IGl0IHJldHVybnMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIGltcGxlbWVudGF0aW9uIG9mIGEgY3VzdG9tIHRhZyAodGVtcGxhdGUgYW5kIGJvb3QgZnVuY3Rpb24pXG4gKi9cbmZ1bmN0aW9uIGdldFRhZyhkb20pIHtcbiAgcmV0dXJuIGRvbS50YWdOYW1lICYmIF9fdGFnSW1wbFtnZXRBdHRyKGRvbSwgUklPVF9UQUdfSVMpIHx8XG4gICAgZ2V0QXR0cihkb20sIFJJT1RfVEFHKSB8fCBkb20udGFnTmFtZS50b0xvd2VyQ2FzZSgpXVxufVxuLyoqXG4gKiBBZGQgYSBjaGlsZCB0YWcgdG8gaXRzIHBhcmVudCBpbnRvIHRoZSBgdGFnc2Agb2JqZWN0XG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IHRhZyAtIGNoaWxkIHRhZyBpbnN0YW5jZVxuICogQHBhcmFtICAgeyBTdHJpbmcgfSB0YWdOYW1lIC0ga2V5IHdoZXJlIHRoZSBuZXcgdGFnIHdpbGwgYmUgc3RvcmVkXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IHBhcmVudCAtIHRhZyBpbnN0YW5jZSB3aGVyZSB0aGUgbmV3IGNoaWxkIHRhZyB3aWxsIGJlIGluY2x1ZGVkXG4gKi9cbmZ1bmN0aW9uIGFkZENoaWxkVGFnKHRhZywgdGFnTmFtZSwgcGFyZW50KSB7XG4gIHZhciBjYWNoZWRUYWcgPSBwYXJlbnQudGFnc1t0YWdOYW1lXVxuXG4gIC8vIGlmIHRoZXJlIGFyZSBtdWx0aXBsZSBjaGlsZHJlbiB0YWdzIGhhdmluZyB0aGUgc2FtZSBuYW1lXG4gIGlmIChjYWNoZWRUYWcpIHtcbiAgICAvLyBpZiB0aGUgcGFyZW50IHRhZ3MgcHJvcGVydHkgaXMgbm90IHlldCBhbiBhcnJheVxuICAgIC8vIGNyZWF0ZSBpdCBhZGRpbmcgdGhlIGZpcnN0IGNhY2hlZCB0YWdcbiAgICBpZiAoIWlzQXJyYXkoY2FjaGVkVGFnKSlcbiAgICAgIC8vIGRvbid0IGFkZCB0aGUgc2FtZSB0YWcgdHdpY2VcbiAgICAgIGlmIChjYWNoZWRUYWcgIT09IHRhZylcbiAgICAgICAgcGFyZW50LnRhZ3NbdGFnTmFtZV0gPSBbY2FjaGVkVGFnXVxuICAgIC8vIGFkZCB0aGUgbmV3IG5lc3RlZCB0YWcgdG8gdGhlIGFycmF5XG4gICAgaWYgKCFjb250YWlucyhwYXJlbnQudGFnc1t0YWdOYW1lXSwgdGFnKSlcbiAgICAgIHBhcmVudC50YWdzW3RhZ05hbWVdLnB1c2godGFnKVxuICB9IGVsc2Uge1xuICAgIHBhcmVudC50YWdzW3RhZ05hbWVdID0gdGFnXG4gIH1cbn1cblxuLyoqXG4gKiBNb3ZlIHRoZSBwb3NpdGlvbiBvZiBhIGN1c3RvbSB0YWcgaW4gaXRzIHBhcmVudCB0YWdcbiAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gdGFnIC0gY2hpbGQgdGFnIGluc3RhbmNlXG4gKiBAcGFyYW0gICB7IFN0cmluZyB9IHRhZ05hbWUgLSBrZXkgd2hlcmUgdGhlIHRhZyB3YXMgc3RvcmVkXG4gKiBAcGFyYW0gICB7IE51bWJlciB9IG5ld1BvcyAtIGluZGV4IHdoZXJlIHRoZSBuZXcgdGFnIHdpbGwgYmUgc3RvcmVkXG4gKi9cbmZ1bmN0aW9uIG1vdmVDaGlsZFRhZyh0YWcsIHRhZ05hbWUsIG5ld1Bvcykge1xuICB2YXIgcGFyZW50ID0gdGFnLnBhcmVudCxcbiAgICB0YWdzXG4gIC8vIG5vIHBhcmVudCBubyBtb3ZlXG4gIGlmICghcGFyZW50KSByZXR1cm5cblxuICB0YWdzID0gcGFyZW50LnRhZ3NbdGFnTmFtZV1cblxuICBpZiAoaXNBcnJheSh0YWdzKSlcbiAgICB0YWdzLnNwbGljZShuZXdQb3MsIDAsIHRhZ3Muc3BsaWNlKHRhZ3MuaW5kZXhPZih0YWcpLCAxKVswXSlcbiAgZWxzZSBhZGRDaGlsZFRhZyh0YWcsIHRhZ05hbWUsIHBhcmVudClcbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgY2hpbGQgdGFnIGluY2x1ZGluZyBpdCBjb3JyZWN0bHkgaW50byBpdHMgcGFyZW50XG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IGNoaWxkIC0gY2hpbGQgdGFnIGltcGxlbWVudGF0aW9uXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IG9wdHMgLSB0YWcgb3B0aW9ucyBjb250YWluaW5nIHRoZSBET00gbm9kZSB3aGVyZSB0aGUgdGFnIHdpbGwgYmUgbW91bnRlZFxuICogQHBhcmFtICAgeyBTdHJpbmcgfSBpbm5lckhUTUwgLSBpbm5lciBodG1sIG9mIHRoZSBjaGlsZCBub2RlXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IHBhcmVudCAtIGluc3RhbmNlIG9mIHRoZSBwYXJlbnQgdGFnIGluY2x1ZGluZyB0aGUgY2hpbGQgY3VzdG9tIHRhZ1xuICogQHJldHVybnMgeyBPYmplY3QgfSBpbnN0YW5jZSBvZiB0aGUgbmV3IGNoaWxkIHRhZyBqdXN0IGNyZWF0ZWRcbiAqL1xuZnVuY3Rpb24gaW5pdENoaWxkVGFnKGNoaWxkLCBvcHRzLCBpbm5lckhUTUwsIHBhcmVudCkge1xuICB2YXIgdGFnID0gbmV3IFRhZyhjaGlsZCwgb3B0cywgaW5uZXJIVE1MKSxcbiAgICB0YWdOYW1lID0gZ2V0VGFnTmFtZShvcHRzLnJvb3QpLFxuICAgIHB0YWcgPSBnZXRJbW1lZGlhdGVDdXN0b21QYXJlbnRUYWcocGFyZW50KVxuICAvLyBmaXggZm9yIHRoZSBwYXJlbnQgYXR0cmlidXRlIGluIHRoZSBsb29wZWQgZWxlbWVudHNcbiAgdGFnLnBhcmVudCA9IHB0YWdcbiAgLy8gc3RvcmUgdGhlIHJlYWwgcGFyZW50IHRhZ1xuICAvLyBpbiBzb21lIGNhc2VzIHRoaXMgY291bGQgYmUgZGlmZmVyZW50IGZyb20gdGhlIGN1c3RvbSBwYXJlbnQgdGFnXG4gIC8vIGZvciBleGFtcGxlIGluIG5lc3RlZCBsb29wc1xuICB0YWcuX3BhcmVudCA9IHBhcmVudFxuXG4gIC8vIGFkZCB0aGlzIHRhZyB0byB0aGUgY3VzdG9tIHBhcmVudCB0YWdcbiAgYWRkQ2hpbGRUYWcodGFnLCB0YWdOYW1lLCBwdGFnKVxuICAvLyBhbmQgYWxzbyB0byB0aGUgcmVhbCBwYXJlbnQgdGFnXG4gIGlmIChwdGFnICE9PSBwYXJlbnQpXG4gICAgYWRkQ2hpbGRUYWcodGFnLCB0YWdOYW1lLCBwYXJlbnQpXG4gIC8vIGVtcHR5IHRoZSBjaGlsZCBub2RlIG9uY2Ugd2UgZ290IGl0cyB0ZW1wbGF0ZVxuICAvLyB0byBhdm9pZCB0aGF0IGl0cyBjaGlsZHJlbiBnZXQgY29tcGlsZWQgbXVsdGlwbGUgdGltZXNcbiAgb3B0cy5yb290LmlubmVySFRNTCA9ICcnXG5cbiAgcmV0dXJuIHRhZ1xufVxuXG4vKipcbiAqIExvb3AgYmFja3dhcmQgYWxsIHRoZSBwYXJlbnRzIHRyZWUgdG8gZGV0ZWN0IHRoZSBmaXJzdCBjdXN0b20gcGFyZW50IHRhZ1xuICogQHBhcmFtICAgeyBPYmplY3QgfSB0YWcgLSBhIFRhZyBpbnN0YW5jZVxuICogQHJldHVybnMgeyBPYmplY3QgfSB0aGUgaW5zdGFuY2Ugb2YgdGhlIGZpcnN0IGN1c3RvbSBwYXJlbnQgdGFnIGZvdW5kXG4gKi9cbmZ1bmN0aW9uIGdldEltbWVkaWF0ZUN1c3RvbVBhcmVudFRhZyh0YWcpIHtcbiAgdmFyIHB0YWcgPSB0YWdcbiAgd2hpbGUgKCFnZXRUYWcocHRhZy5yb290KSkge1xuICAgIGlmICghcHRhZy5wYXJlbnQpIGJyZWFrXG4gICAgcHRhZyA9IHB0YWcucGFyZW50XG4gIH1cbiAgcmV0dXJuIHB0YWdcbn1cblxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gc2V0IGFuIGltbXV0YWJsZSBwcm9wZXJ0eVxuICogQHBhcmFtICAgeyBPYmplY3QgfSBlbCAtIG9iamVjdCB3aGVyZSB0aGUgbmV3IHByb3BlcnR5IHdpbGwgYmUgc2V0XG4gKiBAcGFyYW0gICB7IFN0cmluZyB9IGtleSAtIG9iamVjdCBrZXkgd2hlcmUgdGhlIG5ldyBwcm9wZXJ0eSB3aWxsIGJlIHN0b3JlZFxuICogQHBhcmFtICAgeyAqIH0gdmFsdWUgLSB2YWx1ZSBvZiB0aGUgbmV3IHByb3BlcnR5XG4qIEBwYXJhbSAgIHsgT2JqZWN0IH0gb3B0aW9ucyAtIHNldCB0aGUgcHJvcGVyeSBvdmVycmlkaW5nIHRoZSBkZWZhdWx0IG9wdGlvbnNcbiAqIEByZXR1cm5zIHsgT2JqZWN0IH0gLSB0aGUgaW5pdGlhbCBvYmplY3RcbiAqL1xuZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoZWwsIGtleSwgdmFsdWUsIG9wdGlvbnMpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsLCBrZXksIGV4dGVuZCh7XG4gICAgdmFsdWU6IHZhbHVlLFxuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbiAgfSwgb3B0aW9ucykpXG4gIHJldHVybiBlbFxufVxuXG4vKipcbiAqIEdldCB0aGUgdGFnIG5hbWUgb2YgYW55IERPTSBub2RlXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IGRvbSAtIERPTSBub2RlIHdlIHdhbnQgdG8gcGFyc2VcbiAqIEByZXR1cm5zIHsgU3RyaW5nIH0gbmFtZSB0byBpZGVudGlmeSB0aGlzIGRvbSBub2RlIGluIHJpb3RcbiAqL1xuZnVuY3Rpb24gZ2V0VGFnTmFtZShkb20pIHtcbiAgdmFyIGNoaWxkID0gZ2V0VGFnKGRvbSksXG4gICAgbmFtZWRUYWcgPSBnZXRBdHRyKGRvbSwgJ25hbWUnKSxcbiAgICB0YWdOYW1lID0gbmFtZWRUYWcgJiYgIXRtcGwuaGFzRXhwcihuYW1lZFRhZykgP1xuICAgICAgICAgICAgICAgIG5hbWVkVGFnIDpcbiAgICAgICAgICAgICAgY2hpbGQgPyBjaGlsZC5uYW1lIDogZG9tLnRhZ05hbWUudG9Mb3dlckNhc2UoKVxuXG4gIHJldHVybiB0YWdOYW1lXG59XG5cbi8qKlxuICogRXh0ZW5kIGFueSBvYmplY3Qgd2l0aCBvdGhlciBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IHNyYyAtIHNvdXJjZSBvYmplY3RcbiAqIEByZXR1cm5zIHsgT2JqZWN0IH0gdGhlIHJlc3VsdGluZyBleHRlbmRlZCBvYmplY3RcbiAqXG4gKiB2YXIgb2JqID0geyBmb286ICdiYXonIH1cbiAqIGV4dGVuZChvYmosIHtiYXI6ICdiYXInLCBmb286ICdiYXInfSlcbiAqIGNvbnNvbGUubG9nKG9iaikgPT4ge2JhcjogJ2JhcicsIGZvbzogJ2Jhcid9XG4gKlxuICovXG5mdW5jdGlvbiBleHRlbmQoc3JjKSB7XG4gIHZhciBvYmosIGFyZ3MgPSBhcmd1bWVudHNcbiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmdzLmxlbmd0aDsgKytpKSB7XG4gICAgaWYgKG9iaiA9IGFyZ3NbaV0pIHtcbiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBwcm9wZXJ0eSBvZiB0aGUgc291cmNlIG9iamVjdCBjb3VsZCBiZSBvdmVycmlkZGVuXG4gICAgICAgIGlmIChpc1dyaXRhYmxlKHNyYywga2V5KSlcbiAgICAgICAgICBzcmNba2V5XSA9IG9ialtrZXldXG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBzcmNcbn1cblxuLyoqXG4gKiBDaGVjayB3aGV0aGVyIGFuIGFycmF5IGNvbnRhaW5zIGFuIGl0ZW1cbiAqIEBwYXJhbSAgIHsgQXJyYXkgfSBhcnIgLSB0YXJnZXQgYXJyYXlcbiAqIEBwYXJhbSAgIHsgKiB9IGl0ZW0gLSBpdGVtIHRvIHRlc3RcbiAqIEByZXR1cm5zIHsgQm9vbGVhbiB9IERvZXMgJ2FycicgY29udGFpbiAnaXRlbSc/XG4gKi9cbmZ1bmN0aW9uIGNvbnRhaW5zKGFyciwgaXRlbSkge1xuICByZXR1cm4gfmFyci5pbmRleE9mKGl0ZW0pXG59XG5cbi8qKlxuICogQ2hlY2sgd2hldGhlciBhbiBvYmplY3QgaXMgYSBraW5kIG9mIGFycmF5XG4gKiBAcGFyYW0gICB7ICogfSBhIC0gYW55dGhpbmdcbiAqIEByZXR1cm5zIHtCb29sZWFufSBpcyAnYScgYW4gYXJyYXk/XG4gKi9cbmZ1bmN0aW9uIGlzQXJyYXkoYSkgeyByZXR1cm4gQXJyYXkuaXNBcnJheShhKSB8fCBhIGluc3RhbmNlb2YgQXJyYXkgfVxuXG4vKipcbiAqIERldGVjdCB3aGV0aGVyIGEgcHJvcGVydHkgb2YgYW4gb2JqZWN0IGNvdWxkIGJlIG92ZXJyaWRkZW5cbiAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gIG9iaiAtIHNvdXJjZSBvYmplY3RcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gIGtleSAtIG9iamVjdCBwcm9wZXJ0eVxuICogQHJldHVybnMgeyBCb29sZWFuIH0gaXMgdGhpcyBwcm9wZXJ0eSB3cml0YWJsZT9cbiAqL1xuZnVuY3Rpb24gaXNXcml0YWJsZShvYmosIGtleSkge1xuICB2YXIgcHJvcHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KVxuICByZXR1cm4gdHlwZW9mIG9ialtrZXldID09PSBUX1VOREVGIHx8IHByb3BzICYmIHByb3BzLndyaXRhYmxlXG59XG5cblxuLyoqXG4gKiBXaXRoIHRoaXMgZnVuY3Rpb24gd2UgYXZvaWQgdGhhdCB0aGUgaW50ZXJuYWwgVGFnIG1ldGhvZHMgZ2V0IG92ZXJyaWRkZW5cbiAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gZGF0YSAtIG9wdGlvbnMgd2Ugd2FudCB0byB1c2UgdG8gZXh0ZW5kIHRoZSB0YWcgaW5zdGFuY2VcbiAqIEByZXR1cm5zIHsgT2JqZWN0IH0gY2xlYW4gb2JqZWN0IHdpdGhvdXQgY29udGFpbmluZyB0aGUgcmlvdCBpbnRlcm5hbCByZXNlcnZlZCB3b3Jkc1xuICovXG5mdW5jdGlvbiBjbGVhblVwRGF0YShkYXRhKSB7XG4gIGlmICghKGRhdGEgaW5zdGFuY2VvZiBUYWcpICYmICEoZGF0YSAmJiB0eXBlb2YgZGF0YS50cmlnZ2VyID09IFRfRlVOQ1RJT04pKVxuICAgIHJldHVybiBkYXRhXG5cbiAgdmFyIG8gPSB7fVxuICBmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xuICAgIGlmICghUkVTRVJWRURfV09SRFNfQkxBQ0tMSVNULnRlc3Qoa2V5KSkgb1trZXldID0gZGF0YVtrZXldXG4gIH1cbiAgcmV0dXJuIG9cbn1cblxuLyoqXG4gKiBXYWxrIGRvd24gcmVjdXJzaXZlbHkgYWxsIHRoZSBjaGlsZHJlbiB0YWdzIHN0YXJ0aW5nIGRvbSBub2RlXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9ICAgZG9tIC0gc3RhcnRpbmcgbm9kZSB3aGVyZSB3ZSB3aWxsIHN0YXJ0IHRoZSByZWN1cnNpb25cbiAqIEBwYXJhbSAgIHsgRnVuY3Rpb24gfSBmbiAtIGNhbGxiYWNrIHRvIHRyYW5zZm9ybSB0aGUgY2hpbGQgbm9kZSBqdXN0IGZvdW5kXG4gKi9cbmZ1bmN0aW9uIHdhbGsoZG9tLCBmbikge1xuICBpZiAoZG9tKSB7XG4gICAgLy8gc3RvcCB0aGUgcmVjdXJzaW9uXG4gICAgaWYgKGZuKGRvbSkgPT09IGZhbHNlKSByZXR1cm5cbiAgICBlbHNlIHtcbiAgICAgIGRvbSA9IGRvbS5maXJzdENoaWxkXG5cbiAgICAgIHdoaWxlIChkb20pIHtcbiAgICAgICAgd2Fsayhkb20sIGZuKVxuICAgICAgICBkb20gPSBkb20ubmV4dFNpYmxpbmdcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBNaW5pbWl6ZSByaXNrOiBvbmx5IHplcm8gb3Igb25lIF9zcGFjZV8gYmV0d2VlbiBhdHRyICYgdmFsdWVcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gICBodG1sIC0gaHRtbCBzdHJpbmcgd2Ugd2FudCB0byBwYXJzZVxuICogQHBhcmFtICAgeyBGdW5jdGlvbiB9IGZuIC0gY2FsbGJhY2sgZnVuY3Rpb24gdG8gYXBwbHkgb24gYW55IGF0dHJpYnV0ZSBmb3VuZFxuICovXG5mdW5jdGlvbiB3YWxrQXR0cmlidXRlcyhodG1sLCBmbikge1xuICB2YXIgbSxcbiAgICByZSA9IC8oWy1cXHddKykgPz0gPyg/OlwiKFteXCJdKil8JyhbXiddKil8KHtbXn1dKn0pKS9nXG5cbiAgd2hpbGUgKG0gPSByZS5leGVjKGh0bWwpKSB7XG4gICAgZm4obVsxXS50b0xvd2VyQ2FzZSgpLCBtWzJdIHx8IG1bM10gfHwgbVs0XSlcbiAgfVxufVxuXG4vKipcbiAqIENoZWNrIHdoZXRoZXIgYSBET00gbm9kZSBpcyBpbiBzdHViIG1vZGUsIHVzZWZ1bCBmb3IgdGhlIHJpb3QgJ2lmJyBkaXJlY3RpdmVcbiAqIEBwYXJhbSAgIHsgT2JqZWN0IH0gIGRvbSAtIERPTSBub2RlIHdlIHdhbnQgdG8gcGFyc2VcbiAqIEByZXR1cm5zIHsgQm9vbGVhbiB9IC1cbiAqL1xuZnVuY3Rpb24gaXNJblN0dWIoZG9tKSB7XG4gIHdoaWxlIChkb20pIHtcbiAgICBpZiAoZG9tLmluU3R1YikgcmV0dXJuIHRydWVcbiAgICBkb20gPSBkb20ucGFyZW50Tm9kZVxuICB9XG4gIHJldHVybiBmYWxzZVxufVxuXG4vKipcbiAqIENyZWF0ZSBhIGdlbmVyaWMgRE9NIG5vZGVcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gbmFtZSAtIG5hbWUgb2YgdGhlIERPTSBub2RlIHdlIHdhbnQgdG8gY3JlYXRlXG4gKiBAcGFyYW0gICB7IEJvb2xlYW4gfSBpc1N2ZyAtIHNob3VsZCB3ZSB1c2UgYSBTVkcgYXMgcGFyZW50IG5vZGU/XG4gKiBAcmV0dXJucyB7IE9iamVjdCB9IERPTSBub2RlIGp1c3QgY3JlYXRlZFxuICovXG5mdW5jdGlvbiBta0VsKG5hbWUsIGlzU3ZnKSB7XG4gIHJldHVybiBpc1N2ZyA/XG4gICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKSA6XG4gICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lKVxufVxuXG4vKipcbiAqIFNob3J0ZXIgYW5kIGZhc3Qgd2F5IHRvIHNlbGVjdCBtdWx0aXBsZSBub2RlcyBpbiB0aGUgRE9NXG4gKiBAcGFyYW0gICB7IFN0cmluZyB9IHNlbGVjdG9yIC0gRE9NIHNlbGVjdG9yXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IGN0eCAtIERPTSBub2RlIHdoZXJlIHRoZSB0YXJnZXRzIG9mIG91ciBzZWFyY2ggd2lsbCBpcyBsb2NhdGVkXG4gKiBAcmV0dXJucyB7IE9iamVjdCB9IGRvbSBub2RlcyBmb3VuZFxuICovXG5mdW5jdGlvbiAkJChzZWxlY3RvciwgY3R4KSB7XG4gIHJldHVybiAoY3R4IHx8IGRvY3VtZW50KS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKVxufVxuXG4vKipcbiAqIFNob3J0ZXIgYW5kIGZhc3Qgd2F5IHRvIHNlbGVjdCBhIHNpbmdsZSBub2RlIGluIHRoZSBET01cbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gc2VsZWN0b3IgLSB1bmlxdWUgZG9tIHNlbGVjdG9yXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IGN0eCAtIERPTSBub2RlIHdoZXJlIHRoZSB0YXJnZXQgb2Ygb3VyIHNlYXJjaCB3aWxsIGlzIGxvY2F0ZWRcbiAqIEByZXR1cm5zIHsgT2JqZWN0IH0gZG9tIG5vZGUgZm91bmRcbiAqL1xuZnVuY3Rpb24gJChzZWxlY3RvciwgY3R4KSB7XG4gIHJldHVybiAoY3R4IHx8IGRvY3VtZW50KS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKVxufVxuXG4vKipcbiAqIFNpbXBsZSBvYmplY3QgcHJvdG90eXBhbCBpbmhlcml0YW5jZVxuICogQHBhcmFtICAgeyBPYmplY3QgfSBwYXJlbnQgLSBwYXJlbnQgb2JqZWN0XG4gKiBAcmV0dXJucyB7IE9iamVjdCB9IGNoaWxkIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIGluaGVyaXQocGFyZW50KSB7XG4gIGZ1bmN0aW9uIENoaWxkKCkge31cbiAgQ2hpbGQucHJvdG90eXBlID0gcGFyZW50XG4gIHJldHVybiBuZXcgQ2hpbGQoKVxufVxuXG4vKipcbiAqIEdldCB0aGUgbmFtZSBwcm9wZXJ0eSBuZWVkZWQgdG8gaWRlbnRpZnkgYSBET00gbm9kZSBpbiByaW90XG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IGRvbSAtIERPTSBub2RlIHdlIG5lZWQgdG8gcGFyc2VcbiAqIEByZXR1cm5zIHsgU3RyaW5nIHwgdW5kZWZpbmVkIH0gZ2l2ZSB1cyBiYWNrIGEgc3RyaW5nIHRvIGlkZW50aWZ5IHRoaXMgZG9tIG5vZGVcbiAqL1xuZnVuY3Rpb24gZ2V0TmFtZWRLZXkoZG9tKSB7XG4gIHJldHVybiBnZXRBdHRyKGRvbSwgJ2lkJykgfHwgZ2V0QXR0cihkb20sICduYW1lJylcbn1cblxuLyoqXG4gKiBTZXQgdGhlIG5hbWVkIHByb3BlcnRpZXMgb2YgYSB0YWcgZWxlbWVudFxuICogQHBhcmFtIHsgT2JqZWN0IH0gZG9tIC0gRE9NIG5vZGUgd2UgbmVlZCB0byBwYXJzZVxuICogQHBhcmFtIHsgT2JqZWN0IH0gcGFyZW50IC0gdGFnIGluc3RhbmNlIHdoZXJlIHRoZSBuYW1lZCBkb20gZWxlbWVudCB3aWxsIGJlIGV2ZW50dWFsbHkgYWRkZWRcbiAqIEBwYXJhbSB7IEFycmF5IH0ga2V5cyAtIGxpc3Qgb2YgYWxsIHRoZSB0YWcgaW5zdGFuY2UgcHJvcGVydGllc1xuICovXG5mdW5jdGlvbiBzZXROYW1lZChkb20sIHBhcmVudCwga2V5cykge1xuICAvLyBnZXQgdGhlIGtleSB2YWx1ZSB3ZSB3YW50IHRvIGFkZCB0byB0aGUgdGFnIGluc3RhbmNlXG4gIHZhciBrZXkgPSBnZXROYW1lZEtleShkb20pLFxuICAgIGlzQXJyLFxuICAgIC8vIGFkZCB0aGUgbm9kZSBkZXRlY3RlZCB0byBhIHRhZyBpbnN0YW5jZSB1c2luZyB0aGUgbmFtZWQgcHJvcGVydHlcbiAgICBhZGQgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgLy8gYXZvaWQgdG8gb3ZlcnJpZGUgdGhlIHRhZyBwcm9wZXJ0aWVzIGFscmVhZHkgc2V0XG4gICAgICBpZiAoY29udGFpbnMoa2V5cywga2V5KSkgcmV0dXJuXG4gICAgICAvLyBjaGVjayB3aGV0aGVyIHRoaXMgdmFsdWUgaXMgYW4gYXJyYXlcbiAgICAgIGlzQXJyID0gaXNBcnJheSh2YWx1ZSlcbiAgICAgIC8vIGlmIHRoZSBrZXkgd2FzIG5ldmVyIHNldFxuICAgICAgaWYgKCF2YWx1ZSlcbiAgICAgICAgLy8gc2V0IGl0IG9uY2Ugb24gdGhlIHRhZyBpbnN0YW5jZVxuICAgICAgICBwYXJlbnRba2V5XSA9IGRvbVxuICAgICAgLy8gaWYgaXQgd2FzIGFuIGFycmF5IGFuZCBub3QgeWV0IHNldFxuICAgICAgZWxzZSBpZiAoIWlzQXJyIHx8IGlzQXJyICYmICFjb250YWlucyh2YWx1ZSwgZG9tKSkge1xuICAgICAgICAvLyBhZGQgdGhlIGRvbSBub2RlIGludG8gdGhlIGFycmF5XG4gICAgICAgIGlmIChpc0FycilcbiAgICAgICAgICB2YWx1ZS5wdXNoKGRvbSlcbiAgICAgICAgZWxzZVxuICAgICAgICAgIHBhcmVudFtrZXldID0gW3ZhbHVlLCBkb21dXG4gICAgICB9XG4gICAgfVxuXG4gIC8vIHNraXAgdGhlIGVsZW1lbnRzIHdpdGggbm8gbmFtZWQgcHJvcGVydGllc1xuICBpZiAoIWtleSkgcmV0dXJuXG5cbiAgLy8gY2hlY2sgd2hldGhlciB0aGlzIGtleSBoYXMgYmVlbiBhbHJlYWR5IGV2YWx1YXRlZFxuICBpZiAodG1wbC5oYXNFeHByKGtleSkpXG4gICAgLy8gd2FpdCB0aGUgZmlyc3QgdXBkYXRlZCBldmVudCBvbmx5IG9uY2VcbiAgICBwYXJlbnQub25lKCdtb3VudCcsIGZ1bmN0aW9uKCkge1xuICAgICAga2V5ID0gZ2V0TmFtZWRLZXkoZG9tKVxuICAgICAgYWRkKHBhcmVudFtrZXldKVxuICAgIH0pXG4gIGVsc2VcbiAgICBhZGQocGFyZW50W2tleV0pXG5cbn1cblxuLyoqXG4gKiBGYXN0ZXIgU3RyaW5nIHN0YXJ0c1dpdGggYWx0ZXJuYXRpdmVcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gc3JjIC0gc291cmNlIHN0cmluZ1xuICogQHBhcmFtICAgeyBTdHJpbmcgfSBzdHIgLSB0ZXN0IHN0cmluZ1xuICogQHJldHVybnMgeyBCb29sZWFuIH0gLVxuICovXG5mdW5jdGlvbiBzdGFydHNXaXRoKHNyYywgc3RyKSB7XG4gIHJldHVybiBzcmMuc2xpY2UoMCwgc3RyLmxlbmd0aCkgPT09IHN0clxufVxuXG4vKipcbiAqIHJlcXVlc3RBbmltYXRpb25GcmFtZSBmdW5jdGlvblxuICogQWRhcHRlZCBmcm9tIGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL3BhdWxpcmlzaC8xNTc5NjcxLCBsaWNlbnNlIE1JVFxuICovXG52YXIgckFGID0gKGZ1bmN0aW9uICh3KSB7XG4gIHZhciByYWYgPSB3LnJlcXVlc3RBbmltYXRpb25GcmFtZSAgICB8fFxuICAgICAgICAgICAgdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcblxuICBpZiAoIXJhZiB8fCAvaVAoYWR8aG9uZXxvZCkuKk9TIDYvLnRlc3Qody5uYXZpZ2F0b3IudXNlckFnZW50KSkgeyAgLy8gYnVnZ3kgaU9TNlxuICAgIHZhciBsYXN0VGltZSA9IDBcblxuICAgIHJhZiA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgdmFyIG5vd3RpbWUgPSBEYXRlLm5vdygpLCB0aW1lb3V0ID0gTWF0aC5tYXgoMTYgLSAobm93dGltZSAtIGxhc3RUaW1lKSwgMClcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBjYihsYXN0VGltZSA9IG5vd3RpbWUgKyB0aW1lb3V0KSB9LCB0aW1lb3V0KVxuICAgIH1cbiAgfVxuICByZXR1cm4gcmFmXG5cbn0pKHdpbmRvdyB8fCB7fSlcblxuLyoqXG4gKiBNb3VudCBhIHRhZyBjcmVhdGluZyBuZXcgVGFnIGluc3RhbmNlXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IHJvb3QgLSBkb20gbm9kZSB3aGVyZSB0aGUgdGFnIHdpbGwgYmUgbW91bnRlZFxuICogQHBhcmFtICAgeyBTdHJpbmcgfSB0YWdOYW1lIC0gbmFtZSBvZiB0aGUgcmlvdCB0YWcgd2Ugd2FudCB0byBtb3VudFxuICogQHBhcmFtICAgeyBPYmplY3QgfSBvcHRzIC0gb3B0aW9ucyB0byBwYXNzIHRvIHRoZSBUYWcgaW5zdGFuY2VcbiAqIEByZXR1cm5zIHsgVGFnIH0gYSBuZXcgVGFnIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIG1vdW50VG8ocm9vdCwgdGFnTmFtZSwgb3B0cykge1xuICB2YXIgdGFnID0gX190YWdJbXBsW3RhZ05hbWVdLFxuICAgIC8vIGNhY2hlIHRoZSBpbm5lciBIVE1MIHRvIGZpeCAjODU1XG4gICAgaW5uZXJIVE1MID0gcm9vdC5faW5uZXJIVE1MID0gcm9vdC5faW5uZXJIVE1MIHx8IHJvb3QuaW5uZXJIVE1MXG5cbiAgLy8gY2xlYXIgdGhlIGlubmVyIGh0bWxcbiAgcm9vdC5pbm5lckhUTUwgPSAnJ1xuXG4gIGlmICh0YWcgJiYgcm9vdCkgdGFnID0gbmV3IFRhZyh0YWcsIHsgcm9vdDogcm9vdCwgb3B0czogb3B0cyB9LCBpbm5lckhUTUwpXG5cbiAgaWYgKHRhZyAmJiB0YWcubW91bnQpIHtcbiAgICB0YWcubW91bnQoKVxuICAgIC8vIGFkZCB0aGlzIHRhZyB0byB0aGUgdmlydHVhbERvbSB2YXJpYWJsZVxuICAgIGlmICghY29udGFpbnMoX192aXJ0dWFsRG9tLCB0YWcpKSBfX3ZpcnR1YWxEb20ucHVzaCh0YWcpXG4gIH1cblxuICByZXR1cm4gdGFnXG59XG4vKipcbiAqIFJpb3QgcHVibGljIGFwaVxuICovXG5cbi8vIHNoYXJlIG1ldGhvZHMgZm9yIG90aGVyIHJpb3QgcGFydHMsIGUuZy4gY29tcGlsZXJcbnJpb3QudXRpbCA9IHsgYnJhY2tldHM6IGJyYWNrZXRzLCB0bXBsOiB0bXBsIH1cblxuLyoqXG4gKiBDcmVhdGUgYSBtaXhpbiB0aGF0IGNvdWxkIGJlIGdsb2JhbGx5IHNoYXJlZCBhY3Jvc3MgYWxsIHRoZSB0YWdzXG4gKi9cbnJpb3QubWl4aW4gPSAoZnVuY3Rpb24oKSB7XG4gIHZhciBtaXhpbnMgPSB7fSxcbiAgICBnbG9iYWxzID0gbWl4aW5zW0dMT0JBTF9NSVhJTl0gPSB7fSxcbiAgICBfaWQgPSAwXG5cbiAgLyoqXG4gICAqIENyZWF0ZS9SZXR1cm4gYSBtaXhpbiBieSBpdHMgbmFtZVxuICAgKiBAcGFyYW0gICB7IFN0cmluZyB9ICBuYW1lIC0gbWl4aW4gbmFtZSAoZ2xvYmFsIG1peGluIGlmIG9iamVjdClcbiAgICogQHBhcmFtICAgeyBPYmplY3QgfSAgbWl4aW4gLSBtaXhpbiBsb2dpY1xuICAgKiBAcGFyYW0gICB7IEJvb2xlYW4gfSBnIC0gaXMgZ2xvYmFsP1xuICAgKiBAcmV0dXJucyB7IE9iamVjdCB9ICB0aGUgbWl4aW4gbG9naWNcbiAgICovXG4gIHJldHVybiBmdW5jdGlvbihuYW1lLCBtaXhpbiwgZykge1xuICAgIC8vIFVubmFtZWQgZ2xvYmFsXG4gICAgaWYgKGlzT2JqZWN0KG5hbWUpKSB7XG4gICAgICByaW90Lm1peGluKCdfX3VubmFtZWRfJytfaWQrKywgbmFtZSwgdHJ1ZSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHZhciBzdG9yZSA9IGcgPyBnbG9iYWxzIDogbWl4aW5zXG5cbiAgICAvLyBHZXR0ZXJcbiAgICBpZiAoIW1peGluKSB7XG4gICAgICBpZiAodHlwZW9mIHN0b3JlW25hbWVdID09PSBUX1VOREVGKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVW5yZWdpc3RlcmVkIG1peGluOiAnICsgbmFtZSlcbiAgICAgIH1cbiAgICAgIHJldHVybiBzdG9yZVtuYW1lXVxuICAgIH1cbiAgICAvLyBTZXR0ZXJcbiAgICBpZiAoaXNGdW5jdGlvbihtaXhpbikpIHtcbiAgICAgIGV4dGVuZChtaXhpbi5wcm90b3R5cGUsIHN0b3JlW25hbWVdIHx8IHt9KVxuICAgICAgc3RvcmVbbmFtZV0gPSBtaXhpblxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHN0b3JlW25hbWVdID0gZXh0ZW5kKHN0b3JlW25hbWVdIHx8IHt9LCBtaXhpbilcbiAgICB9XG4gIH1cblxufSkoKVxuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyByaW90IHRhZyBpbXBsZW1lbnRhdGlvblxuICogQHBhcmFtICAgeyBTdHJpbmcgfSAgIG5hbWUgLSBuYW1lL2lkIG9mIHRoZSBuZXcgcmlvdCB0YWdcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gICBodG1sIC0gdGFnIHRlbXBsYXRlXG4gKiBAcGFyYW0gICB7IFN0cmluZyB9ICAgY3NzIC0gY3VzdG9tIHRhZyBjc3NcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gICBhdHRycyAtIHJvb3QgdGFnIGF0dHJpYnV0ZXNcbiAqIEBwYXJhbSAgIHsgRnVuY3Rpb24gfSBmbiAtIHVzZXIgZnVuY3Rpb25cbiAqIEByZXR1cm5zIHsgU3RyaW5nIH0gbmFtZS9pZCBvZiB0aGUgdGFnIGp1c3QgY3JlYXRlZFxuICovXG5yaW90LnRhZyA9IGZ1bmN0aW9uKG5hbWUsIGh0bWwsIGNzcywgYXR0cnMsIGZuKSB7XG4gIGlmIChpc0Z1bmN0aW9uKGF0dHJzKSkge1xuICAgIGZuID0gYXR0cnNcbiAgICBpZiAoL15bXFx3XFwtXStcXHM/PS8udGVzdChjc3MpKSB7XG4gICAgICBhdHRycyA9IGNzc1xuICAgICAgY3NzID0gJydcbiAgICB9IGVsc2UgYXR0cnMgPSAnJ1xuICB9XG4gIGlmIChjc3MpIHtcbiAgICBpZiAoaXNGdW5jdGlvbihjc3MpKSBmbiA9IGNzc1xuICAgIGVsc2Ugc3R5bGVNYW5hZ2VyLmFkZChjc3MpXG4gIH1cbiAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKVxuICBfX3RhZ0ltcGxbbmFtZV0gPSB7IG5hbWU6IG5hbWUsIHRtcGw6IGh0bWwsIGF0dHJzOiBhdHRycywgZm46IGZuIH1cbiAgcmV0dXJuIG5hbWVcbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgcmlvdCB0YWcgaW1wbGVtZW50YXRpb24gKGZvciB1c2UgYnkgdGhlIGNvbXBpbGVyKVxuICogQHBhcmFtICAgeyBTdHJpbmcgfSAgIG5hbWUgLSBuYW1lL2lkIG9mIHRoZSBuZXcgcmlvdCB0YWdcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gICBodG1sIC0gdGFnIHRlbXBsYXRlXG4gKiBAcGFyYW0gICB7IFN0cmluZyB9ICAgY3NzIC0gY3VzdG9tIHRhZyBjc3NcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gICBhdHRycyAtIHJvb3QgdGFnIGF0dHJpYnV0ZXNcbiAqIEBwYXJhbSAgIHsgRnVuY3Rpb24gfSBmbiAtIHVzZXIgZnVuY3Rpb25cbiAqIEByZXR1cm5zIHsgU3RyaW5nIH0gbmFtZS9pZCBvZiB0aGUgdGFnIGp1c3QgY3JlYXRlZFxuICovXG5yaW90LnRhZzIgPSBmdW5jdGlvbihuYW1lLCBodG1sLCBjc3MsIGF0dHJzLCBmbikge1xuICBpZiAoY3NzKSBzdHlsZU1hbmFnZXIuYWRkKGNzcylcbiAgLy9pZiAoYnBhaXIpIHJpb3Quc2V0dGluZ3MuYnJhY2tldHMgPSBicGFpclxuICBfX3RhZ0ltcGxbbmFtZV0gPSB7IG5hbWU6IG5hbWUsIHRtcGw6IGh0bWwsIGF0dHJzOiBhdHRycywgZm46IGZuIH1cbiAgcmV0dXJuIG5hbWVcbn1cblxuLyoqXG4gKiBNb3VudCBhIHRhZyB1c2luZyBhIHNwZWNpZmljIHRhZyBpbXBsZW1lbnRhdGlvblxuICogQHBhcmFtICAgeyBTdHJpbmcgfSBzZWxlY3RvciAtIHRhZyBET00gc2VsZWN0b3JcbiAqIEBwYXJhbSAgIHsgU3RyaW5nIH0gdGFnTmFtZSAtIHRhZyBpbXBsZW1lbnRhdGlvbiBuYW1lXG4gKiBAcGFyYW0gICB7IE9iamVjdCB9IG9wdHMgLSB0YWcgbG9naWNcbiAqIEByZXR1cm5zIHsgQXJyYXkgfSBuZXcgdGFncyBpbnN0YW5jZXNcbiAqL1xucmlvdC5tb3VudCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCB0YWdOYW1lLCBvcHRzKSB7XG5cbiAgdmFyIGVscyxcbiAgICBhbGxUYWdzLFxuICAgIHRhZ3MgPSBbXVxuXG4gIC8vIGhlbHBlciBmdW5jdGlvbnNcblxuICBmdW5jdGlvbiBhZGRSaW90VGFncyhhcnIpIHtcbiAgICB2YXIgbGlzdCA9ICcnXG4gICAgZWFjaChhcnIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZiAoIS9bXi1cXHddLy50ZXN0KGUpKSB7XG4gICAgICAgIGUgPSBlLnRyaW0oKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxpc3QgKz0gJyxbJyArIFJJT1RfVEFHX0lTICsgJz1cIicgKyBlICsgJ1wiXSxbJyArIFJJT1RfVEFHICsgJz1cIicgKyBlICsgJ1wiXSdcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBsaXN0XG4gIH1cblxuICBmdW5jdGlvbiBzZWxlY3RBbGxUYWdzKCkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoX190YWdJbXBsKVxuICAgIHJldHVybiBrZXlzICsgYWRkUmlvdFRhZ3Moa2V5cylcbiAgfVxuXG4gIGZ1bmN0aW9uIHB1c2hUYWdzKHJvb3QpIHtcbiAgICBpZiAocm9vdC50YWdOYW1lKSB7XG4gICAgICB2YXIgcmlvdFRhZyA9IGdldEF0dHIocm9vdCwgUklPVF9UQUdfSVMpIHx8IGdldEF0dHIocm9vdCwgUklPVF9UQUcpXG5cbiAgICAgIC8vIGhhdmUgdGFnTmFtZT8gZm9yY2UgcmlvdC10YWcgdG8gYmUgdGhlIHNhbWVcbiAgICAgIGlmICh0YWdOYW1lICYmIHJpb3RUYWcgIT09IHRhZ05hbWUpIHtcbiAgICAgICAgcmlvdFRhZyA9IHRhZ05hbWVcbiAgICAgICAgc2V0QXR0cihyb290LCBSSU9UX1RBR19JUywgdGFnTmFtZSlcbiAgICAgICAgc2V0QXR0cihyb290LCBSSU9UX1RBRywgdGFnTmFtZSkgLy8gdGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gcmlvdCAzLjAuMFxuICAgICAgfVxuICAgICAgdmFyIHRhZyA9IG1vdW50VG8ocm9vdCwgcmlvdFRhZyB8fCByb290LnRhZ05hbWUudG9Mb3dlckNhc2UoKSwgb3B0cylcblxuICAgICAgaWYgKHRhZykgdGFncy5wdXNoKHRhZylcbiAgICB9IGVsc2UgaWYgKHJvb3QubGVuZ3RoKSB7XG4gICAgICBlYWNoKHJvb3QsIHB1c2hUYWdzKSAgIC8vIGFzc3VtZSBub2RlTGlzdFxuICAgIH1cbiAgfVxuXG4gIC8vIC0tLS0tIG1vdW50IGNvZGUgLS0tLS1cblxuICAvLyBpbmplY3Qgc3R5bGVzIGludG8gRE9NXG4gIHN0eWxlTWFuYWdlci5pbmplY3QoKVxuXG4gIGlmIChpc09iamVjdCh0YWdOYW1lKSkge1xuICAgIG9wdHMgPSB0YWdOYW1lXG4gICAgdGFnTmFtZSA9IDBcbiAgfVxuXG4gIC8vIGNyYXdsIHRoZSBET00gdG8gZmluZCB0aGUgdGFnXG4gIGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09IFRfU1RSSU5HKSB7XG4gICAgaWYgKHNlbGVjdG9yID09PSAnKicpXG4gICAgICAvLyBzZWxlY3QgYWxsIHRoZSB0YWdzIHJlZ2lzdGVyZWRcbiAgICAgIC8vIGFuZCBhbHNvIHRoZSB0YWdzIGZvdW5kIHdpdGggdGhlIHJpb3QtdGFnIGF0dHJpYnV0ZSBzZXRcbiAgICAgIHNlbGVjdG9yID0gYWxsVGFncyA9IHNlbGVjdEFsbFRhZ3MoKVxuICAgIGVsc2VcbiAgICAgIC8vIG9yIGp1c3QgdGhlIG9uZXMgbmFtZWQgbGlrZSB0aGUgc2VsZWN0b3JcbiAgICAgIHNlbGVjdG9yICs9IGFkZFJpb3RUYWdzKHNlbGVjdG9yLnNwbGl0KC8sICovKSlcblxuICAgIC8vIG1ha2Ugc3VyZSB0byBwYXNzIGFsd2F5cyBhIHNlbGVjdG9yXG4gICAgLy8gdG8gdGhlIHF1ZXJ5U2VsZWN0b3JBbGwgZnVuY3Rpb25cbiAgICBlbHMgPSBzZWxlY3RvciA/ICQkKHNlbGVjdG9yKSA6IFtdXG4gIH1cbiAgZWxzZVxuICAgIC8vIHByb2JhYmx5IHlvdSBoYXZlIHBhc3NlZCBhbHJlYWR5IGEgdGFnIG9yIGEgTm9kZUxpc3RcbiAgICBlbHMgPSBzZWxlY3RvclxuXG4gIC8vIHNlbGVjdCBhbGwgdGhlIHJlZ2lzdGVyZWQgYW5kIG1vdW50IHRoZW0gaW5zaWRlIHRoZWlyIHJvb3QgZWxlbWVudHNcbiAgaWYgKHRhZ05hbWUgPT09ICcqJykge1xuICAgIC8vIGdldCBhbGwgY3VzdG9tIHRhZ3NcbiAgICB0YWdOYW1lID0gYWxsVGFncyB8fCBzZWxlY3RBbGxUYWdzKClcbiAgICAvLyBpZiB0aGUgcm9vdCBlbHMgaXQncyBqdXN0IGEgc2luZ2xlIHRhZ1xuICAgIGlmIChlbHMudGFnTmFtZSlcbiAgICAgIGVscyA9ICQkKHRhZ05hbWUsIGVscylcbiAgICBlbHNlIHtcbiAgICAgIC8vIHNlbGVjdCBhbGwgdGhlIGNoaWxkcmVuIGZvciBhbGwgdGhlIGRpZmZlcmVudCByb290IGVsZW1lbnRzXG4gICAgICB2YXIgbm9kZUxpc3QgPSBbXVxuICAgICAgZWFjaChlbHMsIGZ1bmN0aW9uIChfZWwpIHtcbiAgICAgICAgbm9kZUxpc3QucHVzaCgkJCh0YWdOYW1lLCBfZWwpKVxuICAgICAgfSlcbiAgICAgIGVscyA9IG5vZGVMaXN0XG4gICAgfVxuICAgIC8vIGdldCByaWQgb2YgdGhlIHRhZ05hbWVcbiAgICB0YWdOYW1lID0gMFxuICB9XG5cbiAgcHVzaFRhZ3MoZWxzKVxuXG4gIHJldHVybiB0YWdzXG59XG5cbi8qKlxuICogVXBkYXRlIGFsbCB0aGUgdGFncyBpbnN0YW5jZXMgY3JlYXRlZFxuICogQHJldHVybnMgeyBBcnJheSB9IGFsbCB0aGUgdGFncyBpbnN0YW5jZXNcbiAqL1xucmlvdC51cGRhdGUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIGVhY2goX192aXJ0dWFsRG9tLCBmdW5jdGlvbih0YWcpIHtcbiAgICB0YWcudXBkYXRlKClcbiAgfSlcbn1cblxuLyoqXG4gKiBFeHBvcnQgdGhlIFZpcnR1YWwgRE9NXG4gKi9cbnJpb3QudmRvbSA9IF9fdmlydHVhbERvbVxuXG4vKipcbiAqIEV4cG9ydCB0aGUgVGFnIGNvbnN0cnVjdG9yXG4gKi9cbnJpb3QuVGFnID0gVGFnXG4gIC8vIHN1cHBvcnQgQ29tbW9uSlMsIEFNRCAmIGJyb3dzZXJcbiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgaWYgKHR5cGVvZiBleHBvcnRzID09PSBUX09CSkVDVClcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHJpb3RcbiAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gVF9GVU5DVElPTiAmJiB0eXBlb2YgZGVmaW5lLmFtZCAhPT0gVF9VTkRFRilcbiAgICBkZWZpbmUoZnVuY3Rpb24oKSB7IHJldHVybiByaW90IH0pXG4gIGVsc2VcbiAgICB3aW5kb3cucmlvdCA9IHJpb3RcblxufSkodHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHZvaWQgMCk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yaW90L3Jpb3QuanNcbiAqKiBtb2R1bGUgaWQgPSAyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19hbWRfb3B0aW9uc19fO1xyXG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqICh3ZWJwYWNrKS9idWlsZGluL2FtZC1vcHRpb25zLmpzXG4gKiogbW9kdWxlIGlkID0gM1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiaW1wb3J0IHsgbmFtZSB9IGZyb20gJy4vbW9kdWxlJ1xucmlvdC50YWcyKCduYW1lJywgJzxoMT5OYW1lIHtuYW1lfSB7b3B0cy5sYXN0fSwge29wdHMuZmlyc3R9IDoge2NvdW50fTwvaDE+IDxmb28+IDxidXR0b24gb25jbGljaz1cIntjbGlja31cIj5Db3VudDwvYnV0dG9uPicsICcnLCAnJywgZnVuY3Rpb24ob3B0cykge1xuXG5cbiAgICB0aGlzLm5hbWUgPSBuYW1lXG5cbiAgICB0aGlzLmNvdW50ID0gMFxuXG4gICAgdGhpcy5jbGljayA9ICgpID0+IHtcbiAgICAgIHRoaXMuY291bnQrK1xuICAgIH1cbn0pO1xuXG5yaW90LnRhZzIoJ2ZvbycsICc8aDI+cmVxdWlyZWQge25hbWV9PC9oMj4nLCAnJywgJycsIGZ1bmN0aW9uKG9wdHMpIHtcbiAgICBsZXQgbW9kdWxlID0gcmVxdWlyZSgnLi9tb2R1bGUnKVxuXG4gICAgdGhpcy5uYW1lID0gbW9kdWxlLm5hbWVcbn0pO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc291cmNlL2NsaWVudC9uYW1lLnRhZ1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0ge1xuICBuYW1lOiAndGhpcyBpcyBhbiBpbXBvcnRlZCBtb2R1bGUnXG59XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zb3VyY2UvY2xpZW50L21vZHVsZS5qc1xuICoqLyIsInJpb3QudGFnMignbG9hbicsICc8aDM+TG9hbiB7bmFtZX08L2gzPiA8aW5wdXQgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj1cIk5hbWVcIiB2YWx1ZT1cIntsb2FuLnRpdGxlfVwiIG9uY2hhbmdlPVwie3JlZnJlc2h9XCI+IDxpbnB1dCB2YWx1ZT1cIntsb2FuLmFtb3VudH1cIiBvbmNoYW5nZT1cIntyZWZyZXNofVwiIHR5cGU9XCJ7XFwnbnVtYmVyXFwnfVwiPicsICcnLCAnJywgZnVuY3Rpb24ob3B0cykge1xuICAgIHRoaXMubG9hbiA9IHRoaXMub3B0cy5sb2FuXG5cbiAgICB0aGlzLnJlZnJlc2ggPSAoKSA9PiB7XG4gICAgICB0aGlzLnVwZGF0ZSgpXG4gICAgfVxufSk7XG5cbnJpb3QudGFnMignbG9hbnMnLCAnPGgyPnt0aXRsZX08L2gyPiA8YnV0dG9uIG9uY2xpY2s9XCJ7YWRkfVwiPkFkZDwvYnV0dG9uPiA8bG9hbiBlYWNoPVwie2xvYW4gaW4gbG9hbnN9XCIgbG9hbj1cIntsb2FufVwiPjwvbG9hbj4nLCAnJywgJycsIGZ1bmN0aW9uKG9wdHMpIHtcbiAgICB0aGlzLmFkZCA9ICgpID0+IHtcbiAgICAgIHRoaXMubG9hbnMudW5zaGlmdCh7fSlcbiAgICB9XG4gICAgdGhpcy5sb2FucyA9IFtdXG4gICAgdGhpcy50aXRsZSA9ICdMb2Fucydcbn0pO1xuXG5yaW90LnRhZzIoJ2FwcGxpY2F0aW9uJywgJzxoMT57dGl0bGV9PC9oMT4gPGxvYW5zPjwvbG9hbnM+IDxoMT57Zm9vKCl9PC9oMT4nLCAnJywgJycsIGZ1bmN0aW9uKG9wdHMpIHtcbiAgICB0aGlzLnRpdGxlID0gJ0NvbnNvbGlkYXRlJ1xuXG4gICAgdGhpcy5mb28gPSAoKSA9PiB7XG4gICAgICByZXR1cm4gJ2JhcidcbiAgICB9XG59KTtcblxucmlvdC50YWcyKCdkZWJ0LWxpc3QnLCAnPGgxPkRlYnRzPC9oMT4gPGRpdiBlYWNoPVwie2RlYnQgaW4gZGVidHN9XCI+IDxjYXJkIGhlYWRpbmc9XCJ7ZGVidC5uYW1lfVwiPiA8aDM+QW1vdW50OiAke2RlYnQucmVtYWluaW5nfTwvaDM+IDxpbnB1dCBvbmtleXVwPVwie3VwZGF0ZU5hbWUuYmluZChkZWJ0KX1cIiB2YWx1ZT1cIntkZWJ0Lm5hbWV9XCIgcGxhY2Vob2xkZXI9XCJOYW1lXCIgdHlwZT1cInRleHRcIj4gPC9pbnB1dD4gPGlucHV0IG9ua2V5dXA9XCJ7dXBkYXRlT3V0c2FuZGluZy5iaW5kKGRlYnQpfVwiIHZhbHVlPVwie2RlYnQucmVtYWluaW5nfVwiIHBsYWNlaG9sZGVyPVwib3V0c3RhbmRpbmcgZGVidCAoaW4gZG9sbGFycylcIiBzdGVwPVwiMC4wMVwiIG1pbj1cIjAuMDFcIiB0eXBlPVwie1xcJ251bWJlclxcJ31cIj4gPGRpdiBwcmVmaXg+JCZuYnNwOzwvZGl2PiA8L2lucHV0PiA8ZGl2PlVzZSByZXBheW1lbnRzPyB7ZGVidC51c2VSZXBheW1lbnRzfTwvZGl2PiA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgb25jaGFuZ2U9XCJ7dG9nZ2xlUmVwYXltZW50cy5iaW5kKG51bGwsIGRlYnQpfVwiPlVzZSBSZXBheW1lbnRzPC9pbnB1dD4gPGxpc3Rib3g+IDxkaXYgZWFjaD1cIntyZXBheW1lbnQgaW4gZGVidC5yZXBheW1lbnRzfVwiPiA8aXRlbT57cmVwYXltZW50fTwvaXRlbT4gPC9kaXY+IDwvbGlzdGJveD4gPGJ1dHRvbiBvbmNsaWNrPVwie2FkZFJlcGF5bWVudH1cIj5BZGQgUmVwYXltZW50PC9idXR0b24+IDxidXR0b24gb25jbGljaz1cIntyZW1vdmV9XCI+UmVtb3ZlIERlYnQ8L2J1dHRvbj4gPC9jYXJkPiA8L3RlbXBsYXRlPiA8ZGl2PiA8YnV0dG9uIG9uY2xpY2s9XCJ7YWRkfVwiPkFkZCBOZXcgRGVidDwvYnV0dG9uPiA8L2Rpdj4nLCAnOmhvc3QgeyBkaXNwbGF5OiBibG9jazsgcGFkZGluZzogMTZweDsgfScsICcnLCBmdW5jdGlvbihvcHRzKSB7XG4gICAgLy9UT0RPOiB1c2UgZmx1eCAocmlvdC1jb250cm9sL2ZsdXgpIGluc3RlYWRcbiAgICB0aGlzLnVwZGF0ZU91dHNhbmRpbmcgPSBlID0+IHtcbiAgICAgIHRoaXMucmVtYWluaW5nID0gcGFyc2VGbG9hdChlLnRhcmdldC52YWx1ZSlcbiAgICAgIHRoaXMudXBkYXRlKClcbiAgICB9XG4gICAgdGhpcy51cGRhdGVOYW1lID0gZSA9PiB7XG4gICAgICB0aGlzLm5hbWUgPSBlLnRhcmdldC52YWx1ZVxuICAgICAgdGhpcy51cGRhdGUoKVxuICAgIH1cblxuICAgIGxldCBpbml0aWFsRGVidCA9IDBcbiAgICBsZXQgaW5pdGlhbFRvdGFsRGVidCA9IDBcblxuICAgIHRoaXMudG90YWwgPSBpbml0aWFsVG90YWxEZWJ0XG4gICAgdGhpcy5kZWJ0cyA9IFt7XG4gICAgICBuYW1lOiAnRmFrZSBEZWJ0JyxcbiAgICAgIHJlbWFpbmluZzogaW5pdGlhbERlYnQsXG4gICAgICB1c2VSZXBheW1lbnRzOiB0cnVlLFxuICAgICAgcmVwYXltZW50czogW11cbiAgICB9XVxuXG4gICAgLy8gb2JzZXJ2ZXJzOiBbXG4gICAgLy8gICAnZGVidHNDaGFuZ2VkKGRlYnRzLiopJ1xuICAgIC8vIF0sXG5cbiAgICB0aGlzLnRvZ2dsZVJlcGF5bWVudHMgPSBkZWJ0ID0+IHtcbiAgICAgIGRlYnQudXNlUmVwYXltZW50cyA9ICFkZWJ0LnVzZVJlcGF5bWVudHNcbiAgICAgIHRoaXMudXBkYXRlKClcbiAgICB9XG5cbiAgICAvLyBhZGRSZXBheW1lbnQ6IGZ1bmN0aW9uKGUpIHtcbiAgICAvLyAgIC8vVE9ETzogYWRkIHJlcGF5bWVudFxuICAgIC8vIH0sXG5cbiAgICB0aGlzLmFkZCA9ICgpID0+IHtcbiAgICAgIC8vVE9ETzogcmVmYWN0b3IgdG8gJ2ZsdXgnIG1vZGVsXG4gICAgICAvLyAgKiBkZWJ0cyBnZXQgcGFzc2VkIHRvIGNvbXBvbmVudCB2aWEgb3B0c1xuICAgICAgLy8gICogY29tcG9uZW50IGNvbW11bmljYXRlcyBkZXNpcmUgdG8gdXBkYXRlIG1vZGVsIGJ5IGZpcmluZyBldmVudHMgdG8gYW4gb2JzZXJ2ZXJcbiAgICAgIC8vICAqIG9ic2VydmVyIHVwZGF0ZXMgdGhlIHJvb3Qgc3RhdGUgd2hpY2ggaXMgdXNlZCBhcyBvcHRzIGFuZCB0cmlnZ2VycyB1cGRhdGVzIHdoZXJlIG5lY2Vzc2FyeVxuICAgICAgLy8gICogbm8gZnVydGhlciBldmVudHMgY2FuIGJlIHRyaWdnZXJlZCBpbiBhbiAndXBkYXRlJyBjeWNsZVxuICAgICAgdGhpcy5kZWJ0cy5wdXNoKHtcbiAgICAgICAgbmFtZTogJ0RlYnQnLFxuICAgICAgICByZW1haW5pbmc6IDAuMDAsXG4gICAgICAgIHJlcGF5bWVudHM6IFsnZm9vJywgJ2JhcicsICdiYXonXSxcbiAgICAgICAgdXNlUmVwYXltZW50czogdHJ1ZSxcbiAgICAgICAgcmVtYWluaW5nOiBpbml0aWFsRGVidFxuICAgICAgfSlcbiAgICAgIHRoaXMudXBkYXRlKClcbiAgICB9XG5cbiAgICB0aGlzLnJlbW92ZSA9IGUgPT4ge1xuICAgICAgdGhpcy5kZWJ0cy5zcGxpY2UoZS5tb2RlbC5pbmRleCwgMSlcbiAgICAgIHRoaXMudXBkYXRlKClcbiAgICB9XG5cbiAgICB0aGlzLm9uKCd1cGRhdGUnLCAoKSA9PiB7XG4gICAgICAvL1RPRE86IHRoaXMgY291bGQgYmUgb3B0aW1pc2VkIGZ1cnJ0aGVyIGJ1dCBKUyBpcyBmYWlybHkgZmFzdCBhdCBtYXRoIChyZWxhdGl2ZSB0byBET00gbWFuaXB1bGF0aW9uKVxuICAgICAgLy9zZWUgaHR0cHM6Ly93d3cucG9seW1lci1wcm9qZWN0Lm9yZy8xLjAvZG9jcy9kZXZndWlkZS9wcm9wZXJ0aWVzI2FycmF5LW9ic2VydmF0aW9uIGZvciBzdHVwaWQgZWZmaWNpZW50IChob3JyaWJseSB1bnJlYWRhYmxlKSB2ZXJzaW9uXG4gICAgICB0aGlzLnRvdGFsID0gdGhpcy5kZWJ0cy5yZWR1Y2UoZnVuY3Rpb24odG90YWwsIGN1cnJlbnQpIHtcbiAgICAgICAgcmV0dXJuIHRvdGFsICsgKHBhcnNlSW50KGN1cnJlbnQucmVtYWluaW5nLCAxMCkgfHwgaW5pdGlhbERlYnQpXG4gICAgICB9LCBpbml0aWFsVG90YWxEZWJ0KVxuICAgIH0pXG59KTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NvdXJjZS9jbGllbnQvYXBwbGljYXRpb24udGFnXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==